(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07e4e6e6"],{"0374":function(t,e,n){t.exports=n.p+"img/enterprise-c.de64537e.svg"},"0418":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"header row m-0"},[i("div",{staticClass:"col-9 header-title text-left"},[i("span",{attrs:{role:"button"},on:{click:function(e){return t.toPage("Home")}}},[i("img",{staticClass:"header-icon mr-2",attrs:{src:n("c4c2")}}),i("span",{staticClass:"header-main-title"},[t._v(t._s(t.$t("GENERAL.TITLE")))]),i("span",{staticClass:"header-sub-title ml-2"},[t._v(t._s(t.title))])])]),i("div",{staticClass:"col-3 login text-right"},[t.user.admin?i("router-link",{attrs:{to:{name:"RAContact"}}},[i("button",{staticClass:"btn call-btn mr-3"},[t._v(t._s(t.$t("HEADER.CALL")))])]):t._e(),i("img",{staticClass:"user-icon",attrs:{src:n("c9d8")}}),i("b-dropdown",{attrs:{text:t.getUserName,variant:"outline-none","border-transparent":""}},[i("b-dropdown-item",{on:{click:function(e){return t.toPage("Settings")}}},[t._v(t._s(t.$t("GENERAL.SETTINGS")))]),i("b-dropdown-item",{on:{click:function(e){return t.showModal("logout")}}},[i("span",[t._v(t._s(t.$t("HEADER.LOGOUT")))])])],1)],1),t.modalType.logout?i("Logout",{on:{cancel:function(e){return t.closeModal("logout",!1)}}}):t._e()],1)},r=[],o=n("6af0"),a={components:{Logout:o["a"]},props:{title:String,showCancelBtn:Boolean,pageUrl:Object,isCalling:Boolean,callName:String},data:function(){return{modalType:{logout:!1},user:{}}},created:function(){this.user=this.$cookies.get("user")||{}},methods:{toPage:function(t){this.$router.push({name:t})},showModal:function(t,e){e&&(this.selectedData=e),this.modalType[t]=!0},closeModal:function(t){this.modalType[t]=!1,this.selectedData=null}},computed:{getUserName:function(){return(this.$cookies.get("user")||{}).account}}},s=a,l=(n("23d1"),n("2877")),c=Object(l["a"])(s,i,r,!1,null,"2b3cbec8",null);e["a"]=c.exports},"0542":function(t,e,n){t.exports=n.p+"img/workflow_record.1b5ba576.svg"},"0625":function(t,e,n){var i={"./image-alt.svg":"b53b","./list-alt.svg":"6ea7","./model-alt.svg":"a325","./text+image-alt.svg":"fd6c","./text+model-alt.svg":"91a4","./text+video-alt.svg":"b327","./text-alt.svg":"65a7","./video-alt.svg":"5926f"};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id="0625"},"08ec":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"workflow"},[i("Header",{attrs:{title:t.$t("WF.TITLE")}}),i("div",{staticClass:"workflow-container row mx-auto"},[i("div",{staticClass:"left-section library show-transition",class:t.isSidebarMinified?"col-1 p-0":"col-2"},[t.isContentMinified?i("div",{staticClass:"text-center"},[i("div",{staticClass:"menu"},[i("font-awesome-icon",{staticClass:"menu-icon fa-rotate-90",attrs:{icon:"grip-vertical",size:"2x"}})],1),t._l(t.templateList,(function(e){return i("div",{key:e.type},[i("div",{staticClass:"minified",on:{click:function(n){return t.createNode(e.type)}}},[i("img",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],staticClass:"my-3",attrs:{role:"button",src:t.setImgSrc(e.type),title:t.$t(e.text)}})])])})),i("div",{staticClass:"edit-link",on:{click:t.showEditTips}},[i("img",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],staticClass:"edit-link-icon",attrs:{role:"button",src:n("6ea7"),title:t.$t("WF.TIPS")+" ( "+t.errorList.length+" )"}}),t.errorList.length>0?i("div",{staticClass:"tip-dot"}):t._e()])],2):t._e(),t.isContentMinified?t._e():i("div",[i("div",{staticClass:"tab-group row"},[i("div",{staticClass:"col pl-3 pr-2"},[i("div",{staticClass:"show-transition text-center",class:t.isEditing?"inactive-tab":"active-tab",attrs:{role:"button"},on:{click:function(e){t.isEditing=!1}}},[t._v(" "+t._s(t.$t("WF.TEMPLATE"))+" ")])]),i("div",{staticClass:"col pr-3 pl-0"},[i("div",{staticClass:"show-transition text-center",class:t.isEditing?"active-tab":"inactive-tab",attrs:{role:"button"},on:{click:function(e){t.isEditing=!0}}},[t._v(" "+t._s(t.$t("WF.TIPS"))+" "),t.errorList.length>0?i("b-badge",{attrs:{variant:"danger"}},[t._v(t._s(t.errorList.length))]):t._e()],1)])]),t.isEditing?t._e():i("div",{staticClass:"row show-transition"},t._l(t.templateList,(function(e){return i("div",{key:e.type,staticClass:"col-6 template-component text-center px-3 mb-3",attrs:{role:"button"},on:{click:function(n){return t.createNode(e.type)}}},[i("div",{staticClass:"template-outline py-2"},[i("img",{staticClass:"template-img my-2",attrs:{src:t.setImgSrc(e.type)}}),i("div",{staticClass:"template-title"},[t._v(t._s(t.$t(e.text)))])])])})),0),t.isEditing?i("div",{staticClass:"error-edit-section"},[t.errorList.length>0?i("div",{staticClass:"error-sub-title text-center mb-3"},[t._v(" "+t._s(t.$t("WF.TIPS_ERR"))+" ")]):t._e(),0==t.errorList.length?i("div",{staticClass:"error-sub-title text-center mb-3"},[t._v(" "+t._s(t.$t("WF.TIPS_EMPTY"))+" ")]):t._e(),t._l(t.errorList,(function(e,n){return i("div",{key:n},[i("div",{staticClass:"error-card show-transition mb-3",attrs:{role:"button"},on:{click:function(n){return t.onErrorClick(e)}}},[i("div",{staticClass:"decor-line float-left mr-2",class:{"warning-bg":!e.title}}),i("div",{staticClass:"py-3"},[i("span",{staticClass:"error-card-title mr-2"},[t._v(t._s(e.title))]),i("span",{staticClass:"error-card-msg",class:{"warning-msg":!e.title}},[t._v(t._s(e.msg))])])])])}))],2):t._e()])]),i("div",{staticClass:"middle-section flowchart show-transition text-left",class:t.isSidebarMinified?"col-9":"col-8"},[i("h5",{staticClass:"title"},[i("font-awesome-icon",{staticClass:"title-icon h-18 mr-2",attrs:{icon:"project-diagram"}}),t._v(" "+t._s(t.queryTitle?t.queryTitle:t.$t("WF.FLOWCHART"))+" ")],1),i("div",{staticClass:"flowchart-container mx-3"},[i("flowchart",{ref:"chart",staticClass:"flowchart",attrs:{steps:t.steps,readonly:!1,render:t.renderChart},on:{select:t.handleSelect,nodeChange:t.handleNodeChange,connectionChange:t.handleConnectionChange}}),t.selectedNode&&-1!=t.selectedNode.type?i("div",{staticClass:"previewer",class:{"minified-previewer":t.isPreviewerMinified}},[t.isPreviewerMinified?t._e():i("div",{staticClass:"previewer-header"},[t.selectedNode.serial?i("div",{staticClass:"header-step text-center float-left"},[t._v(" "+t._s((t.selectedNode.serial>9?"":"0")+t.selectedNode.serial)+" / "+t._s((t.$refs.chart.internalNodes.length>9?"":"0")+(t.$refs.chart.internalNodes.length-2))+" ")]):t._e(),t.selectedNode.serial?t._e():i("div",{staticClass:"header-step null text-center float-left"},[t._v(" "+t._s(t.$t("WF.UNCONNECTED"))+" ")]),i("div",{staticClass:"header-title float-left ml-3"},[i("div",{staticClass:"header-title-text"},[t._v(" "+t._s(t.selectedNode.title)+" ")])]),i("div",{staticClass:"minify-btn float-right text-center",class:{"en-fontsize":2==t.currentLang},attrs:{role:"button"},on:{click:function(e){return t.togglePreviewMinified(!0)}}},[i("font-awesome-icon",{attrs:{icon:"compress-arrows-alt"}}),t._v(" "+t._s(t.$t("WF.MINIMIZE"))+" ")],1)]),t.isPreviewerMinified?t._e():i("div",{staticClass:"previewer-body"},[i("div",{staticClass:"previewer-body-inner"},[t.selectedNode.text&&0==t.selectedNode.type?i("div",{staticClass:"text-only text-center mx-auto"},[t._v(" "+t._s(t.selectedNode.text)+" ")]):t._e(),t.selectedNode.text&&0!=t.selectedNode.type?i("div",{staticClass:"previewer-desc float-left",class:{"full-w":3==t.selectedNode.type&&4==t.selectedNode.type&&6==t.selectedNode.type}},[i("strong",[t._v(t._s(t.selectedNode.text))])]):t._e(),0!=t.selectedNode.type?i("div",{staticClass:"previewer-content text-center float-right",class:{"full-w":!t.selectedNode.text}},[t.selectedNode.picPath?i("img",{staticClass:"img",attrs:{src:t.selectedNode.picPath}}):t._e(),t.selectedNode.vidPath?i("video",{staticClass:"vid",attrs:{src:t.selectedNode.vidPath,controls:"",autoplay:"true"}}):t._e(),t.selectedNode.modelPath?i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:100==t.progress,expression:"progress == 100"}],ref:"modelCanvas",staticClass:"model-canvas"}),t.progress<100?i("div",{staticClass:"progress-section mx-auto"},[t.progress>=0&&t.progress<100?i("div",{staticClass:"progress-text mx-auto"},[t._v(" "+t._s(t.$t("WF.LOADING_PROGRESS"))+t._s(t.progress)+"% ")]):t._e()]):t._e()]):t._e(),1==t.selectedNode.type||3==t.selectedNode.type?i("div",{staticClass:"empty-text mx-auto"},[t._v(" "+t._s(t.$t("WF.NO_PIC"))+" ")]):t._e(),2==t.selectedNode.type||4==t.selectedNode.type?i("div",{staticClass:"empty-text mx-auto"},[t._v(" "+t._s(t.$t("WF.NO_VID"))+" ")]):t._e(),5!=t.selectedNode.type&&6!=t.selectedNode.type||-1!=t.progress?t._e():i("div",{staticClass:"empty-text mx-auto"},[t._v(" "+t._s(t.$t("WF.NO_MODEL"))+" ")])]):t._e()])]),i("div",{staticClass:"previewer-footer",class:{"minified-footer":t.isPreviewerMinified}},[t.isPreviewerMinified?i("div",{staticClass:"expand-btn text-center",attrs:{role:"button"},on:{click:function(e){return t.togglePreviewMinified(!1)}}},[i("font-awesome-icon",{attrs:{icon:"expand-arrows-alt"}}),t._v(" "+t._s(t.$t("WF.EXPAND"))+" ")],1):t._e(),t.isPreviewerMinified?t._e():i("div",{staticClass:"glasses-btn-group"},[i("button",{staticClass:"btn dark py-0 mr-2"},[i("font-awesome-icon",{attrs:{icon:"angle-double-up"}}),i("span",{staticClass:"ml-1"},[t._v(t._s(t.$t("GENERAL.OPERATION")))])],1),1!=t.selectedNode.serial?i("button",{staticClass:"btn light py-0 mr-2"},[t._v(t._s(t.$t("GENERAL.PREV")))]):t._e(),t.selectedNode.recordCheck?i("button",{staticClass:"btn active py-0 mr-2"},[i("font-awesome-icon",{attrs:{icon:"check"}}),t._v(" "+t._s(1==t.selectedNode.recordType?t.$t("WF.IMAGE_RECORD"):t.$t("WF.VIDEO_RECORD"))+" ")],1):t._e(),t.selectedNode.isStepSkippable&&t.selectedNode.isCheck?i("button",{staticClass:"btn light py-0 float-right mr-2"},[t._v(" "+t._s(t.$t("WF.SKIP"))+" ")]):t._e(),t.selectedNode.isCheck?i("button",{staticClass:"btn active py-0 float-right mr-2"},[t._v(" "+t._s(t.selectedNode.pass_text)+" ")]):t._e(),t.selectedNode.isCheck?i("button",{staticClass:"btn active py-0 float-right mr-2"},[t._v(" "+t._s(t.selectedNode.fail_text)+" ")]):t._e(),t.selectedNode.isCheck||t.selectedNode.isStepSkippable||t.selectedNode.recordCheck&&t.selectedNode.isRecordRequired?t._e():i("button",{staticClass:"btn active py-0 float-right mr-2"},[t._v(" "+t._s(t.$t("GENERAL.NEXT"))+" ")])])])]):t._e(),i("div",{staticClass:"toggle-sidebar show-transition",class:{"minified-sidebar":t.isSidebarMinified},attrs:{role:"button"},on:{click:t.toggleSidebar}},[t.isSidebarMinified?t._e():i("font-awesome-icon",{attrs:{icon:"chevron-left"}}),t.isSidebarMinified?i("font-awesome-icon",{staticClass:"arrow-right",attrs:{icon:"chevron-right"}}):t._e()],1)],1)]),i("div",{staticClass:"col-2 right-section edit-node text-left"},[i("h5",{staticClass:"title"},[i("font-awesome-icon",{staticClass:"title-icon h-18 mr-2",attrs:{icon:"th-list"}}),t._v(t._s(t.$t("WF.STEP_EDIT")))],1),i("div",{staticClass:"edit-section"},[t.selectedNode&&-1!=t.selectedNode.type?i("div",{staticClass:"card-component mb-3 mr-2"},[i("div",{staticClass:"card-title m-0 pl-3"},[t._v(t._s(t.$t("WF.STEP_INFO")))]),i("div",{staticClass:"card-body p-3"},[i("div",{staticClass:"node-title mb-3"},[i("label",{attrs:{for:"nodeTitle"}},[t._v(t._s(t.$t("WF.STEP_TITLE")))]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedNode.title,expression:"selectedNode.title"}],staticClass:"form-control",class:{"err-input":t.selectedNode.error.title},attrs:{type:"text",id:"nodeTitle",placeholder:t.$t("WF.STEP_TITLE_PH"),maxlength:"50"},domProps:{value:t.selectedNode.title},on:{input:[function(e){e.target.composing||t.$set(t.selectedNode,"title",e.target.value)},function(e){return t.onValueCheck("title")}],blur:function(e){return t.onValueCheck("title")}}}),t.selectedNode.error.title?i("small",{staticClass:"err-msg"},[t._v(t._s(t.$t("WF.STEP_TITLE_ERR")))]):t._e()]),1==t.selectedNode.type||3==t.selectedNode.type?i("div",{staticClass:"node-pic mb-3"},[i("label",{attrs:{for:"nodeDesc"}},[t._v(t._s(t.$t("WF.IMAGE_FILE")))]),t.selectedNode.pic?t._e():i("div",{staticClass:"m-text mb-2",class:{"err-input":t.selectedNode.error.pic}},[i("div",{staticClass:"sub-title mb-2"},[t._v(t._s(t.$t("WF.IMAGE_DESC")))]),i("button",{staticClass:"btn upload-btn",attrs:{type:"button"},on:{click:t.chooseFiles}},[i("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"cloud-upload-alt"}}),t._v(t._s(t.$t("WF.UPLOAD_FILE"))+" ")],1),i("input",{ref:"file",attrs:{type:"file",id:"file",accept:".jpg, .png, .jpeg",hidden:""},on:{change:function(e){return t.onChangeFileUpload("pic")}}})]),t.selectedNode.pic?i("div",{staticClass:"m-text"},[i("div",[t._v(" "+t._s(t.$t("WF.NAME"))+" "),t.selectedNode.picPath?i("a",{attrs:{href:t.selectedNode.picPath,target:"_blank"}},[t._v(t._s(t.selectedNode.picName))]):t._e()]),i("div",[t._v(t._s(t.$t("WF.SIZE"))+t._s((t.selectedNode.picSize/1024/1024).toFixed(2))+" mb")]),i("button",{staticClass:"btn delete-btn mt-2",attrs:{type:"button"},on:{click:function(e){return t.deleteFile("pic")}}},[i("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"times"}}),t._v(t._s(t.$t("GENERAL.DELETE"))+" ")],1)]):t._e(),t.selectedNode.error.pic?i("small",{staticClass:"err-msg"},[t._v(t._s(t.$t("WF.UPLOAD_FILE_ERR")))]):t._e()]):t._e(),2==t.selectedNode.type||4==t.selectedNode.type?i("div",{staticClass:"node-vid mb-3"},[i("label",{attrs:{for:"nodeDesc"}},[t._v(t._s(t.$t("WF.VIDEO_FILE")))]),t.selectedNode.vid?t._e():i("div",{staticClass:"m-text mb-2",class:{"err-input":t.selectedNode.error.vid}},[i("div",{staticClass:"sub-title mb-2"},[t._v(t._s(t.$t("WF.VIDEO_DESC")))]),i("button",{staticClass:"btn upload-btn",attrs:{type:"button"},on:{click:t.chooseFiles}},[i("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"cloud-upload-alt"}}),t._v(t._s(t.$t("WF.UPLOAD_FILE"))+" ")],1),i("input",{ref:"file",attrs:{type:"file",id:"file",accept:".mp4",hidden:""},on:{change:function(e){return t.onChangeFileUpload("vid")}}})]),t.selectedNode.vid?i("div",{staticClass:"m-text"},[i("div",[t._v(" "+t._s(t.$t("WF.NAME"))+" "),t.selectedNode.vidPath?i("a",{attrs:{href:t.selectedNode.vidPath,target:"_blank"}},[t._v(t._s(t.selectedNode.vidName))]):t._e()]),i("div",[t._v(t._s(t.$t("WF.SIZE"))+t._s((t.selectedNode.vidSize/1024/1024).toFixed(2))+" mb")]),i("button",{staticClass:"btn delete-btn mt-2",attrs:{type:"button"},on:{click:function(e){return t.deleteFile("vid")}}},[i("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"times"}}),t._v(t._s(t.$t("GENERAL.DELETE"))+" ")],1)]):t._e(),t.selectedNode.error.vid?i("small",{staticClass:"err-msg"},[t._v(t._s(t.$t("WF.UPLOAD_FILE_ERR")))]):t._e()]):t._e(),0==t.selectedNode.type||3==t.selectedNode.type||4==t.selectedNode.type||6==t.selectedNode.type?i("div",{staticClass:"node-text"},[i("label",{attrs:{for:"nodeDesc"}},[t._v(t._s(t.$t("WF.STEP_DESC")))]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.selectedNode.text,expression:"selectedNode.text"}],staticClass:"form-control mb-1",class:{"err-input":t.selectedNode.error.text},attrs:{type:"text",id:"nodeDesc",placeholder:t.$t("WF.STEP_DESC_PH"),rows:"5",maxlength:0==t.selectedNode.type?1e3:500},domProps:{value:t.selectedNode.text},on:{input:[function(e){e.target.composing||t.$set(t.selectedNode,"text",e.target.value)},function(e){return t.onValueCheck("text")}],blur:function(e){return t.onValueCheck("text")}}}),t._v(" "),i("div",{staticClass:"desc-count text-right"},[t.selectedNode.error.text?i("small",{staticClass:"err-msg float-left"},[t._v(t._s(t.$t("WF.STEP_DESC_ERR")))]):t._e(),t._v(" "+t._s(t.selectedNode.text?t.selectedNode.text.length:0)+"/"+t._s(0==t.selectedNode.type?"1000":"500")+" ")])]):t._e()]),t.selectedNode?t._e():i("div",{staticClass:"card-body p-3"},[t._v(t._s(t.$t("WF.STEP_ERR")))])]):t._e(),!t.selectedNode||5!=t.selectedNode.type&&6!=t.selectedNode.type?t._e():i("div",{staticClass:"card-component mb-3 mr-2"},[i("div",{staticClass:"card-title m-0 pl-3"},[t._v(t._s(t.$t("WF.MODEL_INFO")))]),i("div",{staticClass:"card-body p-3"},[t.selectedNode.model?t._e():i("div",{staticClass:"m-text mb-2"},[i("button",{staticClass:"btn upload-btn",attrs:{type:"button"},on:{click:t.chooseFiles}},[i("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"cloud-upload-alt"}}),t._v(t._s(t.$t("WF.UPLOAD_FILE"))+" ")],1),i("input",{ref:"file",attrs:{type:"file",id:"file",accept:".glb",hidden:""},on:{change:function(e){return t.onChangeFileUpload("model")}}})]),t.selectedNode.model?i("div",{staticClass:"m-text"},[i("div",[t._v(" "+t._s(t.$t("WF.NAME"))+" "),t.selectedNode.modelPath?i("a",{attrs:{href:t.selectedNode.modelPath,target:"_blank"}},[t._v(t._s(t.selectedNode.modelName))]):t._e()]),i("div",[t._v(t._s(t.$t("WF.SIZE"))+t._s((t.selectedNode.modelSize/1024/1024).toFixed(2))+" mb")]),t.selectedNode.modelSnapshot?t._e():i("button",{staticClass:"btn upload-btn mt-2 mr-2",on:{click:function(e){return t.captureModelSnapshot()}}},[i("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"camera"}}),t._v(t._s(t.$t("WF.TAKE_SNAPSHOT"))+" ")],1),t.selectedNode.modelSnapshot?i("button",{staticClass:"btn delete-btn mt-2 mr-2",on:{click:function(e){return t.deleteModelSnapshot()}}},[i("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"times"}}),t._v(t._s(t.$t("WF.DELETE_SNAPSHOT"))+" ")],1):t._e(),i("button",{staticClass:"btn delete-btn mt-2",on:{click:function(e){return t.deleteFile("model")}}},[i("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"times"}}),t._v(t._s(t.$t("WF.DELETE_FILE"))+" ")],1),t.selectedNode.modelSnapshot?i("div",[t.selectedNode.modelSnapshotPath?i("img",{staticClass:"snapshot mt-3",attrs:{src:t.selectedNode.modelSnapshotPath}}):t._e()]):t._e()]):t._e(),i("div",[t.selectedNode.error.model?i("small",{staticClass:"err-msg"},[t._v(t._s(t.$t("WF.UPLOAD_FILE_ERR")))]):t._e()]),i("div",[t.selectedNode.error.modelSnapshot?i("small",{staticClass:"err-msg"},[t._v(t._s(t.$t("WF.ERR_MODEL_SNAPSHOT")))]):t._e()])])]),!t.selectedNode||5!=t.selectedNode.type&&6!=t.selectedNode.type?t._e():i("div",{staticClass:"card-component mb-3 mr-2"},[i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",modifiers:{hover:!0,top:!0}}],staticClass:"card-title m-0 pl-3",attrs:{title:t.isStaticModel?"無動畫可編輯":""}},[t._v(" "+t._s(t.$t("WF.ANIMATION_SETTINGS"))+" "),i("toggle-button",{staticClass:"toggle-btn m-0",attrs:{value:t.selectedNode.animationEnable,sync:!0,color:{checked:"#2173c9",unchecked:"#7b7b7b"},disabled:t.isStaticModel},on:{change:t.onChangeAnimationEnable}})],1),i("b-collapse",{attrs:{visible:t.selectedNode.animationEnable}},[t.model&&t.model.animations.length>0?i("div",{staticClass:"card-body p-3"},[i("div",{staticClass:"model-length my-2"},[t._v(" 動畫總長 "),i("strong",{staticClass:"model-length-text"},[t._v(t._s(t.model.animations[0].duration))]),t._v(" 秒 ")]),i("button",{staticClass:"btn upload-btn mb-2",on:{click:function(e){return t.addAnimationControl()}}},[i("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"cut"}}),t._v(t._s(t.$t("WF.ADD_ANIMATION"))+" ")],1),i("draggable",{staticClass:"animation-list",attrs:{animation:"300"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1,t.updateAnimationControlList()},change:t.dragColumn},model:{value:t.selectedNode.animationControlList,callback:function(e){t.$set(t.selectedNode,"animationControlList",e)},expression:"selectedNode.animationControlList"}},t._l(t.selectedNode.animationControlList,(function(e,n){return i("div",{key:n,staticClass:"animation-track my-2 p-2"},[t._v(" "+t._s(t.$t("WF.ANIMATION"))+t._s(n+1)),i("br"),i("input",{directives:[{name:"model",rawName:"v-model",value:e.start,expression:"item.start"}],staticClass:"animation-input form-control text-center",attrs:{type:"number"},domProps:{value:e.start},on:{change:function(n){return t.durationLimit(e,"start")},input:function(n){n.target.composing||t.$set(e,"start",n.target.value)}}}),t._v(" ~ "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.end,expression:"item.end"}],staticClass:"animation-input form-control text-center",attrs:{type:"number"},domProps:{value:e.end},on:{change:function(n){return t.durationLimit(e,"end")},input:function(n){n.target.composing||t.$set(e,"end",n.target.value)}}}),i("button",{staticClass:"btn animation-btn p-2 ml-2",on:{click:function(n){return t.setAnimationTime(e.start,e.end)}}},[i("font-awesome-icon",{attrs:{icon:"play"}})],1),i("button",{staticClass:"btn animation-btn p-2",on:{click:function(e){return t.deleteAnimationTime(n)}}},[i("font-awesome-icon",{attrs:{icon:"trash"}})],1)])})),0)],1):t._e()])],1),t.selectedNode&&-1!=t.selectedNode.type?i("div",{staticClass:"card-component mb-3 mr-2"},[i("div",{staticClass:"card-title m-0 pl-3"},[t._v(" "+t._s(t.$t("WF.STEP_RECORD"))+" "),i("toggle-button",{staticClass:"toggle-btn m-0",attrs:{value:t.selectedNode.recordCheck,sync:!0,color:{checked:"#2173c9",unchecked:"#7b7b7b"}},on:{change:t.onChangeRecordCheck}})],1),i("b-collapse",{attrs:{visible:t.selectedNode.recordCheck}},[i("div",{staticClass:"card-body p-3"},[i("label",{attrs:{for:"recordType"}},[t._v(t._s(t.$t("WF.RECORD_TYPE")))]),i("b-form-select",{staticClass:"type-select mb-1",attrs:{id:"recordType"},model:{value:t.selectedNode.recordType,callback:function(e){t.$set(t.selectedNode,"recordType",e)},expression:"selectedNode.recordType"}},t._l(t.recordTypeList,(function(e){return i("b-form-select-option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(t.$t(e.text)))])})),1),i("b-form-checkbox",{staticClass:"mb-3",attrs:{name:"check-button"},model:{value:t.selectedNode.isRecordRequired,callback:function(e){t.$set(t.selectedNode,"isRecordRequired",e)},expression:"selectedNode.isRecordRequired"}},[t._v(" "+t._s(t.$t("WF.STEP_TITLE_REQUIRED"))+" ")]),i("label",{attrs:{for:"recordDesc"}},[t._v(t._s(t.$t("WF.RECORD_DESC")))]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.selectedNode.recordDesc,expression:"selectedNode.recordDesc"}],staticClass:"form-control mb-1",class:{"err-input":t.selectedNode.error.recordDesc},attrs:{type:"text",id:"recordDesc",placeholder:t.$t("WF.RECORD_DESC_PH"),rows:"5",maxlength:"500"},domProps:{value:t.selectedNode.recordDesc},on:{input:[function(e){e.target.composing||t.$set(t.selectedNode,"recordDesc",e.target.value)},function(e){return t.onValueCheck("recordDesc")}],blur:function(e){return t.onValueCheck("recordDesc")}}}),t._v(" "),t.selectedNode.error.recordDesc?i("small",{staticClass:"err-msg float-left"},[t._v(t._s(t.$t("WF.ERR_RECORD_DESC")))]):t._e(),i("div",{staticClass:"desc-count text-right"},[t._v(" "+t._s(t.selectedNode.recordDesc?t.selectedNode.recordDesc.length:0)+"/500 ")])],1)])],1):t._e(),t.selectedNode&&-1!=t.selectedNode.type?i("div",{staticClass:"card-component mb-3 mr-2"},[i("div",{staticClass:"card-title m-0 pl-3"},[t._v(" "+t._s(t.$t("WF.STEP_CHECK"))+" "),i("toggle-button",{staticClass:"toggle-btn m-0",attrs:{value:t.selectedNode.isCheck,sync:!0,color:{checked:"#2173c9",unchecked:"#7b7b7b"}},on:{change:function(e){t.selectedNode.isCheck=!t.selectedNode.isCheck}}})],1),i("b-collapse",{attrs:{visible:t.selectedNode.isCheck}},[i("div",{staticClass:"card-body p-3"},[t.selectedNode.error.pass_text||t.selectedNode.error.fail_text?i("small",{staticClass:"err-msg float-left"},[t._v(t._s(t.$t("WF.ERR_VALIDATION_TEXT")))]):t._e(),i("b-form-select",{staticClass:"type-select mb-1",on:{change:t.setCustomizedValidation},model:{value:t.validationType,callback:function(e){t.validationType=e},expression:"validationType"}},t._l(t.validationTypeList,(function(e,n){return i("b-form-select-option",{key:e.value,attrs:{value:n}},[t._v(t._s(e.text))])})),1),i("b-form-checkbox",{attrs:{role:"button",name:"check-button"},model:{value:t.selectedNode.isCustomizedValidation,callback:function(e){t.$set(t.selectedNode,"isCustomizedValidation",e)},expression:"selectedNode.isCustomizedValidation"}},[t._v(" "+t._s(t.$t("WF.CUSTOMIZED_PASS_FAIL_TEXT"))+" ")]),t.selectedNode.isCustomizedValidation?i("div",[i("div",{staticClass:"pass my-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedNode.pass_text,expression:"selectedNode.pass_text"}],staticClass:"form-control pass-text text-center",attrs:{type:"text",placeholder:t.selectedNode.pass_text,maxlength:"20"},domProps:{value:t.selectedNode.pass_text},on:{change:function(e){return t.selectedNode.__ob__.dep.notify()},input:[function(e){e.target.composing||t.$set(t.selectedNode,"pass_text",e.target.value)},function(e){return t.onValueCheck("pass_text")}],blur:function(e){return t.onValueCheck("pass_text")}}}),i("b-icon",{staticClass:"pass-icon",attrs:{icon:"check-circle-fill"}})],1),i("div",{staticClass:"fail my-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedNode.fail_text,expression:"selectedNode.fail_text"}],staticClass:"form-control fail-text text-center",attrs:{type:"text",placeholder:t.selectedNode.fail_text,maxlength:"20"},domProps:{value:t.selectedNode.fail_text},on:{change:function(e){return t.selectedNode.__ob__.dep.notify()},input:[function(e){e.target.composing||t.$set(t.selectedNode,"fail_text",e.target.value)},function(e){return t.onValueCheck("fail_text")}],blur:function(e){return t.onValueCheck("fail_text")}}}),i("b-icon",{staticClass:"fail-icon",attrs:{icon:"x-circle-fill"}})],1)]):t._e(),i("b-form-checkbox",{attrs:{role:"button",name:"check-button"},model:{value:t.selectedNode.isStepSkippable,callback:function(e){t.$set(t.selectedNode,"isStepSkippable",e)},expression:"selectedNode.isStepSkippable"}},[t._v(" "+t._s(t.$t("WF.SKIPPABLE"))+" ")])],1)])],1):t._e()]),i("div",{staticClass:"save-and-publish text-center row"},[i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",modifiers:{hover:!0,top:!0}}],staticClass:"col-4 exit p-2",attrs:{role:"button",title:t.$t("WF.LEAVE")},on:{click:t.leave}},[i("font-awesome-icon",{attrs:{icon:"door-open"}})],1),i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",modifiers:{hover:!0,top:!0}}],staticClass:"col-4 save p-2",attrs:{role:"button",title:t.$t("WF.SAVE")},on:{click:t.save}},[i("font-awesome-icon",{attrs:{icon:"save"}})],1),i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",modifiers:{hover:!0,top:!0}}],staticClass:"col-4 publish p-2",attrs:{role:"button",title:t.$t("WF.PUBLISH")},on:{click:t.showPublish}},[i("font-awesome-icon",{attrs:{icon:"cloud-upload-alt"}})],1)])])]),t.modalType.publish?i("Publish",{attrs:{doPublish:t.doPublish},on:{cancel:function(e){return t.closeModal("publish",!1)}}}):t._e()],1)},r=[],o=n("b85c"),a=n("2909"),s=(n("ac1f"),n("1276"),n("ace4"),n("d3b7"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("99af"),n("d81d"),n("b0c0"),n("4e82"),n("4de4"),n("c740"),n("7db0"),n("159b"),n("a434"),n("b680"),n("0418")),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chart",style:{width:isNaN(t.width)?t.width:t.width+"px",height:isNaN(t.height)?t.height:t.height+"px",cursor:t.cursor},attrs:{tabindex:"0"},on:{mousemove:t.handleChartMouseMove,mouseup:t.handleChartMouseUp,mousewheel:t.handleChartMouseWheel,mousedown:function(e){return t.handleChartMouseDown(e)}}},[n("svg",{style:{zoom:t.zoom},attrs:{id:"svg"}},[n("rect",{staticClass:"selection",attrs:{height:"0",width:"0"}})]),n("div",{staticClass:"zoom-ratio"},[n("span",[t._v(t._s(100*t.zoom)+"%")])])])},c=[];n("a4d3"),n("e01a"),n("d28b"),n("3ca3"),n("ddb0");function u(t){return u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}var h=n("1da1"),d=n("bee2"),p=n("d4ec"),f=(n("96cf"),n("e9c4"),n("25f0"),n("b65f"),n("4057"),n("a15b"),n("5319"),function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}),m=function(t){return 1===t.length&&(t=g(t)),{left:function(e,n,i,r){null==i&&(i=0),null==r&&(r=e.length);while(i<r){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){null==i&&(i=0),null==r&&(r=e.length);while(i<r){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}};function g(t){return function(e,n){return f(t(e),n)}}var v=m(f);v.right,v.left;var x=Array.prototype;x.slice,x.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);Array.prototype.slice;var y={value:function(){}};function _(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new b(i)}function b(t){this._=t}function w(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function M(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function S(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=y,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}b.prototype=_.prototype={constructor:b,on:function(t,e){var n,i=this._,r=w(t+"",i),o=-1,a=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);while(++o<a)if(n=(t=r[o]).type)i[n]=S(i[n],t.name,e);else if(null==e)for(n in i)i[n]=S(i[n],t.name,null);return this}while(++o<a)if((n=(t=r[o]).type)&&(n=M(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new b(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],o=0,n=i.length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};var T=_;function E(){}var C=function(t){return null==t?E:function(){return this.querySelector(t)}},A=function(t){"function"!==typeof t&&(t=C(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a,s=e[r],l=s.length,c=i[r]=new Array(l),u=0;u<l;++u)(o=s[u])&&(a=t.call(o,o.__data__,u,s))&&("__data__"in o&&(a.__data__=o.__data__),c[u]=a);return new fe(i,this._parents)};function L(){return[]}var R=function(t){return null==t?L:function(){return this.querySelectorAll(t)}},P=function(t){"function"!==typeof t&&(t=R(t));for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,c=0;c<l;++c)(a=s[c])&&(i.push(t.call(a,a.__data__,c,s)),r.push(a));return new fe(i,r)},N=function(t){return function(){return this.matches(t)}},D=function(t){"function"!==typeof t&&(t=N(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,l=i[r]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&l.push(o);return new fe(i,this._parents)},k=function(t){return new Array(t.length)},I=function(){return new fe(this._enter||this._groups.map(k),this._parents)};function O(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}O.prototype={constructor:O,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var F=function(t){return function(){return t}},U="$";function z(t,e,n,i,r,o){for(var a,s=0,l=e.length,c=o.length;s<c;++s)(a=e[s])?(a.__data__=o[s],i[s]=a):n[s]=new O(t,o[s]);for(;s<l;++s)(a=e[s])&&(r[s]=a)}function H(t,e,n,i,r,o,a){var s,l,c,u={},h=e.length,d=o.length,p=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(p[s]=c=U+a.call(l,l.__data__,s,e),c in u?r[s]=l:u[c]=l);for(s=0;s<d;++s)c=U+a.call(t,o[s],s,o),(l=u[c])?(i[s]=l,l.__data__=o[s],u[c]=null):n[s]=new O(t,o[s]);for(s=0;s<h;++s)(l=e[s])&&u[p[s]]===l&&(r[s]=l)}var B=function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each((function(t){p[++c]=t})),p;var n=e?H:z,i=this._parents,r=this._groups;"function"!==typeof t&&(t=F(t));for(var o=r.length,a=new Array(o),s=new Array(o),l=new Array(o),c=0;c<o;++c){var u=i[c],h=r[c],d=h.length,p=t.call(u,u&&u.__data__,c,i),f=p.length,m=s[c]=new Array(f),g=a[c]=new Array(f),v=l[c]=new Array(d);n(u,h,m,g,v,p,e);for(var x,y,_=0,b=0;_<f;++_)if(x=m[_]){_>=b&&(b=_+1);while(!(y=g[b])&&++b<f);x._next=y||null}}return a=new fe(a,i),a._enter=s,a._exit=l,a},V=function(){return new fe(this._exit||this._groups.map(k),this._parents)},G=function(t,e,n){var i=this.enter(),r=this,o=this.exit();return i="function"===typeof t?t(i):i.append(t+""),null!=e&&(r=e(r)),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},W=function(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var l,c=e[s],u=n[s],h=c.length,d=a[s]=new Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;s<i;++s)a[s]=e[s];return new fe(a,this._parents)},j=function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,a=r[o];--o>=0;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},q=function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=X);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var a,s=n[o],l=s.length,c=r[o]=new Array(l),u=0;u<l;++u)(a=s[u])&&(c[u]=a);c.sort(e)}return new fe(r,this._parents).order()};function X(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var Y=function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},$=function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},Z=function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},J=function(){var t=0;return this.each((function(){++t})),t},K=function(){return!this.node()},Q=function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],a=0,s=o.length;a<s;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},tt="http://www.w3.org/1999/xhtml",et={svg:"http://www.w3.org/2000/svg",xhtml:tt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},nt=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),et.hasOwnProperty(e)?{space:et[e],local:t}:t};function it(t){return function(){this.removeAttribute(t)}}function rt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ot(t,e){return function(){this.setAttribute(t,e)}}function at(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function st(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function lt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var ct=function(t,e){var n=nt(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?rt:it:"function"===typeof e?n.local?lt:st:n.local?at:ot)(n,e))},ut=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function ht(t){return function(){this.style.removeProperty(t)}}function dt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function pt(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}var ft=function(t,e,n){return arguments.length>1?this.each((null==e?ht:"function"===typeof e?pt:dt)(t,e,null==n?"":n)):mt(this.node(),t)};function mt(t,e){return t.style.getPropertyValue(e)||ut(t).getComputedStyle(t,null).getPropertyValue(e)}function gt(t){return function(){delete this[t]}}function vt(t,e){return function(){this[t]=e}}function xt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}var yt=function(t,e){return arguments.length>1?this.each((null==e?gt:"function"===typeof e?xt:vt)(t,e)):this.node()[t]};function _t(t){return t.trim().split(/^|\s+/)}function bt(t){return t.classList||new wt(t)}function wt(t){this._node=t,this._names=_t(t.getAttribute("class")||"")}function Mt(t,e){var n=bt(t),i=-1,r=e.length;while(++i<r)n.add(e[i])}function St(t,e){var n=bt(t),i=-1,r=e.length;while(++i<r)n.remove(e[i])}function Tt(t){return function(){Mt(this,t)}}function Et(t){return function(){St(this,t)}}function Ct(t,e){return function(){(e.apply(this,arguments)?Mt:St)(this,t)}}wt.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var At=function(t,e){var n=_t(t+"");if(arguments.length<2){var i=bt(this.node()),r=-1,o=n.length;while(++r<o)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"===typeof e?Ct:e?Tt:Et)(n,e))};function Lt(){this.textContent=""}function Rt(t){return function(){this.textContent=t}}function Pt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}var Nt=function(t){return arguments.length?this.each(null==t?Lt:("function"===typeof t?Pt:Rt)(t)):this.node().textContent};function Dt(){this.innerHTML=""}function kt(t){return function(){this.innerHTML=t}}function It(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}var Ot=function(t){return arguments.length?this.each(null==t?Dt:("function"===typeof t?It:kt)(t)):this.node().innerHTML};function Ft(){this.nextSibling&&this.parentNode.appendChild(this)}var Ut=function(){return this.each(Ft)};function zt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}var Ht=function(){return this.each(zt)};function Bt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===tt&&e.documentElement.namespaceURI===tt?e.createElement(t):e.createElementNS(n,t)}}function Vt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var Gt=function(t){var e=nt(t);return(e.local?Vt:Bt)(e)},Wt=function(t){var e="function"===typeof t?t:Gt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))};function jt(){return null}var qt=function(t,e){var n="function"===typeof t?t:Gt(t),i=null==e?jt:"function"===typeof e?e:C(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))};function Xt(){var t=this.parentNode;t&&t.removeChild(this)}var Yt=function(){return this.each(Xt)};function $t(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Zt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var Jt=function(t){return this.select(t?Zt:$t)},Kt=function(t){return arguments.length?this.property("__data__",t):this.node().__data__},Qt={},te=null;if("undefined"!==typeof document){var ee=document.documentElement;"onmouseenter"in ee||(Qt={mouseenter:"mouseover",mouseleave:"mouseout"})}function ne(t,e,n){return t=ie(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function ie(t,e,n){return function(i){var r=te;te=i;try{t.call(this,this.__data__,e,n)}finally{te=r}}}function re(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function oe(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?e.length=r:delete this.__on}}}function ae(t,e,n){var i=Qt.hasOwnProperty(t.type)?ne:ie;return function(r,o,a){var s,l=this.__on,c=i(e,o,a);if(l)for(var u=0,h=l.length;u<h;++u)if((s=l[u]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},l?l.push(s):this.__on=[s]}}var se=function(t,e,n){var i,r,o=re(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?ae:oe,null==n&&(n=!1),i=0;i<a;++i)this.each(s(o[i],e,n));return this}var s=this.node().__on;if(s)for(var l,c=0,u=s.length;c<u;++c)for(i=0,l=s[c];i<a;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value};function le(t,e,n,i){var r=te;t.sourceEvent=te,te=t;try{return e.apply(n,i)}finally{te=r}}function ce(t,e,n){var i=ut(t),r=i.CustomEvent;"function"===typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ue(t,e){return function(){return ce(this,t,e)}}function he(t,e){return function(){return ce(this,t,e.apply(this,arguments))}}var de=function(t,e){return this.each(("function"===typeof e?he:ue)(t,e))},pe=[null];function fe(t,e){this._groups=t,this._parents=e}function me(){return new fe([[document.documentElement]],pe)}fe.prototype=me.prototype={constructor:fe,select:A,selectAll:P,filter:D,data:B,enter:I,exit:V,join:G,merge:W,order:j,sort:q,call:Y,nodes:$,node:Z,size:J,empty:K,each:Q,attr:ct,style:ft,property:yt,classed:At,text:Nt,html:Ot,raise:Ut,lower:Ht,append:Wt,insert:qt,remove:Yt,clone:Jt,datum:Kt,on:se,dispatch:de};var ge=me,ve=function(t){return"string"===typeof t?new fe([[document.querySelector(t)]],[document.documentElement]):new fe([[t]],pe)};function xe(){te.stopImmediatePropagation()}var ye=function(){te.preventDefault(),te.stopImmediatePropagation()},_e=function(t){var e=t.document.documentElement,n=ve(t).on("dragstart.drag",ye,!0);"onselectstart"in e?n.on("selectstart.drag",ye,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function be(t,e){var n=t.document.documentElement,i=ve(t).on("dragstart.drag",null);e&&(i.on("click.drag",ye,!0),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var we=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Me(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Se(){}var Te=.7,Ee=1/Te,Ce="\\s*([+-]?\\d+)\\s*",Ae="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Le="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Re=/^#([0-9a-f]{3,8})$/,Pe=new RegExp("^rgb\\("+[Ce,Ce,Ce]+"\\)$"),Ne=new RegExp("^rgb\\("+[Le,Le,Le]+"\\)$"),De=new RegExp("^rgba\\("+[Ce,Ce,Ce,Ae]+"\\)$"),ke=new RegExp("^rgba\\("+[Le,Le,Le,Ae]+"\\)$"),Ie=new RegExp("^hsl\\("+[Ae,Le,Le]+"\\)$"),Oe=new RegExp("^hsla\\("+[Ae,Le,Le,Ae]+"\\)$"),Fe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ue(){return this.rgb().formatHex()}function ze(){return Je(this).formatHsl()}function He(){return this.rgb().formatRgb()}function Be(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Re.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ve(e):3===n?new qe(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ge(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ge(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Pe.exec(t))?new qe(e[1],e[2],e[3],1):(e=Ne.exec(t))?new qe(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=De.exec(t))?Ge(e[1],e[2],e[3],e[4]):(e=ke.exec(t))?Ge(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ie.exec(t))?Ze(e[1],e[2]/100,e[3]/100,1):(e=Oe.exec(t))?Ze(e[1],e[2]/100,e[3]/100,e[4]):Fe.hasOwnProperty(t)?Ve(Fe[t]):"transparent"===t?new qe(NaN,NaN,NaN,0):null}function Ve(t){return new qe(t>>16&255,t>>8&255,255&t,1)}function Ge(t,e,n,i){return i<=0&&(t=e=n=NaN),new qe(t,e,n,i)}function We(t){return t instanceof Se||(t=Be(t)),t?(t=t.rgb(),new qe(t.r,t.g,t.b,t.opacity)):new qe}function je(t,e,n,i){return 1===arguments.length?We(t):new qe(t,e,n,null==i?1:i)}function qe(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Xe(){return"#"+$e(this.r)+$e(this.g)+$e(this.b)}function Ye(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function $e(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function Ze(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Qe(t,e,n,i)}function Je(t){if(t instanceof Qe)return new Qe(t.h,t.s,t.l,t.opacity);if(t instanceof Se||(t=Be(t)),!t)return new Qe;if(t instanceof Qe)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),a=NaN,s=o-r,l=(o+r)/2;return s?(a=e===o?(n-i)/s+6*(n<i):n===o?(i-e)/s+2:(e-n)/s+4,s/=l<.5?o+r:2-o-r,a*=60):s=l>0&&l<1?0:a,new Qe(a,s,l,t.opacity)}function Ke(t,e,n,i){return 1===arguments.length?Je(t):new Qe(t,e,n,null==i?1:i)}function Qe(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function tn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function en(t,e,n,i,r){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*i+a*r)/6}we(Se,Be,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ue,formatHex:Ue,formatHsl:ze,formatRgb:He,toString:He}),we(qe,je,Me(Se,{brighter:function(t){return t=null==t?Ee:Math.pow(Ee,t),new qe(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Te:Math.pow(Te,t),new qe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xe,formatHex:Xe,formatRgb:Ye,toString:Ye})),we(Qe,Ke,Me(Se,{brighter:function(t){return t=null==t?Ee:Math.pow(Ee,t),new Qe(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Te:Math.pow(Te,t),new Qe(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new qe(tn(t>=240?t-240:t+120,r,i),tn(t,r,i),tn(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var nn=function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1],a=i>0?t[i-1]:2*r-o,s=i<e-1?t[i+2]:2*o-r;return en((n-i/e)*e,a,r,o,s)}},rn=function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],o=t[i%e],a=t[(i+1)%e],s=t[(i+2)%e];return en((n-i/e)*e,r,o,a,s)}},on=function(t){return function(){return t}};function an(t,e){return function(n){return t+n*e}}function sn(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function ln(t){return 1===(t=+t)?cn:function(e,n){return n-e?sn(e,n,t):on(isNaN(e)?n:e)}}function cn(t,e){var n=e-t;return n?an(t,n):on(isNaN(t)?e:t)}var un=function t(e){var n=ln(e);function i(t,e){var i=n((t=je(t)).r,(e=je(e)).r),r=n(t.g,e.g),o=n(t.b,e.b),a=cn(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=o(e),t.opacity=a(e),t+""}}return i.gamma=t,i}(1);function hn(t){return function(e){var n,i,r=e.length,o=new Array(r),a=new Array(r),s=new Array(r);for(n=0;n<r;++n)i=je(e[n]),o[n]=i.r||0,a[n]=i.g||0,s[n]=i.b||0;return o=t(o),a=t(a),s=t(s),i.opacity=1,function(t){return i.r=o(t),i.g=a(t),i.b=s(t),i+""}}}hn(nn),hn(rn);var dn=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},pn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fn=new RegExp(pn.source,"g");function mn(t){return function(){return t}}function gn(t){return function(e){return t(e)+""}}var vn,xn,yn=function(t,e){var n,i,r,o=pn.lastIndex=fn.lastIndex=0,a=-1,s=[],l=[];t+="",e+="";while((n=pn.exec(t))&&(i=fn.exec(e)))(r=i.index)>o&&(r=e.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:dn(n,i)})),o=fn.lastIndex;return o<e.length&&(r=e.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?gn(l[0].x):mn(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)s[(n=l[i]).i]=n.x(t);return s.join("")})},_n=function(){var t,e=te;while(t=e.sourceEvent)e=t;return e},bn=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]},wn=function(t,e,n){arguments.length<3&&(n=e,e=_n().changedTouches);for(var i,r=0,o=e?e.length:0;r<o;++r)if((i=e[r]).identifier===n)return bn(t,i);return null},Mn=function(t){var e=_n();return e.changedTouches&&(e=e.changedTouches[0]),bn(t,e)},Sn=0,Tn=0,En=0,Cn=1e3,An=0,Ln=0,Rn=0,Pn="object"===typeof performance&&performance.now?performance:Date,Nn="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Dn(){return Ln||(Nn(kn),Ln=Pn.now()+Rn)}function kn(){Ln=0}function In(){this._call=this._time=this._next=null}function On(t,e,n){var i=new In;return i.restart(t,e,n),i}function Fn(){Dn(),++Sn;var t,e=vn;while(e)(t=Ln-e._time)>=0&&e._call.call(null,t),e=e._next;--Sn}function Un(){Ln=(An=Pn.now())+Rn,Sn=Tn=0;try{Fn()}finally{Sn=0,Hn(),Ln=0}}function zn(){var t=Pn.now(),e=t-An;e>Cn&&(Rn-=e,An=t)}function Hn(){var t,e,n=vn,i=1/0;while(n)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:vn=e);xn=t,Bn(i)}function Bn(t){if(!Sn){Tn&&(Tn=clearTimeout(Tn));var e=t-Ln;e>24?(t<1/0&&(Tn=setTimeout(Un,t-Pn.now()-Rn)),En&&(En=clearInterval(En))):(En||(An=Pn.now(),En=setInterval(zn,Cn)),Sn=1,Nn(Un))}}In.prototype=On.prototype={constructor:In,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?Dn():+n)+(null==e?0:+e),this._next||xn===this||(xn?xn._next=this:vn=this,xn=this),this._call=t,this._time=n,Bn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Bn())}};var Vn=function(t,e,n){var i=new In;return e=null==e?0:+e,i.restart((function(n){i.stop(),t(n+e)}),e,n),i},Gn=T("start","end","cancel","interrupt"),Wn=[],jn=0,qn=1,Xn=2,Yn=3,$n=4,Zn=5,Jn=6,Kn=function(t,e,n,i,r,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};ni(t,n,{name:e,index:i,group:r,on:Gn,tween:Wn,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:jn})};function Qn(t,e){var n=ei(t,e);if(n.state>jn)throw new Error("too late; already scheduled");return n}function ti(t,e){var n=ei(t,e);if(n.state>Yn)throw new Error("too late; already running");return n}function ei(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ni(t,e,n){var i,r=t.__transition;function o(t){n.state=qn,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}function a(o){var c,u,h,d;if(n.state!==qn)return l();for(c in r)if(d=r[c],d.name===n.name){if(d.state===Yn)return Vn(a);d.state===$n?(d.state=Jn,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=Jn,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Vn((function(){n.state===Yn&&(n.state=$n,n.timer.restart(s,n.delay,n.time),s(o))})),n.state=Xn,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Xn){for(n.state=Yn,i=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=d);i.length=u+1}}function s(e){var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=Zn,1),o=-1,a=i.length;while(++o<a)i[o].call(t,r);n.state===Zn&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var i in n.state=Jn,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=On(o,0,n.time)}var ii,ri,oi,ai,si=function(t,e){var n,i,r,o=t.__transition,a=!0;if(o){for(r in e=null==e?null:e+"",o)(n=o[r]).name===e?(i=n.state>Xn&&n.state<Zn,n.state=Jn,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[r]):a=!1;a&&delete t.__transition}},li=function(t){return this.each((function(){si(this,t)}))},ci=180/Math.PI,ui={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},hi=function(t,e,n,i,r,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),t*i<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*ci,skewX:Math.atan(l)*ci,scaleX:a,scaleY:s}};function di(t){return"none"===t?ui:(ii||(ii=document.createElement("DIV"),ri=document.documentElement,oi=document.defaultView),ii.style.transform=t,t=oi.getComputedStyle(ri.appendChild(ii),null).getPropertyValue("transform"),ri.removeChild(ii),t=t.slice(7,-1).split(","),hi(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function pi(t){return null==t?ui:(ai||(ai=document.createElementNS("http://www.w3.org/2000/svg","g")),ai.setAttribute("transform",t),(t=ai.transform.baseVal.consolidate())?(t=t.matrix,hi(t.a,t.b,t.c,t.d,t.e,t.f)):ui)}function fi(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}function o(t,i,r,o,a,s){if(t!==r||i!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:dn(t,r)},{i:l-2,x:dn(i,o)})}else(r||o)&&a.push("translate("+r+e+o+n)}function a(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:dn(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}function s(t,e,n,o){t!==e?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:dn(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}function l(t,e,n,i,o,a){if(t!==n||e!==i){var s=o.push(r(o)+"scale(",null,",",null,")");a.push({i:s-4,x:dn(t,n)},{i:s-2,x:dn(e,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}return function(e,n){var i=[],r=[];return e=t(e),n=t(n),o(e.translateX,e.translateY,n.translateX,n.translateY,i,r),a(e.rotate,n.rotate,i,r),s(e.skewX,n.skewX,i,r),l(e.scaleX,e.scaleY,n.scaleX,n.scaleY,i,r),e=n=null,function(t){var e,n=-1,o=r.length;while(++n<o)i[(e=r[n]).i]=e.x(t);return i.join("")}}}var mi=fi(di,"px, ","px)","deg)"),gi=fi(pi,", ",")",")");function vi(t,e){var n,i;return function(){var r=ti(this,t),o=r.tween;if(o!==n){i=n=o;for(var a=0,s=i.length;a<s;++a)if(i[a].name===e){i=i.slice(),i.splice(a,1);break}}r.tween=i}}function xi(t,e,n){var i,r;if("function"!==typeof n)throw new Error;return function(){var o=ti(this,t),a=o.tween;if(a!==i){r=(i=a).slice();for(var s={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=s;break}l===c&&r.push(s)}o.tween=r}}var yi=function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=ei(this.node(),n).tween,o=0,a=r.length;o<a;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?vi:xi)(n,t,e))};function _i(t,e,n){var i=t._id;return t.each((function(){var t=ti(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return ei(t,i).value[e]}}var bi=function(t,e){var n;return("number"===typeof e?dn:e instanceof Be?un:(n=Be(e))?(e=n,un):yn)(t,e)};function wi(t){return function(){this.removeAttribute(t)}}function Mi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Si(t,e,n){var i,r,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===i?r:r=e(i=a,n)}}function Ti(t,e,n){var i,r,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===i?r:r=e(i=a,n)}}function Ei(t,e,n){var i,r,o;return function(){var a,s,l=n(this);if(null!=l)return a=this.getAttribute(t),s=l+"",a===s?null:a===i&&s===r?o:(r=s,o=e(i=a,l));this.removeAttribute(t)}}function Ci(t,e,n){var i,r,o;return function(){var a,s,l=n(this);if(null!=l)return a=this.getAttributeNS(t.space,t.local),s=l+"",a===s?null:a===i&&s===r?o:(r=s,o=e(i=a,l));this.removeAttributeNS(t.space,t.local)}}var Ai=function(t,e){var n=nt(t),i="transform"===n?gi:bi;return this.attrTween(t,"function"===typeof e?(n.local?Ci:Ei)(n,i,_i(this,"attr."+t,e)):null==e?(n.local?Mi:wi)(n):(n.local?Ti:Si)(n,i,e))};function Li(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ri(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Pi(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Ri(t,r)),n}return r._value=e,r}function Ni(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Li(t,r)),n}return r._value=e,r}var Di=function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!==typeof e)throw new Error;var i=nt(t);return this.tween(n,(i.local?Pi:Ni)(i,e))};function ki(t,e){return function(){Qn(this,t).delay=+e.apply(this,arguments)}}function Ii(t,e){return e=+e,function(){Qn(this,t).delay=e}}var Oi=function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?ki:Ii)(e,t)):ei(this.node(),e).delay};function Fi(t,e){return function(){ti(this,t).duration=+e.apply(this,arguments)}}function Ui(t,e){return e=+e,function(){ti(this,t).duration=e}}var zi=function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?Fi:Ui)(e,t)):ei(this.node(),e).duration};function Hi(t,e){if("function"!==typeof e)throw new Error;return function(){ti(this,t).ease=e}}var Bi=function(t){var e=this._id;return arguments.length?this.each(Hi(e,t)):ei(this.node(),e).ease},Vi=function(t){"function"!==typeof t&&(t=N(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,l=i[r]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&l.push(o);return new vr(i,this._parents,this._name,this._id)},Gi=function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var l,c=e[s],u=n[s],h=c.length,d=a[s]=new Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;s<i;++s)a[s]=e[s];return new vr(a,this._parents,this._name,this._id)};function Wi(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}function ji(t,e,n){var i,r,o=Wi(e)?Qn:ti;return function(){var a=o(this,t),s=a.on;s!==i&&(r=(i=s).copy()).on(e,n),a.on=r}}var qi=function(t,e){var n=this._id;return arguments.length<2?ei(this.node(),n).on.on(t):this.each(ji(n,t,e))};function Xi(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}var Yi=function(){return this.on("end.remove",Xi(this._id))},$i=function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=C(t));for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a)for(var s,l,c=i[a],u=c.length,h=o[a]=new Array(u),d=0;d<u;++d)(s=c[d])&&(l=t.call(s,s.__data__,d,c))&&("__data__"in s&&(l.__data__=s.__data__),h[d]=l,Kn(h[d],e,n,d,h,ei(s,n)));return new vr(o,this._parents,e,n)},Zi=function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=R(t));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var l,c=i[s],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,p=t.call(l,l.__data__,h,c),f=ei(l,n),m=0,g=p.length;m<g;++m)(d=p[m])&&Kn(d,e,n,m,p,f);o.push(p),a.push(l)}return new vr(o,a,e,n)},Ji=ge.prototype.constructor,Ki=function(){return new Ji(this._groups,this._parents)};function Qi(t,e){var n,i,r;return function(){var o=mt(this,t),a=(this.style.removeProperty(t),mt(this,t));return o===a?null:o===n&&a===i?r:r=e(n=o,i=a)}}function tr(t){return function(){this.style.removeProperty(t)}}function er(t,e,n){var i,r,o=n+"";return function(){var a=mt(this,t);return a===o?null:a===i?r:r=e(i=a,n)}}function nr(t,e,n){var i,r,o;return function(){var a=mt(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=mt(this,t)),a===l?null:a===i&&l===r?o:(r=l,o=e(i=a,s))}}function ir(t,e){var n,i,r,o,a="style."+e,s="end."+a;return function(){var l=ti(this,t),c=l.on,u=null==l.value[a]?o||(o=tr(e)):void 0;c===n&&r===u||(i=(n=c).copy()).on(s,r=u),l.on=i}}var rr=function(t,e,n){var i="transform"===(t+="")?mi:bi;return null==e?this.styleTween(t,Qi(t,i)).on("end.style."+t,tr(t)):"function"===typeof e?this.styleTween(t,nr(t,i,_i(this,"style."+t,e))).each(ir(this._id,t)):this.styleTween(t,er(t,i,e),n).on("end.style."+t,null)};function or(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function ar(t,e,n){var i,r;function o(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&or(t,o,n)),i}return o._value=e,o}var sr=function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!==typeof e)throw new Error;return this.tween(i,ar(t,e,null==n?"":n))};function lr(t){return function(){this.textContent=t}}function cr(t){return function(){var e=t(this);this.textContent=null==e?"":e}}var ur=function(t){return this.tween("text","function"===typeof t?cr(_i(this,"text",t)):lr(null==t?"":t+""))};function hr(t){return function(e){this.textContent=t.call(this,e)}}function dr(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&hr(i)),e}return i._value=t,i}var pr=function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!==typeof t)throw new Error;return this.tween(e,dr(t))},fr=function(){for(var t=this._name,e=this._id,n=yr(),i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,c=0;c<l;++c)if(a=s[c]){var u=ei(a,e);Kn(a,t,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new vr(i,this._parents,t,n)},mr=function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0===--r&&o()}};n.each((function(){var n=ti(this,i),r=n.on;r!==t&&(e=(t=r).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e}))}))},gr=0;function vr(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function xr(t){return ge().transition(t)}function yr(){return++gr}var _r=ge.prototype;function br(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}vr.prototype=xr.prototype={constructor:vr,select:$i,selectAll:Zi,filter:Vi,merge:Gi,selection:Ki,transition:fr,call:_r.call,nodes:_r.nodes,node:_r.node,size:_r.size,empty:_r.empty,each:_r.each,on:qi,attr:Ai,attrTween:Di,style:rr,styleTween:sr,text:ur,textTween:pr,remove:Yi,tween:yi,delay:Oi,duration:zi,ease:Bi,end:mr};var wr={time:null,delay:0,duration:250,ease:br};function Mr(t,e){var n;while(!(n=t.__transition)||!(n=n[e]))if(!(t=t.parentNode))return wr.time=Dn(),wr;return n}var Sr=function(t){var e,n;t instanceof vr?(e=t._id,t=t._name):(e=yr(),(n=wr).time=Dn(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,c=0;c<l;++c)(a=s[c])&&Kn(a,t,e,c,s,n||Mr(a,e));return new vr(i,this._parents,t,e)};ge.prototype.interrupt=li,ge.prototype.transition=Sr;function Tr(t){return[+t[0],+t[1]]}function Er(t){return[Tr(t[0]),Tr(t[1])]}["w","e"].map(Cr),["n","s"].map(Cr),["n","w","e","s","nw","ne","sw","se"].map(Cr);function Cr(t){return{type:t}}Math.cos,Math.sin,Math.PI,Math.max;Array.prototype.slice;var Ar=Math.PI,Lr=2*Ar,Rr=1e-6,Pr=Lr-Rr;function Nr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Dr(){return new Nr}Nr.prototype=Dr.prototype={constructor:Nr,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-t,l=i-e,c=o-t,u=a-e,h=c*c+u*u;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>Rr)if(Math.abs(u*s-l*c)>Rr&&r){var d=n-o,p=i-a,f=s*s+l*l,m=d*d+p*p,g=Math.sqrt(f),v=Math.sqrt(h),x=r*Math.tan((Ar-Math.acos((f+h-m)/(2*g*v)))/2),y=x/v,_=x/g;Math.abs(y-1)>Rr&&(this._+="L"+(t+y*c)+","+(e+y*u)),this._+="A"+r+","+r+",0,0,"+ +(u*d>c*p)+","+(this._x1=t+_*s)+","+(this._y1=e+_*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,o){t=+t,e=+e,n=+n,o=!!o;var a=n*Math.cos(i),s=n*Math.sin(i),l=t+a,c=e+s,u=1^o,h=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>Rr||Math.abs(this._y1-c)>Rr)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%Lr+Lr),h>Pr?this._+="A"+n+","+n+",0,1,"+u+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>Rr&&(this._+="A"+n+","+n+",0,"+ +(h>=Ar)+","+u+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var kr=Dr;var Ir="$";function Or(){}function Fr(t,e){var n=new Or;if(t instanceof Or)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var i,r=-1,o=t.length;if(null==e)while(++r<o)n.set(r,t[r]);else while(++r<o)n.set(e(i=t[r],r,t),i)}else if(t)for(var a in t)n.set(a,t[a]);return n}Or.prototype=Fr.prototype={constructor:Or,has:function(t){return Ir+t in this},get:function(t){return this[Ir+t]},set:function(t,e){return this[Ir+t]=e,this},remove:function(t){var e=Ir+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Ir&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Ir&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Ir&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Ir&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Ir&&++t;return t},empty:function(){for(var t in this)if(t[0]===Ir)return!1;return!0},each:function(t){for(var e in this)e[0]===Ir&&t(this[e],e.slice(1),this)}};var Ur=Fr;function zr(){}var Hr=Ur.prototype;function Br(t,e){var n=new zr;if(t instanceof zr)t.each((function(t){n.add(t)}));else if(t){var i=-1,r=t.length;if(null==e)while(++i<r)n.add(t[i]);else while(++i<r)n.add(e(t[i],i,t))}return n}zr.prototype=Br.prototype={constructor:zr,has:Hr.has,add:function(t){return t+="",this[Ir+t]=t,this},remove:Hr.remove,clear:Hr.clear,values:Hr.keys,size:Hr.size,empty:Hr.empty,each:Hr.each};var Vr=Array.prototype;Vr.slice;var Gr=function(t){return function(){return t}};function Wr(t,e,n,i,r,o,a,s,l,c){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=r,this.x=o,this.y=a,this.dx=s,this.dy=l,this._=c}function jr(){return!te.ctrlKey&&!te.button}function qr(){return this.parentNode}function Xr(t){return null==t?{x:te.x,y:te.y}:t}function Yr(){return navigator.maxTouchPoints||"ontouchstart"in this}Wr.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var $r=function(){var t,e,n,i,r=jr,o=qr,a=Xr,s=Yr,l={},c=T("start","drag","end"),u=0,h=0;function d(t){t.on("mousedown.drag",p).filter(s).on("touchstart.drag",g).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(){if(!i&&r.apply(this,arguments)){var a=y("mouse",o.apply(this,arguments),Mn,this,arguments);a&&(ve(te.view).on("mousemove.drag",f,!0).on("mouseup.drag",m,!0),_e(te.view),xe(),n=!1,t=te.clientX,e=te.clientY,a("start"))}}function f(){if(ye(),!n){var i=te.clientX-t,r=te.clientY-e;n=i*i+r*r>h}l.mouse("drag")}function m(){ve(te.view).on("mousemove.drag mouseup.drag",null),be(te.view,n),ye(),l.mouse("end")}function g(){if(r.apply(this,arguments)){var t,e,n=te.changedTouches,i=o.apply(this,arguments),a=n.length;for(t=0;t<a;++t)(e=y(n[t].identifier,i,wn,this,arguments))&&(xe(),e("start"))}}function v(){var t,e,n=te.changedTouches,i=n.length;for(t=0;t<i;++t)(e=l[n[t].identifier])&&(ye(),e("drag"))}function x(){var t,e,n=te.changedTouches,r=n.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),t=0;t<r;++t)(e=l[n[t].identifier])&&(xe(),e("end"))}function y(t,e,n,i,r){var o,s,h,p=n(e,t),f=c.copy();if(le(new Wr(d,"beforestart",o,t,u,p[0],p[1],0,0,f),(function(){return null!=(te.subject=o=a.apply(i,r))&&(s=o.x-p[0]||0,h=o.y-p[1]||0,!0)})))return function a(c){var m,g=p;switch(c){case"start":l[t]=a,m=u++;break;case"end":delete l[t],--u;case"drag":p=n(e,t),m=u;break}le(new Wr(d,c,o,t,m,p[0]+s,p[1]+h,p[0]-g[0],p[1]-g[1],f),f.apply,f,[c,i,r])}}return d.filter=function(t){return arguments.length?(r="function"===typeof t?t:Gr(!!t),d):r},d.container=function(t){return arguments.length?(o="function"===typeof t?t:Gr(t),d):o},d.subject=function(t){return arguments.length?(a="function"===typeof t?t:Gr(t),d):a},d.touchable=function(t){return arguments.length?(s="function"===typeof t?t:Gr(!!t),d):s},d.on=function(){var t=c.on.apply(c,arguments);return t===c?d:t},d.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,d):Math.sqrt(h)},d},Zr=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return Jr(this.cover(e,n),e,n,t)};function Jr(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,o,a,s,l,c,u,h,d,p=t._root,f={data:i},m=t._x0,g=t._y0,v=t._x1,x=t._y1;if(!p)return t._root=f,t;while(p.length)if((c=e>=(o=(m+v)/2))?m=o:v=o,(u=n>=(a=(g+x)/2))?g=a:x=a,r=p,!(p=p[h=u<<1|c]))return r[h]=f,t;if(s=+t._x.call(null,p.data),l=+t._y.call(null,p.data),e===s&&n===l)return f.next=p,r?r[h]=f:t._root=f,t;do{r=r?r[h]=new Array(4):t._root=new Array(4),(c=e>=(o=(m+v)/2))?m=o:v=o,(u=n>=(a=(g+x)/2))?g=a:x=a}while((h=u<<1|c)===(d=(l>=a)<<1|s>=o));return r[d]=p,r[h]=f,t}function Kr(t){var e,n,i,r,o=t.length,a=new Array(o),s=new Array(o),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(a[n]=i,s[n]=r,i<l&&(l=i),i>u&&(u=i),r<c&&(c=r),r>h&&(h=r));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<o;++n)Jr(this,a[n],s[n],t[n]);return this}var Qr=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,o=(i=Math.floor(e))+1;else{var a,s,l=r-n,c=this._root;while(n>t||t>=r||i>e||e>=o)switch(s=(e<i)<<1|t<n,a=new Array(4),a[s]=c,c=a,l*=2,s){case 0:r=n+l,o=i+l;break;case 1:n=r-l,o=i+l;break;case 2:r=n+l,i=o-l;break;case 3:n=r-l,i=o-l;break}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this},to=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},eo=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},no=function(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r},io=function(t,e,n){var i,r,o,a,s,l,c,u=this._x0,h=this._y0,d=this._x1,p=this._y1,f=[],m=this._root;m&&f.push(new no(m,u,h,d,p)),null==n?n=1/0:(u=t-n,h=e-n,d=t+n,p=e+n,n*=n);while(l=f.pop())if(!(!(m=l.node)||(r=l.x0)>d||(o=l.y0)>p||(a=l.x1)<u||(s=l.y1)<h))if(m.length){var g=(r+a)/2,v=(o+s)/2;f.push(new no(m[3],g,v,a,s),new no(m[2],r,v,g,s),new no(m[1],g,o,a,v),new no(m[0],r,o,g,v)),(c=(e>=v)<<1|t>=g)&&(l=f[f.length-1],f[f.length-1]=f[f.length-1-c],f[f.length-1-c]=l)}else{var x=t-+this._x.call(null,m.data),y=e-+this._y.call(null,m.data),_=x*x+y*y;if(_<n){var b=Math.sqrt(n=_);u=t-b,h=e-b,d=t+b,p=e+b,i=m.data}}return i},ro=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,i,r,o,a,s,l,c,u,h,d,p=this._root,f=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!p)return this;if(p.length)while(1){if((c=o>=(s=(f+g)/2))?f=s:g=s,(u=a>=(l=(m+v)/2))?m=l:v=l,e=p,!(p=p[h=u<<1|c]))return this;if(!p.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}while(p.data!==t)if(i=p,!(p=p.next))return this;return(r=p.next)&&delete p.next,i?(r?i.next=r:delete i.next,this):e?(r?e[h]=r:delete e[h],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[d]=p:this._root=p),this):(this._root=r,this)};function oo(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}var ao=function(){return this._root},so=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},lo=function(t){var e,n,i,r,o,a,s=[],l=this._root;l&&s.push(new no(l,this._x0,this._y0,this._x1,this._y1));while(e=s.pop())if(!t(l=e.node,i=e.x0,r=e.y0,o=e.x1,a=e.y1)&&l.length){var c=(i+o)/2,u=(r+a)/2;(n=l[3])&&s.push(new no(n,c,u,o,a)),(n=l[2])&&s.push(new no(n,i,u,c,a)),(n=l[1])&&s.push(new no(n,c,r,o,u)),(n=l[0])&&s.push(new no(n,i,r,c,u))}return this},co=function(t){var e,n=[],i=[];this._root&&n.push(new no(this._root,this._x0,this._y0,this._x1,this._y1));while(e=n.pop()){var r=e.node;if(r.length){var o,a=e.x0,s=e.y0,l=e.x1,c=e.y1,u=(a+l)/2,h=(s+c)/2;(o=r[0])&&n.push(new no(o,a,s,u,h)),(o=r[1])&&n.push(new no(o,u,s,l,h)),(o=r[2])&&n.push(new no(o,a,h,u,c)),(o=r[3])&&n.push(new no(o,u,h,l,c))}i.push(e)}while(e=i.pop())t(e.node,e.x0,e.y0,e.x1,e.y1);return this};function uo(t){return t[0]}var ho=function(t){return arguments.length?(this._x=t,this):this._x};function po(t){return t[1]}var fo=function(t){return arguments.length?(this._y=t,this):this._y};function mo(t,e,n){var i=new go(null==e?uo:e,null==n?po:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function go(t,e,n,i,r,o){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function vo(t){var e={data:t.data},n=e;while(t=t.next)n=n.next={data:t.data};return e}var xo=mo.prototype=go.prototype;xo.copy=function(){var t,e,n=new go(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=vo(i),n;t=[{source:i,target:n._root=new Array(4)}];while(i=t.pop())for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=vo(e));return n},xo.add=Zr,xo.addAll=Kr,xo.cover=Qr,xo.data=to,xo.extent=eo,xo.find=io,xo.remove=ro,xo.removeAll=oo,xo.root=ao,xo.size=so,xo.visit=lo,xo.visitAfter=co,xo.x=ho,xo.y=fo;Math.PI,Math.sqrt(5);var yo=function(){return Math.random()},_o=(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(yo),function t(e){function n(t,n){var i,r;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=i)o=i,i=null;else do{i=2*e()-1,o=2*e()-1,r=i*i+o*o}while(!r||r>1);return t+n*o*Math.sqrt(-2*Math.log(r)/r)}}return n.source=t,n}(yo)),bo=(function t(e){function n(){var t=_o.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(yo),function t(e){function n(t){return function(){for(var n=0,i=0;i<t;++i)n+=e();return n}}return n.source=t,n}(yo));(function t(e){function n(t){var n=bo.source(e)(t);return function(){return n()/t}}return n.source=t,n})(yo),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(yo);var wo=Array.prototype;wo.map,wo.slice;var Mo=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function So(t){if(!(e=Mo.exec(t)))throw new Error("invalid format: "+t);var e;return new To({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function To(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}So.prototype=To.prototype,To.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Eo=function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)};function Co(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}var Ao,Lo,Ro=function(t){return t=Co(Math.abs(t)),t?t[1]:NaN},Po=function(t,e){return function(n,i){var r=n.length,o=[],a=0,s=t[0],l=0;while(r>0&&s>0){if(l+s+1>i&&(s=Math.max(1,i-l)),o.push(n.substring(r-=s,r+s)),(l+=s+1)>i)break;s=t[a=(a+1)%t.length]}return o.reverse().join(e)}},No=function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}},Do=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(e+1):t},ko=function(t,e){var n=Co(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(Ao=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Co(t,Math.max(0,e+o-1))[0]},Io=function(t,e){var n=Co(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")},Oo={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Eo,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Io(100*t,e)},r:Io,s:ko,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Fo=function(t){return t},Uo=Array.prototype.map,zo=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],Ho=function(t){var e=void 0===t.grouping||void 0===t.thousands?Fo:Po(Uo.call(t.grouping,Number),t.thousands+""),n=void 0===t.currency?"":t.currency[0]+"",i=void 0===t.currency?"":t.currency[1]+"",r=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?Fo:No(Uo.call(t.numerals,String)),a=void 0===t.percent?"%":t.percent+"",s=void 0===t.minus?"-":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function c(t){t=So(t);var c=t.fill,u=t.align,h=t.sign,d=t.symbol,p=t.zero,f=t.width,m=t.comma,g=t.precision,v=t.trim,x=t.type;"n"===x?(m=!0,x="g"):Oo[x]||(void 0===g&&(g=12),v=!0,x="g"),(p||"0"===c&&"="===u)&&(p=!0,c="0",u="=");var y="$"===d?n:"#"===d&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",_="$"===d?i:/[%p]/.test(x)?a:"",b=Oo[x],w=/[defgprs%]/.test(x);function M(t){var n,i,a,d=y,M=_;if("c"===x)M=b(t)+M,t="";else{t=+t;var S=t<0||1/t<0;if(t=isNaN(t)?l:b(Math.abs(t),g),v&&(t=Do(t)),S&&0===+t&&"+"!==h&&(S=!1),d=(S?"("===h?h:s:"-"===h||"("===h?"":h)+d,M=("s"===x?zo[8+Ao/3]:"")+M+(S&&"("===h?")":""),w){n=-1,i=t.length;while(++n<i)if(a=t.charCodeAt(n),48>a||a>57){M=(46===a?r+t.slice(n+1):t.slice(n))+M,t=t.slice(0,n);break}}}m&&!p&&(t=e(t,1/0));var T=d.length+t.length+M.length,E=T<f?new Array(f-T+1).join(c):"";switch(m&&p&&(t=e(E+t,E.length?f-M.length:1/0),E=""),u){case"<":t=d+t+M+E;break;case"=":t=d+E+t+M;break;case"^":t=E.slice(0,T=E.length>>1)+d+t+M+E.slice(T);break;default:t=E+d+t+M;break}return o(t)}return g=void 0===g?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),M.toString=function(){return t+""},M}function u(t,e){var n=c((t=So(t),t.type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Ro(e)/3))),r=Math.pow(10,-i),o=zo[8+i/3];return function(t){return n(r*t)+o}}return{format:c,formatPrefix:u}};function Bo(t){return Lo=Ho(t),Lo.format,Lo.formatPrefix,Lo}Bo({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var Vo=new Date,Go=new Date;function Wo(t,e,n,i){function r(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return r.floor=function(e){return t(e=new Date(+e)),e},r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,o){var a,s=[];if(n=r.ceil(n),o=null==o?1:Math.floor(o),!(n<i)||!(o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<i);return s},r.filter=function(n){return Wo((function(e){if(e>=e)while(t(e),!n(e))e.setTime(e-1)}),(function(t,i){if(t>=t)if(i<0)while(++i<=0)while(e(t,-1),!n(t));else while(--i>=0)while(e(t,1),!n(t));}))},n&&(r.count=function(e,i){return Vo.setTime(+e),Go.setTime(+i),t(Vo),t(Go),Math.floor(n(Vo,Go))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t===0}:function(e){return r.count(0,e)%t===0}):r:null}),r}var jo=Wo((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));jo.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Wo((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var qo=jo,Xo=(jo.range,Wo((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}))),Yo=(Xo.range,1e3),$o=6e4,Zo=36e5,Jo=864e5,Ko=6048e5;function Qo(t){return Wo((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*$o)/Ko}))}var ta=Qo(0),ea=Qo(1),na=Qo(2),ia=Qo(3),ra=Qo(4),oa=Qo(5),aa=Qo(6),sa=(ta.range,ea.range,na.range,ia.range,ra.range,oa.range,aa.range,Wo((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*$o)/Jo}),(function(t){return t.getDate()-1}))),la=sa,ca=(sa.range,Wo((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Yo-t.getMinutes()*$o)}),(function(t,e){t.setTime(+t+e*Zo)}),(function(t,e){return(e-t)/Zo}),(function(t){return t.getHours()}))),ua=(ca.range,Wo((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Yo)}),(function(t,e){t.setTime(+t+e*$o)}),(function(t,e){return(e-t)/$o}),(function(t){return t.getMinutes()}))),ha=(ua.range,Wo((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*Yo)}),(function(t,e){return(e-t)/Yo}),(function(t){return t.getUTCSeconds()}))),da=(ha.range,Wo((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));da.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Wo((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):da:null};da.range;function pa(t){return Wo((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/Ko}))}var fa=pa(0),ma=pa(1),ga=pa(2),va=pa(3),xa=pa(4),ya=pa(5),_a=pa(6),ba=(fa.range,ma.range,ga.range,va.range,xa.range,ya.range,_a.range,Wo((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/Jo}),(function(t){return t.getUTCDate()-1}))),wa=ba,Ma=(ba.range,Wo((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));Ma.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Wo((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Sa=Ma;Ma.range;function Ta(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Ea(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ca(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Aa(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,o=t.days,a=t.shortDays,s=t.months,l=t.shortMonths,c=Oa(r),u=Fa(r),h=Oa(o),d=Fa(o),p=Oa(a),f=Fa(a),m=Oa(s),g=Fa(s),v=Oa(l),x=Fa(l),y={a:D,A:k,b:I,B:O,c:null,d:rs,e:rs,f:cs,g:_s,G:ws,H:os,I:as,j:ss,L:ls,m:us,M:hs,p:F,q:U,Q:js,s:qs,S:ds,u:ps,U:fs,V:gs,w:vs,W:xs,x:null,X:null,y:ys,Y:bs,Z:Ms,"%":Ws},_={a:z,A:H,b:B,B:V,c:null,d:Ss,e:Ss,f:Ls,g:Hs,G:Vs,H:Ts,I:Es,j:Cs,L:As,m:Rs,M:Ps,p:G,q:W,Q:js,s:qs,S:Ns,u:Ds,U:ks,V:Os,w:Fs,W:Us,x:null,X:null,y:zs,Y:Bs,Z:Gs,"%":Ws},b={a:E,A:C,b:A,B:L,c:R,d:Ya,e:Ya,f:ts,g:Wa,G:Ga,H:Za,I:Za,j:$a,L:Qa,m:Xa,M:Ja,p:T,q:qa,Q:ns,s:is,S:Ka,u:za,U:Ha,V:Ba,w:Ua,W:Va,x:P,X:N,y:Wa,Y:Ga,Z:ja,"%":es};function w(t,e){return function(n){var i,r,o,a=[],s=-1,l=0,c=t.length;n instanceof Date||(n=new Date(+n));while(++s<c)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(r=Ra[i=t.charAt(++s)])?i=t.charAt(++s):r="e"===i?" ":"0",(o=e[i])&&(i=o(n,r)),a.push(i),l=s+1);return a.push(t.slice(l,s)),a.join("")}}function M(t,e){return function(n){var i,r,o=Ca(1900,void 0,1),a=S(o,t,n+="",0);if(a!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=Ea(Ca(o.y,0,1)),r=i.getUTCDay(),i=r>4||0===r?ma.ceil(i):ma(i),i=wa.offset(i,7*(o.V-1)),o.y=i.getUTCFullYear(),o.m=i.getUTCMonth(),o.d=i.getUTCDate()+(o.w+6)%7):(i=Ta(Ca(o.y,0,1)),r=i.getDay(),i=r>4||0===r?ea.ceil(i):ea(i),i=la.offset(i,7*(o.V-1)),o.y=i.getFullYear(),o.m=i.getMonth(),o.d=i.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),r="Z"in o?Ea(Ca(o.y,0,1)).getUTCDay():Ta(Ca(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(r+5)%7:o.w+7*o.U-(r+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Ea(o)):Ta(o)}}function S(t,e,n,i){var r,o,a=0,s=e.length,l=n.length;while(a<s){if(i>=l)return-1;if(r=e.charCodeAt(a++),37===r){if(r=e.charAt(a++),o=b[r in Ra?e.charAt(a++):r],!o||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function T(t,e,n){var i=c.exec(e.slice(n));return i?(t.p=u[i[0].toLowerCase()],n+i[0].length):-1}function E(t,e,n){var i=p.exec(e.slice(n));return i?(t.w=f[i[0].toLowerCase()],n+i[0].length):-1}function C(t,e,n){var i=h.exec(e.slice(n));return i?(t.w=d[i[0].toLowerCase()],n+i[0].length):-1}function A(t,e,n){var i=v.exec(e.slice(n));return i?(t.m=x[i[0].toLowerCase()],n+i[0].length):-1}function L(t,e,n){var i=m.exec(e.slice(n));return i?(t.m=g[i[0].toLowerCase()],n+i[0].length):-1}function R(t,n,i){return S(t,e,n,i)}function P(t,e,i){return S(t,n,e,i)}function N(t,e,n){return S(t,i,e,n)}function D(t){return a[t.getDay()]}function k(t){return o[t.getDay()]}function I(t){return l[t.getMonth()]}function O(t){return s[t.getMonth()]}function F(t){return r[+(t.getHours()>=12)]}function U(t){return 1+~~(t.getMonth()/3)}function z(t){return a[t.getUTCDay()]}function H(t){return o[t.getUTCDay()]}function B(t){return l[t.getUTCMonth()]}function V(t){return s[t.getUTCMonth()]}function G(t){return r[+(t.getUTCHours()>=12)]}function W(t){return 1+~~(t.getUTCMonth()/3)}return y.x=w(n,y),y.X=w(i,y),y.c=w(e,y),_.x=w(n,_),_.X=w(i,_),_.c=w(e,_),{format:function(t){var e=w(t+="",y);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",_);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t+="",!0);return e.toString=function(){return t},e}}}var La,Ra={"-":"",_:" ",0:"0"},Pa=/^\s*\d+/,Na=/^%/,Da=/[\\^$*+?|[\]().{}]/g;function ka(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}function Ia(t){return t.replace(Da,"\\$&")}function Oa(t){return new RegExp("^(?:"+t.map(Ia).join("|")+")","i")}function Fa(t){var e={},n=-1,i=t.length;while(++n<i)e[t[n].toLowerCase()]=n;return e}function Ua(t,e,n){var i=Pa.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function za(t,e,n){var i=Pa.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function Ha(t,e,n){var i=Pa.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function Ba(t,e,n){var i=Pa.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function Va(t,e,n){var i=Pa.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function Ga(t,e,n){var i=Pa.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Wa(t,e,n){var i=Pa.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function ja(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function qa(t,e,n){var i=Pa.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function Xa(t,e,n){var i=Pa.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Ya(t,e,n){var i=Pa.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function $a(t,e,n){var i=Pa.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function Za(t,e,n){var i=Pa.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Ja(t,e,n){var i=Pa.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Ka(t,e,n){var i=Pa.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function Qa(t,e,n){var i=Pa.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function ts(t,e,n){var i=Pa.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function es(t,e,n){var i=Na.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function ns(t,e,n){var i=Pa.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function is(t,e,n){var i=Pa.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function rs(t,e){return ka(t.getDate(),e,2)}function os(t,e){return ka(t.getHours(),e,2)}function as(t,e){return ka(t.getHours()%12||12,e,2)}function ss(t,e){return ka(1+la.count(qo(t),t),e,3)}function ls(t,e){return ka(t.getMilliseconds(),e,3)}function cs(t,e){return ls(t,e)+"000"}function us(t,e){return ka(t.getMonth()+1,e,2)}function hs(t,e){return ka(t.getMinutes(),e,2)}function ds(t,e){return ka(t.getSeconds(),e,2)}function ps(t){var e=t.getDay();return 0===e?7:e}function fs(t,e){return ka(ta.count(qo(t)-1,t),e,2)}function ms(t){var e=t.getDay();return e>=4||0===e?ra(t):ra.ceil(t)}function gs(t,e){return t=ms(t),ka(ra.count(qo(t),t)+(4===qo(t).getDay()),e,2)}function vs(t){return t.getDay()}function xs(t,e){return ka(ea.count(qo(t)-1,t),e,2)}function ys(t,e){return ka(t.getFullYear()%100,e,2)}function _s(t,e){return t=ms(t),ka(t.getFullYear()%100,e,2)}function bs(t,e){return ka(t.getFullYear()%1e4,e,4)}function ws(t,e){var n=t.getDay();return t=n>=4||0===n?ra(t):ra.ceil(t),ka(t.getFullYear()%1e4,e,4)}function Ms(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ka(e/60|0,"0",2)+ka(e%60,"0",2)}function Ss(t,e){return ka(t.getUTCDate(),e,2)}function Ts(t,e){return ka(t.getUTCHours(),e,2)}function Es(t,e){return ka(t.getUTCHours()%12||12,e,2)}function Cs(t,e){return ka(1+wa.count(Sa(t),t),e,3)}function As(t,e){return ka(t.getUTCMilliseconds(),e,3)}function Ls(t,e){return As(t,e)+"000"}function Rs(t,e){return ka(t.getUTCMonth()+1,e,2)}function Ps(t,e){return ka(t.getUTCMinutes(),e,2)}function Ns(t,e){return ka(t.getUTCSeconds(),e,2)}function Ds(t){var e=t.getUTCDay();return 0===e?7:e}function ks(t,e){return ka(fa.count(Sa(t)-1,t),e,2)}function Is(t){var e=t.getUTCDay();return e>=4||0===e?xa(t):xa.ceil(t)}function Os(t,e){return t=Is(t),ka(xa.count(Sa(t),t)+(4===Sa(t).getUTCDay()),e,2)}function Fs(t){return t.getUTCDay()}function Us(t,e){return ka(ma.count(Sa(t)-1,t),e,2)}function zs(t,e){return ka(t.getUTCFullYear()%100,e,2)}function Hs(t,e){return t=Is(t),ka(t.getUTCFullYear()%100,e,2)}function Bs(t,e){return ka(t.getUTCFullYear()%1e4,e,4)}function Vs(t,e){var n=t.getUTCDay();return t=n>=4||0===n?xa(t):xa.ceil(t),ka(t.getUTCFullYear()%1e4,e,4)}function Gs(){return"+0000"}function Ws(){return"%"}function js(t){return+t}function qs(t){return Math.floor(+t/1e3)}function Xs(t){return La=Aa(t),La.format,La.parse,La.utcFormat,La.utcParse,La}Xs({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Ys=Wo((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),$s=(Ys.range,Wo((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*Zo)}),(function(t,e){return(e-t)/Zo}),(function(t){return t.getUTCHours()}))),Zs=($s.range,Wo((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*$o)}),(function(t,e){return(e-t)/$o}),(function(t){return t.getUTCMinutes()})));Zs.range;var Js=function(t){return"string"===typeof t?new fe([document.querySelectorAll(t)],[document.documentElement]):new fe([null==t?[]:t],pe)},Ks=function(t){return function(){return t}};function Qs(t){this._context=t}Qs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};var tl=function(t){return new Qs(t)};function el(t){return t[0]}function nl(t){return t[1]}var il=function(){var t=el,e=nl,n=Ks(!0),i=null,r=tl,o=null;function a(a){var s,l,c,u=a.length,h=!1;for(null==i&&(o=r(c=kr())),s=0;s<=u;++s)!(s<u&&n(l=a[s],s,a))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(l,s,a),+e(l,s,a));if(c)return o=null,c+""||null}return a.x=function(e){return arguments.length?(t="function"===typeof e?e:Ks(+e),a):t},a.y=function(t){return arguments.length?(e="function"===typeof t?t:Ks(+t),a):e},a.defined=function(t){return arguments.length?(n="function"===typeof t?t:Ks(!!t),a):n},a.curve=function(t){return arguments.length?(r=t,null!=i&&(o=r(i)),a):r},a.context=function(t){return arguments.length?(null==t?i=o=null:o=r(i=t),a):i},a};function rl(){this._=null}function ol(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function al(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function sl(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function ll(t){while(t.L)t=t.L;return t}rl.prototype={constructor:rl,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){t=t.R;while(t.L)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=ll(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);e.L=e.R=null,e.U=n,e.C=!0,t=e;while(n&&n.C)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(al(this,n),t=n,n=t.U),n.C=!1,i.C=!0,sl(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(sl(this,n),t=n,n=t.U),n.C=!1,i.C=!0,al(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,a=t.R;if(n=o?a?ll(a):o:a,r?r.L===t?r.L=n:r.R=n:this._=n,o&&a?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=a,a.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,al(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,sl(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,al(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,sl(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,al(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,sl(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var cl=rl;function ul(t,e,n,i){var r=[null,null],o=Ul.push(r)-1;return r.left=t,r.right=e,n&&dl(r,t,e,n),i&&dl(r,e,t,i),Ol[t.index].halfedges.push(o),Ol[e.index].halfedges.push(o),r}function hl(t,e,n){var i=[e,n];return i.left=t,i}function dl(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function pl(t,e,n,i,r){var o,a=t[0],s=t[1],l=a[0],c=a[1],u=s[0],h=s[1],d=0,p=1,f=u-l,m=h-c;if(o=e-l,f||!(o>0)){if(o/=f,f<0){if(o<d)return;o<p&&(p=o)}else if(f>0){if(o>p)return;o>d&&(d=o)}if(o=i-l,f||!(o<0)){if(o/=f,f<0){if(o>p)return;o>d&&(d=o)}else if(f>0){if(o<d)return;o<p&&(p=o)}if(o=n-c,m||!(o>0)){if(o/=m,m<0){if(o<d)return;o<p&&(p=o)}else if(m>0){if(o>p)return;o>d&&(d=o)}if(o=r-c,m||!(o<0)){if(o/=m,m<0){if(o>p)return;o>d&&(d=o)}else if(m>0){if(o<d)return;o<p&&(p=o)}return!(d>0||p<1)||(d>0&&(t[0]=[l+d*f,c+d*m]),p<1&&(t[1]=[l+p*f,c+p*m]),!0)}}}}}function fl(t,e,n,i,r){var o=t[1];if(o)return!0;var a,s,l=t[0],c=t.left,u=t.right,h=c[0],d=c[1],p=u[0],f=u[1],m=(h+p)/2,g=(d+f)/2;if(f===d){if(m<e||m>=i)return;if(h>p){if(l){if(l[1]>=r)return}else l=[m,n];o=[m,r]}else{if(l){if(l[1]<n)return}else l=[m,r];o=[m,n]}}else if(a=(h-p)/(f-d),s=g-a*m,a<-1||a>1)if(h>p){if(l){if(l[1]>=r)return}else l=[(n-s)/a,n];o=[(r-s)/a,r]}else{if(l){if(l[1]<n)return}else l=[(r-s)/a,r];o=[(n-s)/a,n]}else if(d<f){if(l){if(l[0]>=i)return}else l=[e,a*e+s];o=[i,a*i+s]}else{if(l){if(l[0]<e)return}else l=[i,a*i+s];o=[e,a*e+s]}return t[0]=l,t[1]=o,!0}function ml(t,e,n,i){var r,o=Ul.length;while(o--)fl(r=Ul[o],t,e,n,i)&&pl(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>zl||Math.abs(r[0][1]-r[1][1])>zl)||delete Ul[o]}function gl(t){return Ol[t.index]={site:t,halfedges:[]}}function vl(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function xl(t,e){return e[+(e.left!==t.site)]}function yl(t,e){return e[+(e.left===t.site)]}function _l(){for(var t,e,n,i,r=0,o=Ol.length;r<o;++r)if((t=Ol[r])&&(i=(e=t.halfedges).length)){var a=new Array(i),s=new Array(i);for(n=0;n<i;++n)a[n]=n,s[n]=vl(t,Ul[e[n]]);for(a.sort((function(t,e){return s[e]-s[t]})),n=0;n<i;++n)s[n]=e[a[n]];for(n=0;n<i;++n)e[n]=s[n]}}function bl(t,e,n,i){var r,o,a,s,l,c,u,h,d,p,f,m,g=Ol.length,v=!0;for(r=0;r<g;++r)if(o=Ol[r]){a=o.site,l=o.halfedges,s=l.length;while(s--)Ul[l[s]]||l.splice(s,1);s=0,c=l.length;while(s<c)p=yl(o,Ul[l[s]]),f=p[0],m=p[1],u=xl(o,Ul[l[++s%c]]),h=u[0],d=u[1],(Math.abs(f-h)>zl||Math.abs(m-d)>zl)&&(l.splice(s,0,Ul.push(hl(a,p,Math.abs(f-t)<zl&&i-m>zl?[t,Math.abs(h-t)<zl?d:i]:Math.abs(m-i)<zl&&n-f>zl?[Math.abs(d-i)<zl?h:n,i]:Math.abs(f-n)<zl&&m-e>zl?[n,Math.abs(h-n)<zl?d:e]:Math.abs(m-e)<zl&&f-t>zl?[Math.abs(d-e)<zl?h:t,e]:null))-1),++c);c&&(v=!1)}if(v){var x,y,_,b=1/0;for(r=0,v=null;r<g;++r)(o=Ol[r])&&(a=o.site,x=a[0]-t,y=a[1]-e,_=x*x+y*y,_<b&&(b=_,v=o));if(v){var w=[t,e],M=[t,i],S=[n,i],T=[n,e];v.halfedges.push(Ul.push(hl(a=v.site,w,M))-1,Ul.push(hl(a,M,S))-1,Ul.push(hl(a,S,T))-1,Ul.push(hl(a,T,w))-1)}}for(r=0;r<g;++r)(o=Ol[r])&&(o.halfedges.length||delete Ol[r])}var wl,Ml=[];function Sl(){ol(this),this.x=this.y=this.arc=this.site=this.cy=null}function Tl(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var a=r[0],s=r[1],l=i[0]-a,c=i[1]-s,u=o[0]-a,h=o[1]-s,d=2*(l*h-c*u);if(!(d>=-Hl)){var p=l*l+c*c,f=u*u+h*h,m=(h*p-c*f)/d,g=(l*f-u*p)/d,v=Ml.pop()||new Sl;v.arc=t,v.site=r,v.x=m+a,v.y=(v.cy=g+s)+Math.sqrt(m*m+g*g),t.circle=v;var x=null,y=Fl._;while(y)if(v.y<y.y||v.y===y.y&&v.x<=y.x){if(!y.L){x=y.P;break}y=y.L}else{if(!y.R){x=y;break}y=y.R}Fl.insert(x,v),x||(wl=v)}}}}function El(t){var e=t.circle;e&&(e.P||(wl=e.N),Fl.remove(e),Ml.push(e),ol(e),t.circle=null)}var Cl=[];function Al(){ol(this),this.edge=this.site=this.circle=null}function Ll(t){var e=Cl.pop()||new Al;return e.site=t,e}function Rl(t){El(t),Il.remove(t),Cl.push(t),ol(t)}function Pl(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,a=t.N,s=[t];Rl(t);var l=o;while(l.circle&&Math.abs(n-l.circle.x)<zl&&Math.abs(i-l.circle.cy)<zl)o=l.P,s.unshift(l),Rl(l),l=o;s.unshift(l),El(l);var c=a;while(c.circle&&Math.abs(n-c.circle.x)<zl&&Math.abs(i-c.circle.cy)<zl)a=c.N,s.push(c),Rl(c),c=a;s.push(c),El(c);var u,h=s.length;for(u=1;u<h;++u)c=s[u],l=s[u-1],dl(c.edge,l.site,c.site,r);l=s[0],c=s[h-1],c.edge=ul(l.site,c.site,null,r),Tl(l),Tl(c)}function Nl(t){var e,n,i,r,o=t[0],a=t[1],s=Il._;while(s)if(i=Dl(s,a)-o,i>zl)s=s.L;else{if(r=o-kl(s,a),!(r>zl)){i>-zl?(e=s.P,n=s):r>-zl?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}gl(t);var l=Ll(t);if(Il.insert(e,l),e||n){if(e===n)return El(e),n=Ll(e.site),Il.insert(l,n),l.edge=n.edge=ul(e.site,l.site),Tl(e),void Tl(n);if(n){El(e),El(n);var c=e.site,u=c[0],h=c[1],d=t[0]-u,p=t[1]-h,f=n.site,m=f[0]-u,g=f[1]-h,v=2*(d*g-p*m),x=d*d+p*p,y=m*m+g*g,_=[(g*x-p*y)/v+u,(d*y-m*x)/v+h];dl(n.edge,c,f,_),l.edge=ul(c,t,null,_),n.edge=ul(t,f,null,_),Tl(e),Tl(n)}else l.edge=ul(e.site,l.site)}}function Dl(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var a=t.P;if(!a)return-1/0;n=a.site;var s=n[0],l=n[1],c=l-e;if(!c)return s;var u=s-i,h=1/o-1/c,d=u/c;return h?(-d+Math.sqrt(d*d-2*h*(u*u/(-2*c)-l+c/2+r-o/2)))/h+i:(i+s)/2}function kl(t,e){var n=t.N;if(n)return Dl(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var Il,Ol,Fl,Ul,zl=1e-6,Hl=1e-12;function Bl(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function Vl(t,e){return e[1]-t[1]||e[0]-t[0]}function Gl(t,e){var n,i,r,o=t.sort(Vl).pop();Ul=[],Ol=new Array(t.length),Il=new cl,Fl=new cl;while(1)if(r=wl,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===n&&o[1]===i||(Nl(o),n=o[0],i=o[1]),o=t.pop();else{if(!r)break;Pl(r.arc)}if(_l(),e){var a=+e[0][0],s=+e[0][1],l=+e[1][0],c=+e[1][1];ml(a,s,l,c),bl(a,s,l,c)}this.edges=Ul,this.cells=Ol,Il=Fl=Ul=Ol=null}Gl.prototype={constructor:Gl,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return xl(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,i){if(o=(r=n.halfedges).length){var r,o,a,s=n.site,l=-1,c=e[r[o-1]],u=c.left===s?c.right:c.left;while(++l<o)a=u,c=e[r[l]],u=c.left===s?c.right:c.left,a&&u&&i<a.index&&i<u.index&&Bl(s,a,u)<0&&t.push([s.data,a.data,u.data])}})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){var i,r,o=this,a=o._found||0,s=o.cells.length;while(!(r=o.cells[a]))if(++a>=s)return null;var l=t-r.site[0],c=e-r.site[1],u=l*l+c*c;do{r=o.cells[i=a],a=null,r.halfedges.forEach((function(n){var i=o.edges[n],s=i.left;if(s!==r.site&&s||(s=i.right)){var l=t-s[0],c=e-s[1],h=l*l+c*c;h<u&&(u=h,a=s.index)}}))}while(null!==a);return o._found=i,null==n||u<=n*n?r.site:null}};Math.SQRT2;function Wl(t,e,n){this.k=t,this.x=e,this.y=n}Wl.prototype={constructor:Wl,scale:function(t){return 1===t?this:new Wl(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Wl(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var jl=new Wl(1,0,0);function ql(t){while(!t.__zoom)if(!(t=t.parentNode))return jl;return t.__zoom}ql.prototype=Wl.prototype;function Xl(t,e,n,i,r,o){var a=(i-e||1)/(n-t||1),s=e-a*t;return Math.abs(a*r-o+s)/Math.sqrt(a*a+1)}function Yl(t,e,n){return n>t&&n<e||n>e&&n<t}function $l(t,e){return Math.abs(e-t)<=3}function Zl(t){var e=t.reduce((function(t,e){return e.x<t?e.x:t}),1/0),n=t.reduce((function(t,e){return e.x>t?e.x:t}),0),i=t.reduce((function(t,e){return e.y<t?e.y:t}),1/0),r=t.reduce((function(t,e){return e.y>t?e.y:t}),0);return{start:{x:e,y:i},end:{x:n,y:r}}}function Jl(t){return t<20?20:t}function Kl(t,e,n,i,r,o,a,s){var l=[e,n],c=[i,r],u=il().x((function(t){return t[0]})).y((function(t){return t[1]})),h=t.append("path").attr("stroke",a).attr("stroke-width",o).attr("fill","none").attr("d",u([l,c]));return s&&h.style("stroke-dasharray",s.join(",")),h}function Ql(t,e,n,i,r,o,a,s,l,c){a||(a=e>i?"right":"left");var u,h=[],d=[e,n],p=[i,r],f=d[0]+(p[0]-d[0])/2,m=d[1]+(p[1]-d[1])/2,g=function(){var t=[f,u[1]],e=[f,S[1]];h.push(t),h.push(e)},v=function(){var t=[u[0],m],e=[S[0],m];h.push(t),h.push(e)},x=function(){h.push([u[0],d[1]-50]),h.push([S[0],d[1]-50])},y=function(){h.push([u[0],d[1]+50]),h.push([S[0],d[1]+50])},_=function(){h.push([d[0]+80,u[1]]),h.push([d[0]+80,S[1]])},b=function(){h.push([d[0]-80,u[1]]),h.push([d[0]-80,S[1]])},w=function(){h.push([u[0],S[1]])},M=function(){h.push([S[0],u[1]])};switch(o){case"left":u=[d[0]-20,d[1]];break;case"top":u=[d[0],d[1]-20];break;case"bottom":u=[d[0],d[1]+20];break;default:u=[d[0]+20,d[1]];break}var S=null;switch(a){case"right":S=[p[0]+20,p[1]];break;case"top":S=[p[0],p[1]-20];break;case"bottom":S=[p[0],p[1]+20];break;default:S=[p[0]-20,p[1]];break}h.push(d),h.push(u),o=o||"right",a=a||"left";var T=ec(e,n,i,r);switch(T.indexOf("r")>-1&&("right"!==o&&"left"!==a||(u[0]>f&&(u[0]=f),S[0]<f&&(S[0]=f))),T.indexOf("d")>-1&&("bottom"!==o&&"top"!==a||(u[1]>m&&(u[1]=m),S[1]<m&&(S[1]=m))),T.indexOf("l")>-1&&("left"!==o&&"right"!==a||(u[0]<f&&(u[0]=f),S[0]>f&&(S[0]=f))),T.indexOf("u")>-1&&("top"!==o&&"bottom"!==a||(u[1]<m&&(u[1]=m),S[1]>m&&(S[1]=m))),T){case"lu":if("right"===o)switch(a){case"top":case"right":w();break;default:v();break}else if("bottom"===o)switch(a){case"top":g();break;default:M();break}else if("top"===o)switch(a){case"top":case"right":w();break;default:v();break}else switch(a){case"top":case"right":g();break;default:M();break}break;case"u":if("right"===o)switch(a){case"right":break;case"top":w();break;default:v();break}else if("bottom"===o)switch(a){case"left":case"right":M();break;default:_();break}else if("top"===o)switch(a){case"left":M();break;case"right":v();break;case"top":_();break;default:break}else switch(a){case"left":case"right":break;default:h.push([u[0],S[1]]);break}break;case"ru":if("right"===o)switch(a){case"left":g();break;case"top":w();break;default:M();break}else if("bottom"===o)switch(a){case"top":g();break;default:M();break}else if("top"===o)switch(a){case"right":g();break;default:w();break}else switch(a){case"left":case"top":w();break;default:v();break}break;case"l":if("right"===o)switch(a){case"left":case"right":case"top":x();break;default:y();break}else if("bottom"===o)switch(a){case"left":y();break;case"right":w();break;case"top":g();break;default:break}else if("top"===o)switch(a){case"left":x();break;case"right":w();break;case"top":break;default:g();break}else switch(a){case"left":x();break;case"right":break;default:w();break}break;case"r":if("right"===o)switch(a){case"left":break;case"right":x();break;default:w();break}else if("bottom"===o)switch(a){case"left":w();break;case"right":y();break;case"top":g();break;default:break}else if("top"===o)switch(a){case"left":M();break;case"right":x();break;case"top":break;default:g();break}else switch(a){case"left":case"right":case"top":x();break;default:y();break}break;case"ld":if("right"===o)switch(a){case"left":v();break;default:w();break}else if("bottom"===o)switch(a){case"left":M();break;case"top":v();break;default:w();break}else if("top"===o)switch(a){case"left":case"right":case"top":M();break;default:g();break}else switch(a){case"left":case"top":M();break;case"right":g();break;default:w();break}break;case"d":if("right"===o)switch(a){case"left":v();break;case"right":M();break;case"top":w();break;default:_();break}else if("bottom"===o)switch(a){case"left":case"right":M();break;case"top":break;default:_();break}else if("top"===o)switch(a){case"left":b();break;default:_();break}else switch(a){case"left":break;case"right":v();break;case"top":w();break;default:b();break}break;case"rd":"right"===o&&"left"===a?g():"right"===o&&"bottom"===a?w():"right"===o&&"top"===a||"right"===o&&"right"===a?M():"bottom"===o&&"left"===a?w():"bottom"===o&&"right"===a?M():"bottom"===o&&"top"===a?v():"bottom"===o&&"bottom"===a?w():"top"===o&&"left"===a||"top"===o&&"right"===a||"top"===o&&"top"===a?M():"top"===o&&"bottom"===a?g():"left"===o&&"left"===a?w():"left"===o&&"right"===a||"left"===o&&"top"===a?v():"left"===o&&"bottom"===a&&w();break}h.push(S),h.push(p);for(var E=[],C=[],A=0;A<h.length;A++){var L=h[A],R=h[A+1];E.push({sourceX:L[0],sourceY:L[1],destinationX:R[0],destinationY:R[1]});var P=A===h.length-2;if(P&&c){var N=tc(t,L[0],L[1],R[0],R[1],s,l);C.push(N);break}var D=Kl(t,L[0],L[1],R[0],R[1],s,l);if(C.push(D),P)break}return{lines:E,paths:C}}function tc(t,e,n,i,r,o,a){var s=Kl(t,e,n,i,r,o,a),l="arrow"+a.replace("#","");return t.append("marker").attr("id",l).attr("markerUnits","strokeWidth").attr("viewBox","0 0 12 12").attr("refX",9).attr("refY",6).attr("markerWidth",12).attr("markerHeight",12).attr("orient","auto").append("path").attr("d","M2,2 L10,6 L2,10 L6,6 L2,2").attr("fill",a),s.attr("marker-end","url(#"+l+")"),s}function ec(t,e,n,i){return n<t&&$l(i,e)?"l":n>t&&$l(i,e)?"r":$l(n,t)&&i<e?"u":$l(n,t)&&i>e?"d":n<t&&i<e?"lu":n>t&&i<e?"ru":n<t&&i>e?"ld":"rd"}n("fb6a");function nc(t,e,n){e.width=e.width||120,e.height=e.height||60;var i=n?"#666666":"#bbbbbb";"start"!==e.type&&"end"!==e.type&&(t.append("rect").attr("x",e.x).attr("y",e.y).attr("stroke",i).attr("class","title").style("height","20px").style("fill","#f1f3f4").style("stroke-width","1px").style("width",e.width+"px"),t.append("text").attr("x",e.x+4).attr("y",e.y+15).attr("class","unselectable").text((function(){return e.name})).each((function(){var t=ve(this),n=t.node().getComputedTextLength(),i=t.text();while(n>e.width-8&&i.length>0)i=i.slice(0,-1),t.text(i+"..."),n=t.node().getComputedTextLength()})));var r=t.append("rect").attr("class","body");r.style("width",e.width+"px").style("fill","white").style("stroke-width","1px"),"start"!==e.type&&"end"!==e.type?(r.attr("x",e.x).attr("y",e.y+20),r.style("height",Jl(e.height-20)+"px")):(r.attr("x",e.x).attr("y",e.y).classed(e.type,!0).attr("rx",30),r.style("height",Jl(e.height)+"px")),r.attr("stroke",i);var o,a="start"===e.type?"Start":"end"===e.type?"End":e.approvers&&0!==e.approvers.length?e.approvers.length>1?"".concat(e.approvers[0].name+"..."):e.approvers[0].name:"No approver";o="start"!==e.type&&"end"!==e.type?e.y+25+Jl(e.height-20)/2:e.y+5+Jl(e.height)/2,t.append("text").attr("x",e.x+e.width/2).attr("y",o).attr("class","unselectable").attr("text-anchor","middle").text((function(){return a})).each((function(){var t=ve(this),n=t.node().getComputedTextLength(),i=t.text();while(n>e.width-8&&i.length>0)i=i.slice(0,-1),t.text(i+"..."),n=t.node().getComputedTextLength()}))}var ic=nc,rc=200,oc=0,ac=Object(d["a"])((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(p["a"])(this,t),this.serial=e.serial,this.id=++oc,this.type=e.type,this.title=e.name||"",this.text=e.description,"undefined"!==typeof e.x?this.x=e.x:this.x=100,"undefined"!==typeof e.y?this.y=e.y:this.y=100,this.pic=e.pic_uuid,e.pic_path&&(this.picName=e.pic_name,this.picSize=e.pic_size,this.picPath="https://".concat("ar-workguide-dev.fiimart.com:3001","/uuid?uuid=").concat(e.pic_path)),this.vid=e.vid_uuid,e.vid_path&&(this.vidName=e.vid_name,this.vidSize=e.vid_size,this.vidPath="https://".concat("ar-workguide-dev.fiimart.com:3001","/uuid?uuid=").concat(e.vid_path)),this.pass_text=e.pass_text,this.fail_text=e.fail_text,this.model=e.model_uuid,this.animationControlList=[{start:0,end:0}],this.animationEnable=!0,e.model_path){this.modelName=e.model_name,this.modelSize=e.model_size,this.modelPath="https://".concat("ar-workguide-dev.fiimart.com:3001","/uuid?uuid=").concat(e.model_path);try{var n=JSON.parse(e.model_desc);this.animationEnable=n.animationEnable,n.animations&&n.animations.length&&(this.animationControlList=n.animations)}catch(i){console.log(i)}}this.modelSnapshot=e.model_snapshot_uuid,e.model_snapshot_path&&(this.modelSnapshotPath="https://".concat("ar-workguide-dev.fiimart.com:3001","/uuid?uuid=").concat(e.model_snapshot_path)),this.isCheck="undefined"!==typeof e.is_check&&Boolean(e.is_check),this.isStepSkippable="undefined"!==typeof e.can_skip&&Boolean(e.can_skip),this.nextStep=e.next_step,this.nextConnection=e.next_connection||"",this.recordCheck="undefined"!==typeof e.is_record&&Boolean(e.is_record),this.isRecordRequired="undefined"!==typeof e.must_record&&Boolean(e.must_record),this.recordType=e.record_type||1,this.recordDesc=e.record_desc,this.error={},this.from=null,this.to=null,this.toStep=function(){var t={serial:this.serial,type:this.type,name:this.title,description:this.text,x:this.x,y:this.y,pic:this.pic,vid:this.vid,model:this.model,pass_text:this.pass_text,fail_text:this.fail_text,model_snapshot:this.modelSnapshot,model_desc:JSON.stringify({animations:this.animationControlList,animationEnable:this.animationEnable}),is_check:this.isCheck?1:0,can_skip:this.isStepSkippable?1:0,next_step:this.to&&this.to.serial,next_connection:this.nextConnection&&this.nextConnection.toString(),is_record:this.recordCheck?1:0,must_record:this.isRecordRequired?1:0,record_type:this.recordType,record_desc:this.recordDesc};return t}})),sc=Object(d["a"])((function t(e,n,i,r){Object(p["a"])(this,t),this.source=e,this.destination=i,this.sourcePosition=n||"right",this.destinationPosition=r||"left",this.id=Date.now(),this.type="pass",this.toString=function(){return this.sourcePosition+","+this.destinationPosition}})),lc={name:"flowchart",props:{steps:{type:Array},readonly:{type:Boolean,default:!1},render:{type:Function,default:ic}},data:function(){return{width:1600,height:1200,originalWidth:1600,originalHeight:1200,internalNodes:[],internalConnections:[],connectingInfo:{source:null,sourcePosition:null},currentNodes:[],currentConnections:[],cursorToChartOffset:{x:0,y:0},lines:[],zoom:1}},methods:{init:function(){var t=this,e=this;e.internalNodes.splice(0,e.internalNodes.length),e.internalConnections.splice(0,e.internalConnections.length);var n,i=Object(o["a"])(this.steps);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.add(r)}}catch(h){i.e(h)}finally{i.f()}var a=this.internalNodes.find((function(t){return 0==t.serial}));a||this.add({id:0,serial:0,x:150,y:130,type:-1,title:this.$t("WF.START")});var s=this.internalNodes.find((function(t){return-1==t.serial}));s||this.add({id:-1,serial:-1,x:730,y:130,type:-1,title:this.$t("WF.END")});var l,c=Object(o["a"])(this.internalNodes);try{var u=function(){var e=l.value;if(e.nextStep){var n=t.internalNodes.find((function(t){return t.serial==e.nextStep}));if(n){var i=e.nextConnection.split(","),r=i[0],o=i[1],a=new sc(e,r||"right",n,o||"left");t.internalConnections.push(a),e.to=n,e.nextConnection=a,n.from=e,t.$emit("connectionChange")}}};for(c.s();!(l=c.n()).done;)u()}catch(h){c.e(h)}finally{c.f()}},add:function(t){if(!this.readonly){t.x||(t.x=this.$el.parentNode.scrollLeft+100),t.y||(t.y=this.$el.parentNode.scrollTop+100),0==t.serial&&(t.name=this.$t("WF.START")),-1==t.serial&&(t.name=this.$t("WF.END"));var e=new ac(t);this.internalNodes.push(e),this.$emit("nodeChange")}},handleChartMouseWheel:function(t){if(t.ctrlKey){if(t.stopPropagation(),t.preventDefault(),t.deltaY>0&&.1===this.zoom)return;this.zoom=Math.round(10*this.zoom-t.deltaY/100)/10}},handleChartMouseUp:function(t){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.handleConnect(e.connectingInfo&&e.connectingInfo.source,e.hoveredConnector&&e.hoveredConnector.node,e.connectingInfo&&e.connectingInfo.sourcePosition,e.hoveredConnector&&e.hoveredConnector.position),2==t.which&&(i=e.$el.parentNode,i.style.cursor="default");case 2:case"end":return n.stop()}}),n)})))()},handleChartMouseMove:function(t){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var i,r,o,a,s,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(2!=t.which){n.next=5;break}return t.preventDefault(),i=e.$el.parentNode,e.clientX&&e.clientY&&(i.scrollBy((e.clientX-t.x)*e.zoom,(e.clientY-t.y)*e.zoom),e.clientX=t.x,e.clientY=t.y,i.style.cursor="move"),n.abrupt("return");case 5:if(r=t.currentTarget.getBoundingClientRect(),o=t.pageX-r.left-window.scrollX,e.cursorToChartOffset.x=Math.trunc(o)/e.zoom,a=t.pageY-r.top-window.scrollY,e.cursorToChartOffset.y=Math.trunc(a)/e.zoom,!e.connectingInfo.source){n.next=17;break}return n.next=13,e.renderConnections();case 13:Js("#svg .connector").classed("active",!0),s=e.getNodeConnectorOffset(e.connectingInfo.source.id,e.connectingInfo.sourcePosition),l=e.hoveredConnector?e.hoveredConnector.position:null,e.arrowTo(s.x,s.y,e.cursorToChartOffset.x,e.cursorToChartOffset.y,e.connectingInfo.sourcePosition,l);case 17:case"end":return n.stop()}}),n)})))()},handleChartMouseDown:function(t){if(1==t.which)return this.currentNodes.splice(0,this.currentNodes.length),void this.currentConnections.splice(0,this.currentConnections.length);2==t.which&&(t.preventDefault(),this.clientX=t.x,this.clientY=t.y)},renderConnections:function(){var t=this;return new Promise((function(e){t.$nextTick((function(){Js("#svg > g.connection").remove(),t.lines=[],t.internalConnections.forEach((function(e){var n=t.getNodeConnectorOffset(e.source.id,e.sourcePosition),i=t.getNodeConnectorOffset(e.destination.id,e.destinationPosition),r={pass:"#449e76",reject:"red"};t.currentConnections.filter((function(t){return t===e})).length>0&&(r={pass:"#12640a",reject:"darkred"});var a,s=t.arrowTo(n.x,n.y,i.x,i.y,e.sourcePosition,e.destinationPosition,r[e.type]),l=Object(o["a"])(s.paths);try{for(l.s();!(a=l.n()).done;){var c=a.value;c.on("mousedown",(function(){te.stopPropagation(),t.currentNodes.splice(0,t.currentNodes.length),t.currentConnections.splice(0,t.currentConnections.length),t.currentConnections.push(e)}))}}catch(p){l.e(p)}finally{l.f()}var u,h=Object(o["a"])(s.lines);try{for(h.s();!(u=h.n()).done;){var d=u.value;t.lines.push({sourceX:d.sourceX,sourceY:d.sourceY,destinationX:d.destinationX,destinationY:d.destinationY,id:e.id})}}catch(p){h.e(p)}finally{h.f()}})),e()}))}))},renderNodes:function(){var t=this;return new Promise((function(e){Js("#svg > g.node").remove(),t.internalNodes.forEach((function(e){t.renderNode(e,t.currentNodes.filter((function(t){return t===e})).length>0)})),e()}))},renderNode:function(t,e){var n=this,i=n.append("g").attr("cursor","move").classed("node",!0);t.render=n.render,t.render(i,t,e);var r=$r().on("start",(function(){n.selectNode(t);var e,i=Object(o["a"])(n.currentNodes);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.tempx=r.x,r.tempy=r.y}}catch(a){i.e(a)}finally{i.f()}})).on("drag",Object(h["a"])(regeneratorRuntime.mark((function t(){var e,i,r,a,s,l,c,u,h,d,p,f,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.readonly){t.next=2;break}return t.abrupt("return");case 2:e=Object(o["a"])(n.currentNodes);try{for(e.s();!(i=e.n()).done;)r=i.value,a=te.dx,r.tempx+=a,s=te.dy,r.tempy+=s,r.x=10*Math.round(Math.round(r.tempx)/10),r.y=10*Math.round(Math.round(r.tempy)/10),n.checkRangeUpdate(r.x,r.y,r.width,r.height),l=n.$el.parentNode,c=l.scrollTop,u=l.scrollLeft,h=l.offsetHeight,d=l.offsetWidth,d/=n.zoom,h/=n.zoom,u/=n.zoom,c/=n.zoom,r.y<c&&n.$el.parentNode.scrollBy(0,-20),r.x<u&&n.$el.parentNode.scrollBy(-20,0),r.y+r.height>c+h&&n.$el.parentNode.scrollBy(0,20),r.x+r.width>u+d&&n.$el.parentNode.scrollBy(20,0)}catch(g){e.e(g)}finally{e.f()}Js("#svg > g.guideline").remove(),p=n.getCurrentNodesEdge(),f=10*Math.round(Math.round(p.start.x)/10),m=10*Math.round(Math.round(p.start.y)/10),n.internalNodes.forEach((function(t){0===n.currentNodes.filter((function(e){return e===t})).length&&(t.x===f&&(t.y<m?n.guideLineTo(t.x,t.y+t.height,f,m):n.guideLineTo(f,m+t.height,t.x,t.y)),t.y===m&&(t.x<f?n.guideLineTo(t.x+t.width,t.y,f,m):n.guideLineTo(f+t.width,m,t.x,t.y)))}));case 9:case"end":return t.stop()}}),t)})))).on("end",(function(){Js("#svg > g.guideline").remove();var t,e=0,i=0,r=n.width,a=n.height,s=Object(o["a"])(n.internalNodes);try{for(s.s();!(t=s.n()).done;){var l=t.value;e=Math.max(l.x,e),i=Math.max(l.y,i),r=Math.min(l.x,r),a=Math.min(l.y,a)}}catch(g){s.e(g)}finally{s.f()}var c=e-r,u=i-a,h=Math.ceil(c/rc)*rc,d=Math.ceil(u/rc)*rc;n.$el.parentNode.scrollBy(-r+rc,-a+rc);var p,f=Object(o["a"])(n.internalNodes);try{for(f.s();!(p=f.n()).done;){var m=p.value;n.moveNode(m,-r+rc,-a+rc)}}catch(g){f.e(g)}finally{f.f()}n.originalWidth=h+2*rc,n.originalHeight=d+2*rc,n.width=Math.max(n.originalWidth*n.zoom,n.$el.parentNode.offsetWidth),n.height=Math.max(n.originalHeight*n.zoom,n.$el.parentNode.offsetHeight)}));i.call(r),i.on("mousedown",(function(){}));var a=[],s=this.getConnectorPosition(t),l=function(e){var r=s[e],o=i.append("circle").attr("cx",r.x).attr("cy",r.y).attr("r",8).attr("class","connector");o.on("mousedown",(function(){te.stopPropagation(),n.readonly||t.to||-1===t.serial||(n.connectingInfo.source=t,n.connectingInfo.sourcePosition=e)})).on("mouseup",(function(){te.stopPropagation(),n.handleConnect(n.connectingInfo&&n.connectingInfo.source,t,n.connectingInfo&&n.connectingInfo.sourcePosition,e)})).on("mouseover",(function(){o.classed("active",!0)})).on("mouseout",(function(){o.classed("active",!1)})),a.push(o)};for(var c in s)l(c);i.on("mouseover",(function(){a.forEach((function(t){return t.classed("active",!0)}))})).on("mouseout",(function(){a.forEach((function(t){return t.classed("active",!1)}))}))},append:function(t){var e=ve("#svg");return e.insert(t,".selection")},guideLineTo:function(t,e,n,i){var r=this.append("g");r.classed("guideline",!0),Kl(r,t,e,n,i,1,"#a3a3a3",[5,3])},arrowTo:function(t,e,n,i,r,o,a){var s=this.append("g");return s.classed("connection",!0),Ql(s,t,e,n,i,r,o,2,a||"#a3a3a3",!0),Ql(s,t,e,n,i,r,o,5,"transparent",!1)},checkRangeUpdate:function(t,e,n,i){var r=this.$el,a=rc,s=rc;if(t<0){this.width+=a/this.zoom,r.parentNode.scrollBy(a,0);var l,c=Object(o["a"])(this.internalNodes);try{for(c.s();!(l=c.n()).done;){var u=l.value;this.moveNode(u,a,0)}}catch(f){c.e(f)}finally{c.f()}}else t+n>this.width?this.width+=a/this.zoom:a=0;if(e<0){this.height+=s/this.zoom,r.parentNode.scrollBy(0,s);var h,d=Object(o["a"])(this.internalNodes);try{for(d.s();!(h=d.n()).done;){var p=h.value;this.moveNode(p,0,s)}}catch(f){d.e(f)}finally{d.f()}}else e+i>this.height?this.height+=s/this.zoom:s=0},selectNode:function(t){var e=0===this.currentNodes.filter((function(e){return e===t})).length;e&&(this.currentConnections.splice(0,this.currentConnections.length),this.currentNodes.splice(0,this.currentNodes.length),this.currentNodes.push(t))},remove:function(){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function e(){var n,i,r,a,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.readonly){e.next=2;break}return e.abrupt("return");case 2:if(t.currentConnections.length>0){n=Object(o["a"])(t.currentConnections);try{for(n.s();!(i=n.n()).done;)r=i.value,t.removeConnection(r)}catch(c){n.e(c)}finally{n.f()}t.currentConnections.splice(0,t.currentConnections.length)}if(t.currentNodes.length>0){a=Object(o["a"])(t.currentNodes);try{for(a.s();!(s=a.n()).done;)l=s.value,t.removeNode(l)}catch(c){a.e(c)}finally{a.f()}t.currentNodes.splice(0,t.currentNodes.length)}case 4:case"end":return e.stop()}}),e)})))()},removeNode:function(t){var e,n=this.internalConnections.filter((function(e){return e.source.id===t.id||e.destination.id===t.id})),i=Object(o["a"])(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.removeConnection(r)}}catch(a){i.e(a)}finally{i.f()}this.internalNodes.splice(this.internalNodes.indexOf(t),1),this.$emit("nodeChange")},removeConnection:function(t){t.source.nextConnection=null,t.source.to=null,t.destination.from=null;var e=this.internalConnections.indexOf(t);this.internalConnections.splice(e,1),this.serializeNodes(),this.$emit("connectionChange")},moveCurrentNode:function(t,e){if(this.currentNodes.length>0&&!this.readonly){var n,i=Object(o["a"])(this.currentNodes);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.moveNode(r,t,e)}}catch(a){i.e(a)}finally{i.f()}}},moveNode:function(t,e,n){t.x+e<0&&(e=-t.x),t.x+=e,t.y+n<0&&(n=-t.y),t.y+=n},handleConnect:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"right",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"left";if(t&&e&&t.id!==e.id&&!t.to&&!e.from&&-1!==t.serial&&0!==e.serial&&(0!==t.serial||-1!==e.serial)){var r=new sc(t,n,e,i);this.internalConnections.push(r),t.to=e,e.from=t,t.nextConnection=r,this.serializeNodes(),this.$emit("connectionChange")}this.connectingInfo.source=null,this.connectingInfo.sourcePosition=null},checkConnection:function(){var t=this.internalNodes.find((function(t){return 0===t.serial}));while(t.to)t=t.to;return-1===t.serial},serializeNodes:function(){var t,e=this.internalNodes.find((function(t){return 0===t.serial})),n=Object(o["a"])(this.internalNodes);try{for(n.s();!(t=n.n()).done;){var i=t.value;-1!==i.type&&(i.serial=null)}}catch(a){n.e(a)}finally{n.f()}var r=0;while(e.to){if(e=e.to,-1===e.type){e.serial=-1;break}e.serial=++r}},getConnectorPosition:function(t){var e=t.width/2,n=t.height/2,i={x:t.x+e,y:t.y},r={x:t.x,y:-1==t.type?t.y+n-10:t.y+n+10},o={x:t.x+e,y:-1==t.type?t.y+t.height-25:t.y+t.height+20},a={x:t.x+t.width,y:-1==t.type?t.y+n-10:t.y+n+10};return{left:r,right:a,top:i,bottom:o}},getNodeConnectorOffset:function(t,e){var n=this.internalNodes.filter((function(e){return e.id===t}))[0];return this.getConnectorPosition(n)[e]},getCurrentNodesEdge:function(){var t=this.currentNodes.map((function(t){return{x:t.x,y:t.y}}));return t.push.apply(t,Object(a["a"])(this.currentNodes.map((function(t){return{x:t.x+t.width,y:t.y+t.height}})))),Zl(t)}},mounted:function(){var t=this;document.onkeydown=function(e){var n=e.target.tagName.toLowerCase();if("input"!==n&&"textarea"!==n)switch(e.keyCode){case 8:if(e.ctrlKey){if(t.currentNodes.length>0&&t.currentNodes[0].id<=0)return;if(t.currentConnections.length>0&&t.currentConnections[0].id<=0)return;t.remove()}break;case 27:t.currentNodes.splice(0,t.currentNodes.length),t.currentConnections.splice(0,t.currentConnections.length);break;case 37:break;case 38:break;case 39:break;case 40:break;case 46:if(t.currentNodes.length>0&&-1==t.currentNodes[0].type)return;if(t.currentConnections.length>0&&-1==t.currentConnections[0].type)return;t.remove();break;case 48:e.ctrlKey&&(e.preventDefault(),t.zoom=1);break;case 109:case 189:e.ctrlKey&&(e.preventDefault(),t.zoom=Math.round(10*t.zoom-1)/10);break;case 107:case 187:e.ctrlKey&&(e.preventDefault(),t.zoom=Math.round(10*t.zoom+1)/10);break;default:break}}},computed:{hoveredConnector:function(){var t,e=Object(o["a"])(this.internalNodes);try{for(e.s();!(t=e.n()).done;){var n=t.value,i=this.getConnectorPosition(n);for(var r in i){var a=i[r];if(Math.hypot(a.x-this.cursorToChartOffset.x,a.y-this.cursorToChartOffset.y)<10)return{position:r,node:n}}}}catch(s){e.e(s)}finally{e.f()}return null},hoveredConnection:function(){var t,e=this,n=Object(o["a"])(this.lines);try{var i=function(){var n=t.value,i=Xl(n.sourceX,n.sourceY,n.destinationX,n.destinationY,e.cursorToChartOffset.x,e.cursorToChartOffset.y);if(i<5&&Yl(n.sourceX-2,n.destinationX+2,e.cursorToChartOffset.x)&&Yl(n.sourceY-2,n.destinationY+2,e.cursorToChartOffset.y)){var r=e.internalConnections.filter((function(t){return t.id===n.id}));return{v:r.length>0?r[0]:null}}};for(n.s();!(t=n.n()).done;){var r=i();if("object"===u(r))return r.v}}catch(a){n.e(a)}finally{n.f()}return null},cursor:function(){return this.connectingInfo.source||this.hoveredConnector?"crosshair":null!=this.hoveredConnection?"pointer":null}},watch:{internalNodes:{immediate:!0,deep:!0,handler:function(){this.renderNodes(),this.renderConnections()}},internalConnections:{immediate:!0,deep:!0,handler:function(){this.renderConnections()}},currentNodes:{immediate:!0,deep:!0,handler:function(){var t=this;setTimeout((function(){t.$emit("select",t.currentNodes),t.renderNodes()}),1)}},currentConnections:{immediate:!0,deep:!0,handler:function(){this.renderConnections()}},zoom:{immediate:!0,deep:!0,handler:function(){this.$el&&(this.width=Math.max(this.originalWidth*this.zoom,this.$el.parentNode.offsetWidth),this.height=Math.max(this.originalHeight*this.zoom,this.$el.parentNode.offsetHeight))}},connectingInfo:{immediate:!0,deep:!0,handler:function(){this.renderConnections()}},steps:{immediate:!0,deep:!0,handler:function(){this.init()}}}},cc=lc,uc=(n("369f"),n("20a3"),n("2877")),hc=Object(uc["a"])(cc,l,c,!1,null,"998e2808",null),dc=hc.exports,pc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("TemplateModal",{scopedSlots:t._u([{key:"default",fn:function(){return[n("div",{staticClass:"m-modal-title"},[t._v(t._s(t.$t("MODAL.PUBLISH.PUBLISH_CHECK")))]),n("form",{on:{submit:function(e){return e.preventDefault(),t.publish.apply(null,arguments)}}},[n("div",{staticClass:"form-group row"},[n("div",{staticClass:"m-label text-right"},[t._v(t._s(t.$t("GENERAL.WF_NAME")))]),n("div",{staticClass:"m-text"},[t._v(t._s(t.detail?t.detail.name:t.$t("GENERAL.WF_NAME")))])]),n("div",{staticClass:"form-group row"},[n("div",{staticClass:"m-label text-right"},[t._v(t._s(t.$t("GENERAL.VERSION")))]),n("div",{staticClass:"m-text"},[t._v("V"+t._s((t.detail&&t.detail.latestVersion||0)+1))])]),n("div",{staticClass:"form-group row"},[n("div",{staticClass:"m-label text-right"},[t._v(t._s(t.$t("MODAL.PUBLISH.RELEASE_NOTES")))]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"form-control",attrs:{type:"text",placeholder:t.$t("MODAL.PUBLISH.RELEASE_NOTES_PH"),rows:"5",maxlength:"500",required:""},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),n("div",{staticClass:"desc-count text-right"},[t._v(t._s(t.description&&t.description.length||0)+"/500")])]),n("div",{staticClass:"form-group row"},[n("b-button",{staticClass:"btn-cancel float-left",on:{click:t.cancel}},[t._v(t._s(t.$t("GENERAL.CANCEL")))]),n("b-button",{staticClass:"btn-ok float-right",attrs:{type:"submit"}},[t._v(t._s(t.$t("MODAL.PUBLISH.PUBLISH")))])],1)])]},proxy:!0}])})},fc=[],mc=n("1b36"),gc={components:{TemplateModal:mc["a"]},props:{doPublish:Function},mounted:function(){this.getDetail()},data:function(){return{detail:null,description:""}},methods:{publish:function(){var t=this;0!=this.detail.version?this.$confirm(this.$t("MODAL.PUBLISH.UPDATE_CHECK"),"".concat(this.$t("MODAL.PUBLISH.UPDATE_CONFIRM_1")).concat(this.detail.version).concat(this.$t("MODAL.PUBLISH.UPDATE_CONFIRM_2")).concat(this.detail.latestVersion+1,"？"),(function(){t.doPublish(t.description)})):this.doPublish(this.description)},cancel:function(){this.$emit("cancel")},getDetail:function(){var t=this,e={uuid:this.$route.params.uuid};this.apiGet("workflow/detail",e).then((function(e){var n=e.data;t.detail=n}))}}},vc=gc,xc=(n("7abd"),Object(uc["a"])(vc,pc,fc,!1,null,"5ca922c2",null)),yc=xc.exports;
/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
const _c="136",bc={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},wc={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Mc=0,Sc=1,Tc=2,Ec=1,Cc=2,Ac=3,Lc=0,Rc=1,Pc=2,Nc=1,Dc=0,kc=1,Ic=2,Oc=3,Fc=4,Uc=5,zc=100,Hc=101,Bc=102,Vc=103,Gc=104,Wc=200,jc=201,qc=202,Xc=203,Yc=204,$c=205,Zc=206,Jc=207,Kc=208,Qc=209,tu=210,eu=0,nu=1,iu=2,ru=3,ou=4,au=5,su=6,lu=7,cu=0,uu=1,hu=2,du=0,pu=1,fu=2,mu=3,gu=4,vu=5,xu=300,yu=301,_u=302,bu=303,wu=304,Mu=306,Su=307,Tu=1e3,Eu=1001,Cu=1002,Au=1003,Lu=1004,Ru=1005,Pu=1006,Nu=1007,Du=1008,ku=1009,Iu=1010,Ou=1011,Fu=1012,Uu=1013,zu=1014,Hu=1015,Bu=1016,Vu=1017,Gu=1018,Wu=1019,ju=1020,qu=1021,Xu=1022,Yu=1023,$u=1024,Zu=1025,Ju=1026,Ku=1027,Qu=1028,th=1029,eh=1030,nh=1031,ih=1032,rh=1033,oh=33776,ah=33777,sh=33778,lh=33779,ch=35840,uh=35841,hh=35842,dh=35843,ph=36196,fh=37492,mh=37496,gh=37808,vh=37809,xh=37810,yh=37811,_h=37812,bh=37813,wh=37814,Mh=37815,Sh=37816,Th=37817,Eh=37818,Ch=37819,Ah=37820,Lh=37821,Rh=36492,Ph=37840,Nh=37841,Dh=37842,kh=37843,Ih=37844,Oh=37845,Fh=37846,Uh=37847,zh=37848,Hh=37849,Bh=37850,Vh=37851,Gh=37852,Wh=37853,jh=2200,qh=2201,Xh=2202,Yh=2300,$h=2301,Zh=2302,Jh=2400,Kh=2401,Qh=2402,td=2500,ed=2501,nd=0,id=1,rd=2,od=3e3,ad=3001,sd=3200,ld=3201,cd=0,ud=1,hd=7680,dd=519,pd=35044,fd=35048,md="300 es";class gd{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners,i=n[t];if(void 0!==i){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners,n=e[t.type];if(void 0!==n){t.target=this;const e=n.slice(0);for(let n=0,i=e.length;n<i;n++)e[n].call(this,t);t.target=null}}}const vd=[];for(let AE=0;AE<256;AE++)vd[AE]=(AE<16?"0":"")+AE.toString(16);let xd=1234567;const yd=Math.PI/180,_d=180/Math.PI;function bd(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=vd[255&t]+vd[t>>8&255]+vd[t>>16&255]+vd[t>>24&255]+"-"+vd[255&e]+vd[e>>8&255]+"-"+vd[e>>16&15|64]+vd[e>>24&255]+"-"+vd[63&n|128]+vd[n>>8&255]+"-"+vd[n>>16&255]+vd[n>>24&255]+vd[255&i]+vd[i>>8&255]+vd[i>>16&255]+vd[i>>24&255];return r.toUpperCase()}function wd(t,e,n){return Math.max(e,Math.min(n,t))}function Md(t,e){return(t%e+e)%e}function Sd(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function Td(t,e,n){return t!==e?(n-t)/(e-t):0}function Ed(t,e,n){return(1-n)*t+n*e}function Cd(t,e,n,i){return Ed(t,e,1-Math.exp(-n*i))}function Ad(t,e=1){return e-Math.abs(Md(t,2*e)-e)}function Ld(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function Rd(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(6*t-15)+10))}function Pd(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Nd(t,e){return t+Math.random()*(e-t)}function Dd(t){return t*(.5-Math.random())}function kd(t){return void 0!==t&&(xd=t%2147483647),xd=16807*xd%2147483647,(xd-1)/2147483646}function Id(t){return t*yd}function Od(t){return t*_d}function Fd(t){return 0===(t&t-1)&&0!==t}function Ud(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function zd(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Hd(t,e,n,i,r){const o=Math.cos,a=Math.sin,s=o(n/2),l=a(n/2),c=o((e+i)/2),u=a((e+i)/2),h=o((e-i)/2),d=a((e-i)/2),p=o((i-e)/2),f=a((i-e)/2);switch(r){case"XYX":t.set(s*u,l*h,l*d,s*c);break;case"YZY":t.set(l*d,s*u,l*h,s*c);break;case"ZXZ":t.set(l*h,l*d,s*u,s*c);break;case"XZX":t.set(s*u,l*f,l*p,s*c);break;case"YXY":t.set(l*p,s*u,l*f,s*c);break;case"ZYZ":t.set(l*f,l*p,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}var Bd=Object.freeze({__proto__:null,DEG2RAD:yd,RAD2DEG:_d,generateUUID:bd,clamp:wd,euclideanModulo:Md,mapLinear:Sd,inverseLerp:Td,lerp:Ed,damp:Cd,pingpong:Ad,smoothstep:Ld,smootherstep:Rd,randInt:Pd,randFloat:Nd,randFloatSpread:Dd,seededRandom:kd,degToRad:Id,radToDeg:Od,isPowerOfTwo:Fd,ceilPowerOfTwo:Ud,floorPowerOfTwo:zd,setQuaternionFromProperEuler:Hd});class Vd{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){const t=Math.atan2(-this.y,-this.x)+Math.PI;return t}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*n-o*i+t.x,this.y=r*i+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Vd.prototype.isVector2=!0;class Gd{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,o,a,s,l){const c=this.elements;return c[0]=t,c[1]=i,c[2]=a,c[3]=e,c[4]=r,c[5]=s,c[6]=n,c[7]=o,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[3],s=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],x=i[4],y=i[7],_=i[2],b=i[5],w=i[8];return r[0]=o*f+a*v+s*_,r[3]=o*m+a*x+s*b,r[6]=o*g+a*y+s*w,r[1]=l*f+c*v+u*_,r[4]=l*m+c*x+u*b,r[7]=l*g+c*y+u*w,r[2]=h*f+d*v+p*_,r[5]=h*m+d*x+p*b,r[8]=h*g+d*y+p*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8];return e*o*c-e*a*l-n*r*c+n*a*s+i*r*l-i*o*s}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=c*o-a*l,h=a*s-c*r,d=l*r-o*s,p=e*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=u*f,t[1]=(i*l-c*n)*f,t[2]=(a*n-i*o)*f,t[3]=h*f,t[4]=(c*e-i*s)*f,t[5]=(i*r-a*e)*f,t[6]=d*f,t[7]=(n*s-l*e)*f,t[8]=(o*e-n*r)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,o,a){const s=Math.cos(r),l=Math.sin(r);return this.set(n*s,n*l,-n*(s*o+l*a)+o+t,-i*l,i*s,-i*(-l*o+s*a)+a+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],o=i[3],a=i[6],s=i[1],l=i[4],c=i[7];return i[0]=e*r+n*s,i[3]=e*o+n*l,i[6]=e*a+n*c,i[1]=-n*r+e*s,i[4]=-n*o+e*l,i[7]=-n*a+e*c,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}function Wd(t){if(0===t.length)return-1/0;let e=t[0];for(let n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}Gd.prototype.isMatrix3=!0;Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function jd(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}let qd;class Xd{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===qd&&(qd=jd("canvas")),qd.width=t.width,qd.height=t.height;const n=qd.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=qd}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}}let Yd=0;class $d extends gd{constructor(t=$d.DEFAULT_IMAGE,e=$d.DEFAULT_MAPPING,n=Eu,i=Eu,r=Pu,o=Du,a=Yu,s=ku,l=1,c=od){super(),Object.defineProperty(this,"id",{value:Yd++}),this.uuid=bd(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=o,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=s,this.offset=new Vd(0,0),this.repeat=new Vd(1,1),this.center=new Vd(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Gd,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const i=this.image;if(void 0===i.uuid&&(i.uuid=bd()),!e&&void 0===t.images[i.uuid]){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(Zd(i[t].image)):e.push(Zd(i[t]))}else e=Zd(i);t.images[i.uuid]={uuid:i.uuid,url:e}}n.image=i.uuid}return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==xu)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Tu:t.x=t.x-Math.floor(t.x);break;case Eu:t.x=t.x<0?0:1;break;case Cu:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Tu:t.y=t.y-Math.floor(t.y);break;case Eu:t.y=t.y<0?0:1;break;case Cu:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&this.version++}}function Zd(t){return"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?Xd.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}$d.DEFAULT_IMAGE=void 0,$d.DEFAULT_MAPPING=xu,$d.prototype.isTexture=!0;class Jd{constructor(t=0,e=0,n=0,i=1){this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const o=.01,a=.1,s=t.elements,l=s[0],c=s[4],u=s[8],h=s[1],d=s[5],p=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(c-h)<o&&Math.abs(u-f)<o&&Math.abs(p-m)<o){if(Math.abs(c+h)<a&&Math.abs(u+f)<a&&Math.abs(p+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,s=(d+1)/2,v=(g+1)/2,x=(c+h)/4,y=(u+f)/4,_=(p+m)/4;return t>s&&t>v?t<o?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=x/n,r=y/n):s>v?s<o?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(s),n=x/i,r=_/i):v<o?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=y/r,i=_/r),this.set(n,i,r,e),this}let v=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(u-f)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Jd.prototype.isVector4=!0;class Kd extends gd{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new Jd(0,0,t,e),this.scissorTest=!1,this.viewport=new Jd(0,0,t,e),this.texture=new $d(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Pu,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Kd.prototype.isWebGLRenderTarget=!0;class Qd extends Kd{constructor(t,e,n){super(t,e);const i=this.texture;this.texture=[];for(let r=0;r<n;r++)this.texture[r]=i.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=t,this.texture[i].image.height=e,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}}Qd.prototype.isWebGLMultipleRenderTargets=!0;class tp extends Kd{constructor(t,e,n={}){super(t,e,n),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===n.ignoreDepth||n.ignoreDepth,this.useRenderToTexture=void 0!==n.useRenderToTexture&&n.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(t){return super.copy.call(this,t),this.samples=t.samples,this.useRenderToTexture=t.useRenderToTexture,this.useRenderbuffer=t.useRenderbuffer,this}}tp.prototype.isWebGLMultisampleRenderTarget=!0;class ep{constructor(t=0,e=0,n=0,i=1){this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,i)}static slerpFlat(t,e,n,i,r,o,a){let s=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(0===a)return t[e+0]=s,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===a)return t[e+0]=h,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(u!==f||s!==h||l!==d||c!==p){let t=1-a;const e=s*h+l*d+c*p+u*f,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),o=Math.atan2(r,e*n);t=Math.sin(t*o)/r,a=Math.sin(a*o)/r}const r=a*n;if(s=s*t+h*r,l=l*t+d*r,c=c*t+p*r,u=u*t+f*r,t===1-a){const t=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=t,l*=t,c*=t,u*=t}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,i,r,o){const a=n[i],s=n[i+1],l=n[i+2],c=n[i+3],u=r[o],h=r[o+1],d=r[o+2],p=r[o+3];return t[e]=a*p+c*u+s*d-l*h,t[e+1]=s*p+c*h+l*u-a*d,t[e+2]=l*p+c*d+a*h-s*u,t[e+3]=c*p-a*u-s*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,i=t._y,r=t._z,o=t._order,a=Math.cos,s=Math.sin,l=a(n/2),c=a(i/2),u=a(r/2),h=s(n/2),d=s(i/2),p=s(r/2);switch(o){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],o=e[1],a=e[5],s=e[9],l=e[2],c=e[6],u=e[10],h=n+a+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-s)*t,this._y=(r-l)*t,this._z=(o-i)*t}else if(n>a&&n>u){const t=2*Math.sqrt(1+n-a-u);this._w=(c-s)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(r+l)/t}else if(a>u){const t=2*Math.sqrt(1+a-n-u);this._w=(r-l)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(s+c)/t}else{const t=2*Math.sqrt(1+u-n-a);this._w=(o-i)/t,this._x=(r+l)/t,this._y=(s+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(wd(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,o=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=n*c+o*a+i*l-r*s,this._y=i*c+o*s+r*a-n*l,this._z=r*c+o*l+n*s-i*a,this._w=o*c-n*a-i*s-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,o=this._w;let a=o*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;const s=1-a*a;if(s<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(s),c=Math.atan2(l,a),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}ep.prototype.isQuaternion=!0;class np{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(rp.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(rp.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,o=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*i-a*n,c=s*n+a*e-r*i,u=s*i+r*n-o*e,h=-r*e-o*n-a*i;return this.x=l*s+h*-r+c*-a-u*-o,this.y=c*s+h*-o+u*-r-l*-a,this.z=u*s+h*-a+l*-o-c*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return ip.copy(this).projectOnVector(t),this.sub(ip)}reflect(t){return this.sub(ip.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(wd(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}np.prototype.isVector3=!0;const ip=new np,rp=new ep;class op{constructor(t=new np(1/0,1/0,1/0),e=new np(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,l=t.length;s<l;s+=3){const l=t[s],c=t[s+1],u=t[s+2];l<e&&(e=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>o&&(o=c),u>a&&(a=u)}return this.min.set(e,n,i),this.max.set(r,o,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,l=t.count;s<l;s++){const l=t.getX(s),c=t.getY(s),u=t.getZ(s);l<e&&(e=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>o&&(o=c),u>a&&(a=u)}return this.min.set(e,n,i),this.max.set(r,o,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=sp.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),lp.copy(e.boundingBox),lp.applyMatrix4(t.matrixWorld),this.union(lp));const n=t.children;for(let i=0,r=n.length;i<r;i++)this.expandByObject(n[i]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,sp),sp.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(mp),gp.subVectors(this.max,mp),cp.subVectors(t.a,mp),up.subVectors(t.b,mp),hp.subVectors(t.c,mp),dp.subVectors(up,cp),pp.subVectors(hp,up),fp.subVectors(cp,hp);let e=[0,-dp.z,dp.y,0,-pp.z,pp.y,0,-fp.z,fp.y,dp.z,0,-dp.x,pp.z,0,-pp.x,fp.z,0,-fp.x,-dp.y,dp.x,0,-pp.y,pp.x,0,-fp.y,fp.x,0];return!!yp(e,cp,up,hp,gp)&&(e=[1,0,0,0,1,0,0,0,1],!!yp(e,cp,up,hp,gp)&&(vp.crossVectors(dp,pp),e=[vp.x,vp.y,vp.z],yp(e,cp,up,hp,gp)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){const e=sp.copy(t).clamp(this.min,this.max);return e.sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(sp).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(ap[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),ap[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),ap[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),ap[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),ap[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),ap[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),ap[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),ap[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(ap)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}op.prototype.isBox3=!0;const ap=[new np,new np,new np,new np,new np,new np,new np,new np],sp=new np,lp=new op,cp=new np,up=new np,hp=new np,dp=new np,pp=new np,fp=new np,mp=new np,gp=new np,vp=new np,xp=new np;function yp(t,e,n,i,r){for(let o=0,a=t.length-3;o<=a;o+=3){xp.fromArray(t,o);const a=r.x*Math.abs(xp.x)+r.y*Math.abs(xp.y)+r.z*Math.abs(xp.z),s=e.dot(xp),l=n.dot(xp),c=i.dot(xp);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>a)return!1}return!0}const _p=new op,bp=new np,wp=new np,Mp=new np;class Sp{constructor(t=new np,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):_p.setFromPoints(t).getCenter(n);let i=0;for(let r=0,o=t.length;r<o;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){Mp.subVectors(t,this.center);const e=Mp.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.add(Mp.multiplyScalar(n/t)),this.radius+=n}return this}union(t){return!0===this.center.equals(t.center)?wp.set(0,0,1).multiplyScalar(t.radius):wp.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(bp.copy(t.center).add(wp)),this.expandByPoint(bp.copy(t.center).sub(wp)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Tp=new np,Ep=new np,Cp=new np,Ap=new np,Lp=new np,Rp=new np,Pp=new np;class Np{constructor(t=new np,e=new np(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Tp)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Tp.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Tp.copy(this.direction).multiplyScalar(e).add(this.origin),Tp.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){Ep.copy(t).add(e).multiplyScalar(.5),Cp.copy(e).sub(t).normalize(),Ap.copy(this.origin).sub(Ep);const r=.5*t.distanceTo(e),o=-this.direction.dot(Cp),a=Ap.dot(this.direction),s=-Ap.dot(Cp),l=Ap.lengthSq(),c=Math.abs(1-o*o);let u,h,d,p;if(c>0)if(u=o*s-a,h=o*a-s,p=r*c,u>=0)if(h>=-p)if(h<=p){const t=1/c;u*=t,h*=t,d=u*(u+o*h+2*a)+h*(o*u+h+2*s)+l}else h=r,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;else h=-r,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;else h<=-p?(u=Math.max(0,-(-o*r+a)),h=u>0?-r:Math.min(Math.max(-r,-s),r),d=-u*u+h*(h+2*s)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-s),r),d=h*(h+2*s)+l):(u=Math.max(0,-(o*r+a)),h=u>0?r:Math.min(Math.max(-r,-s),r),d=-u*u+h*(h+2*s)+l);else h=o>0?-r:r,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(Cp).multiplyScalar(h).add(Ep),d}intersectSphere(t,e){Tp.subVectors(t.center,this.origin);const n=Tp.dot(this.direction),i=Tp.dot(Tp)-n*n,r=t.radius*t.radius;if(i>r)return null;const o=Math.sqrt(r-i),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;const n=t.normal.dot(this.direction);return n*e<0}intersectBox(t,e){let n,i,r,o,a,s;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,i=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,i=(t.min.x-h.x)*l),c>=0?(r=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(r=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||r>i?null:((r>n||n!==n)&&(n=r),(o<i||i!==i)&&(i=o),u>=0?(a=(t.min.z-h.z)*u,s=(t.max.z-h.z)*u):(a=(t.max.z-h.z)*u,s=(t.min.z-h.z)*u),n>s||a>i?null:((a>n||n!==n)&&(n=a),(s<i||i!==i)&&(i=s),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,Tp)}intersectTriangle(t,e,n,i,r){Lp.subVectors(e,t),Rp.subVectors(n,t),Pp.crossVectors(Lp,Rp);let o,a=this.direction.dot(Pp);if(a>0){if(i)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Ap.subVectors(this.origin,t);const s=o*this.direction.dot(Rp.crossVectors(Ap,Rp));if(s<0)return null;const l=o*this.direction.dot(Lp.cross(Ap));if(l<0)return null;if(s+l>a)return null;const c=-o*Ap.dot(Pp);return c<0?null:this.at(c/a,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Dp{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,o,a,s,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Dp).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/kp.setFromMatrixColumn(t,0).length(),r=1/kp.setFromMatrixColumn(t,1).length(),o=1/kp.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,i=t.y,r=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===t.order){const t=o*c,n=o*u,i=a*c,r=a*u;e[0]=s*c,e[4]=-s*u,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-a*s,e[2]=r-t*l,e[6]=i+n*l,e[10]=o*s}else if("YXZ"===t.order){const t=s*c,n=s*u,i=l*c,r=l*u;e[0]=t+r*a,e[4]=i*a-n,e[8]=o*l,e[1]=o*u,e[5]=o*c,e[9]=-a,e[2]=n*a-i,e[6]=r+t*a,e[10]=o*s}else if("ZXY"===t.order){const t=s*c,n=s*u,i=l*c,r=l*u;e[0]=t-r*a,e[4]=-o*u,e[8]=i+n*a,e[1]=n+i*a,e[5]=o*c,e[9]=r-t*a,e[2]=-o*l,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){const t=o*c,n=o*u,i=a*c,r=a*u;e[0]=s*c,e[4]=i*l-n,e[8]=t*l+r,e[1]=s*u,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){const t=o*s,n=o*l,i=a*s,r=a*l;e[0]=s*c,e[4]=r-t*u,e[8]=i*u+n,e[1]=u,e[5]=o*c,e[9]=-a*c,e[2]=-l*c,e[6]=n*u+i,e[10]=t-r*u}else if("XZY"===t.order){const t=o*s,n=o*l,i=a*s,r=a*l;e[0]=s*c,e[4]=-u,e[8]=l*c,e[1]=t*u+r,e[5]=o*c,e[9]=n*u-i,e[2]=i*u-n,e[6]=a*c,e[10]=r*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Op,t,Fp)}lookAt(t,e,n){const i=this.elements;return Hp.subVectors(t,e),0===Hp.lengthSq()&&(Hp.z=1),Hp.normalize(),Up.crossVectors(n,Hp),0===Up.lengthSq()&&(1===Math.abs(n.z)?Hp.x+=1e-4:Hp.z+=1e-4,Hp.normalize(),Up.crossVectors(n,Hp)),Up.normalize(),zp.crossVectors(Hp,Up),i[0]=Up.x,i[4]=zp.x,i[8]=Hp.x,i[1]=Up.y,i[5]=zp.y,i[9]=Hp.y,i[2]=Up.z,i[6]=zp.z,i[10]=Hp.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],x=n[7],y=n[11],_=n[15],b=i[0],w=i[4],M=i[8],S=i[12],T=i[1],E=i[5],C=i[9],A=i[13],L=i[2],R=i[6],P=i[10],N=i[14],D=i[3],k=i[7],I=i[11],O=i[15];return r[0]=o*b+a*T+s*L+l*D,r[4]=o*w+a*E+s*R+l*k,r[8]=o*M+a*C+s*P+l*I,r[12]=o*S+a*A+s*N+l*O,r[1]=c*b+u*T+h*L+d*D,r[5]=c*w+u*E+h*R+d*k,r[9]=c*M+u*C+h*P+d*I,r[13]=c*S+u*A+h*N+d*O,r[2]=p*b+f*T+m*L+g*D,r[6]=p*w+f*E+m*R+g*k,r[10]=p*M+f*C+m*P+g*I,r[14]=p*S+f*A+m*N+g*O,r[3]=v*b+x*T+y*L+_*D,r[7]=v*w+x*E+y*R+_*k,r[11]=v*M+x*C+y*P+_*I,r[15]=v*S+x*A+y*N+_*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14],p=t[3],f=t[7],m=t[11],g=t[15];return p*(+r*s*u-i*l*u-r*a*h+n*l*h+i*a*d-n*s*d)+f*(+e*s*d-e*l*h+r*o*h-i*o*d+i*l*c-r*s*c)+m*(+e*l*u-e*a*d-r*o*u+n*o*d+r*a*c-n*l*c)+g*(-i*a*c-e*s*u+e*a*h+i*o*u-n*o*h+n*s*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],v=u*m*l-f*h*l+f*s*d-a*m*d-u*s*g+a*h*g,x=p*h*l-c*m*l-p*s*d+o*m*d+c*s*g-o*h*g,y=c*f*l-p*u*l+p*a*d-o*f*d-c*a*g+o*u*g,_=p*u*s-c*f*s-p*a*h+o*f*h+c*a*m-o*u*m,b=e*v+n*x+i*y+r*_;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/b;return t[0]=v*w,t[1]=(f*h*r-u*m*r-f*i*d+n*m*d+u*i*g-n*h*g)*w,t[2]=(a*m*r-f*s*r+f*i*l-n*m*l-a*i*g+n*s*g)*w,t[3]=(u*s*r-a*h*r-u*i*l+n*h*l+a*i*d-n*s*d)*w,t[4]=x*w,t[5]=(c*m*r-p*h*r+p*i*d-e*m*d-c*i*g+e*h*g)*w,t[6]=(p*s*r-o*m*r-p*i*l+e*m*l+o*i*g-e*s*g)*w,t[7]=(o*h*r-c*s*r+c*i*l-e*h*l-o*i*d+e*s*d)*w,t[8]=y*w,t[9]=(p*u*r-c*f*r-p*n*d+e*f*d+c*n*g-e*u*g)*w,t[10]=(o*f*r-p*a*r+p*n*l-e*f*l-o*n*g+e*a*g)*w,t[11]=(c*a*r-o*u*r-c*n*l+e*u*l+o*n*d-e*a*d)*w,t[12]=_*w,t[13]=(c*f*i-p*u*i+p*n*h-e*f*h-c*n*m+e*u*m)*w,t[14]=(p*a*i-o*f*i-p*n*s+e*f*s+o*n*m-e*a*m)*w,t[15]=(o*u*i-c*a*i+c*n*s-e*u*s-o*n*h+e*a*h)*w,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,a=t.y,s=t.z,l=r*o,c=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,c*a+n,c*s-i*o,0,l*s-i*a,c*s+i*o,r*s*s+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,o){return this.set(1,n,r,0,t,1,o,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,o=e._y,a=e._z,s=e._w,l=r+r,c=o+o,u=a+a,h=r*l,d=r*c,p=r*u,f=o*c,m=o*u,g=a*u,v=s*l,x=s*c,y=s*u,_=n.x,b=n.y,w=n.z;return i[0]=(1-(f+g))*_,i[1]=(d+y)*_,i[2]=(p-x)*_,i[3]=0,i[4]=(d-y)*b,i[5]=(1-(h+g))*b,i[6]=(m+v)*b,i[7]=0,i[8]=(p+x)*w,i[9]=(m-v)*w,i[10]=(1-(h+f))*w,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=kp.set(i[0],i[1],i[2]).length();const o=kp.set(i[4],i[5],i[6]).length(),a=kp.set(i[8],i[9],i[10]).length(),s=this.determinant();s<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],Ip.copy(this);const l=1/r,c=1/o,u=1/a;return Ip.elements[0]*=l,Ip.elements[1]*=l,Ip.elements[2]*=l,Ip.elements[4]*=c,Ip.elements[5]*=c,Ip.elements[6]*=c,Ip.elements[8]*=u,Ip.elements[9]*=u,Ip.elements[10]*=u,e.setFromRotationMatrix(Ip),n.x=r,n.y=o,n.z=a,this}makePerspective(t,e,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,s=2*r/(e-t),l=2*r/(n-i),c=(e+t)/(e-t),u=(n+i)/(n-i),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,i,r,o){const a=this.elements,s=1/(e-t),l=1/(n-i),c=1/(o-r),u=(e+t)*s,h=(n+i)*l,d=(o+r)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}Dp.prototype.isMatrix4=!0;const kp=new np,Ip=new Dp,Op=new np(0,0,0),Fp=new np(1,1,1),Up=new np,zp=new np,Hp=new np,Bp=new Dp,Vp=new ep;class Gp{constructor(t=0,e=0,n=0,i=Gp.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,r=i[0],o=i[4],a=i[8],s=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(wd(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-wd(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(wd(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(s,r));break;case"ZYX":this._y=Math.asin(-wd(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,r)):(this._x=0,this._z=Math.atan2(-o,l));break;case"YZX":this._z=Math.asin(wd(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-wd(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Bp.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Bp,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Vp.setFromEuler(this),this.setFromQuaternion(Vp,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new np(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Gp.prototype.isEuler=!0,Gp.DefaultOrder="XYZ",Gp.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Wp{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!==(this.mask&t.mask)}isEnabled(t){return 0!==(this.mask&(1<<t|0))}}let jp=0;const qp=new np,Xp=new ep,Yp=new Dp,$p=new np,Zp=new np,Jp=new np,Kp=new ep,Qp=new np(1,0,0),tf=new np(0,1,0),ef=new np(0,0,1),nf={type:"added"},rf={type:"removed"};class of extends gd{constructor(){super(),Object.defineProperty(this,"id",{value:jp++}),this.uuid=bd(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=of.DefaultUp.clone();const t=new np,e=new Gp,n=new ep,i=new np(1,1,1);function r(){n.setFromEuler(e,!1)}function o(){e.setFromQuaternion(n,void 0,!1)}e._onChange(r),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Dp},normalMatrix:{value:new Gd}}),this.matrix=new Dp,this.matrixWorld=new Dp,this.matrixAutoUpdate=of.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Wp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Xp.setFromAxisAngle(t,e),this.quaternion.multiply(Xp),this}rotateOnWorldAxis(t,e){return Xp.setFromAxisAngle(t,e),this.quaternion.premultiply(Xp),this}rotateX(t){return this.rotateOnAxis(Qp,t)}rotateY(t){return this.rotateOnAxis(tf,t)}rotateZ(t){return this.rotateOnAxis(ef,t)}translateOnAxis(t,e){return qp.copy(t).applyQuaternion(this.quaternion),this.position.add(qp.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Qp,t)}translateY(t){return this.translateOnAxis(tf,t)}translateZ(t){return this.translateOnAxis(ef,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Yp.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?$p.copy(t):$p.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Zp.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Yp.lookAt(Zp,$p,this.up):Yp.lookAt($p,Zp,this.up),this.quaternion.setFromRotationMatrix(Yp),i&&(Yp.extractRotation(i.matrixWorld),Xp.setFromRotationMatrix(Yp),this.quaternion.premultiply(Xp.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(nf)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(rf)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(rf)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Yp.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Yp.multiply(t.parent.matrixWorld)),t.applyMatrix4(Yp),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n],r=i.getObjectByProperty(t,e);if(void 0!==r)return r}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zp,t,Jp),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zp,Kp,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"===typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const i=n[e];r(t.shapes,i)}else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];i.animations.push(r(t.animations,n))}}if(e){const e=o(t.geometries),i=o(t.materials),r=o(t.textures),a=o(t.images),s=o(t.shapes),l=o(t.skeletons),c=o(t.animations);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),s.length>0&&(n.shapes=s),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c)}return n.object=i,n;function o(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}of.DefaultUp=new np(0,1,0),of.DefaultMatrixAutoUpdate=!0,of.prototype.isObject3D=!0;const af=new np,sf=new np,lf=new np,cf=new np,uf=new np,hf=new np,df=new np,pf=new np,ff=new np,mf=new np;class gf{constructor(t=new np,e=new np,n=new np){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),af.subVectors(t,e),i.cross(af);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){af.subVectors(i,e),sf.subVectors(n,e),lf.subVectors(t,e);const o=af.dot(af),a=af.dot(sf),s=af.dot(lf),l=sf.dot(sf),c=sf.dot(lf),u=o*l-a*a;if(0===u)return r.set(-2,-1,-1);const h=1/u,d=(l*s-a*c)*h,p=(o*c-a*s)*h;return r.set(1-d-p,p,d)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,cf),cf.x>=0&&cf.y>=0&&cf.x+cf.y<=1}static getUV(t,e,n,i,r,o,a,s){return this.getBarycoord(t,e,n,i,cf),s.set(0,0),s.addScaledVector(r,cf.x),s.addScaledVector(o,cf.y),s.addScaledVector(a,cf.z),s}static isFrontFacing(t,e,n,i){return af.subVectors(n,e),sf.subVectors(t,e),af.cross(sf).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return af.subVectors(this.c,this.b),sf.subVectors(this.a,this.b),.5*af.cross(sf).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return gf.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return gf.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return gf.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return gf.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return gf.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let o,a;uf.subVectors(i,n),hf.subVectors(r,n),pf.subVectors(t,n);const s=uf.dot(pf),l=hf.dot(pf);if(s<=0&&l<=0)return e.copy(n);ff.subVectors(t,i);const c=uf.dot(ff),u=hf.dot(ff);if(c>=0&&u<=c)return e.copy(i);const h=s*u-c*l;if(h<=0&&s>=0&&c<=0)return o=s/(s-c),e.copy(n).addScaledVector(uf,o);mf.subVectors(t,r);const d=uf.dot(mf),p=hf.dot(mf);if(p>=0&&d<=p)return e.copy(r);const f=d*l-s*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),e.copy(n).addScaledVector(hf,a);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return df.subVectors(r,i),a=(u-c)/(u-c+(d-p)),e.copy(i).addScaledVector(df,a);const g=1/(m+f+h);return o=f*g,a=h*g,e.copy(n).addScaledVector(uf,o).addScaledVector(hf,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let vf=0;class xf extends gd{constructor(){super(),Object.defineProperty(this,"id",{value:vf++}),this.uuid=bd(),this.name="",this.type="Material",this.fog=!0,this.blending=kc,this.side=Lc,this.vertexColors=!1,this.opacity=1,this.format=Yu,this.transparent=!1,this.blendSrc=Yc,this.blendDst=$c,this.blendEquation=zc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ru,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=dd,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=hd,this.stencilZFail=hd,this.stencilZPass=hd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!==t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===Nc;continue}const i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"===typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==kc&&(n.blending=this.blending),this.side!==Lc&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.format!==Yu&&(n.format=this.format),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.format=t.format,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}xf.prototype.isMaterial=!0;const yf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_f={h:0,s:0,l:0},bf={h:0,s:0,l:0};function wf(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Mf(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Sf(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class Tf{constructor(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=Md(t,1),e=wd(e,0,1),n=wd(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=wf(r,i,t+1/3),this.g=wf(r,i,t),this.b=wf(r,i,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const i=n[1],r=n[2];switch(i){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r)){const n=parseFloat(t[1])/360,i=parseInt(t[2],10)/100,r=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(n,i,r)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=yf[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Mf(t.r),this.g=Mf(t.g),this.b=Mf(t.b),this}copyLinearToSRGB(t){return this.r=Sf(t.r),this.g=Sf(t.g),this.b=Sf(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,i=this.b,r=Math.max(e,n,i),o=Math.min(e,n,i);let a,s;const l=(o+r)/2;if(o===r)a=0,s=0;else{const t=r-o;switch(s=l<=.5?t/(r+o):t/(2-r-o),r){case e:a=(n-i)/t+(n<i?6:0);break;case n:a=(i-e)/t+2;break;case i:a=(e-n)/t+4;break}a/=6}return t.h=a,t.s=s,t.l=l,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(_f),_f.h+=t,_f.s+=e,_f.l+=n,this.setHSL(_f.h,_f.s,_f.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(_f),t.getHSL(bf);const n=Ed(_f.h,bf.h,e),i=Ed(_f.s,bf.s,e),r=Ed(_f.l,bf.l,e);return this.setHSL(n,i,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Tf.NAMES=yf,Tf.prototype.isColor=!0,Tf.prototype.r=1,Tf.prototype.g=1,Tf.prototype.b=1;class Ef extends xf{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new Tf(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=cu,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Ef.prototype.isMeshBasicMaterial=!0;const Cf=new np,Af=new Vd;class Lf{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=pd,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new Tf),e[n++]=r.r,e[n++]=r.g,e[n++]=r.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new Vd),e[n++]=r.x,e[n++]=r.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new np),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new Jd),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z,e[n++]=r.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Af.fromBufferAttribute(this,e),Af.applyMatrix3(t),this.setXY(e,Af.x,Af.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Cf.fromBufferAttribute(this,e),Cf.applyMatrix3(t),this.setXYZ(e,Cf.x,Cf.y,Cf.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Cf.x=this.getX(e),Cf.y=this.getY(e),Cf.z=this.getZ(e),Cf.applyMatrix4(t),this.setXYZ(e,Cf.x,Cf.y,Cf.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Cf.x=this.getX(e),Cf.y=this.getY(e),Cf.z=this.getZ(e),Cf.applyNormalMatrix(t),this.setXYZ(e,Cf.x,Cf.y,Cf.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Cf.x=this.getX(e),Cf.y=this.getY(e),Cf.z=this.getZ(e),Cf.transformDirection(t),this.setXYZ(e,Cf.x,Cf.y,Cf.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==pd&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}Lf.prototype.isBufferAttribute=!0;class Rf extends Lf{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Pf extends Lf{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class Nf extends Lf{constructor(t,e,n){super(new Uint16Array(t),e,n)}}Nf.prototype.isFloat16BufferAttribute=!0;class Df extends Lf{constructor(t,e,n){super(new Float32Array(t),e,n)}}let kf=0;const If=new Dp,Of=new of,Ff=new np,Uf=new op,zf=new op,Hf=new np;class Bf extends gd{constructor(){super(),Object.defineProperty(this,"id",{value:kf++}),this.uuid=bd(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Wd(t)>65535?Pf:Rf)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new Gd).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return If.makeRotationFromQuaternion(t),this.applyMatrix4(If),this}rotateX(t){return If.makeRotationX(t),this.applyMatrix4(If),this}rotateY(t){return If.makeRotationY(t),this.applyMatrix4(If),this}rotateZ(t){return If.makeRotationZ(t),this.applyMatrix4(If),this}translate(t,e,n){return If.makeTranslation(t,e,n),this.applyMatrix4(If),this}scale(t,e,n){return If.makeScale(t,e,n),this.applyMatrix4(If),this}lookAt(t){return Of.lookAt(t),Of.updateMatrix(),this.applyMatrix4(Of.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ff).negate(),this.translate(Ff.x,Ff.y,Ff.z),this}setFromPoints(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Df(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new op);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new np(-1/0,-1/0,-1/0),new np(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,i=e.length;n<i;n++){const t=e[n];Uf.setFromBufferAttribute(t),this.morphTargetsRelative?(Hf.addVectors(this.boundingBox.min,Uf.min),this.boundingBox.expandByPoint(Hf),Hf.addVectors(this.boundingBox.max,Uf.max),this.boundingBox.expandByPoint(Hf)):(this.boundingBox.expandByPoint(Uf.min),this.boundingBox.expandByPoint(Uf.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Sp);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new np,1/0);if(t){const n=this.boundingSphere.center;if(Uf.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const n=e[t];zf.setFromBufferAttribute(n),this.morphTargetsRelative?(Hf.addVectors(Uf.min,zf.min),Uf.expandByPoint(Hf),Hf.addVectors(Uf.max,zf.max),Uf.expandByPoint(Hf)):(Uf.expandByPoint(zf.min),Uf.expandByPoint(zf.max))}Uf.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)Hf.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(Hf));if(e)for(let r=0,o=e.length;r<o;r++){const o=e[r],a=this.morphTargetsRelative;for(let e=0,r=o.count;e<r;e++)Hf.fromBufferAttribute(o,e),a&&(Ff.fromBufferAttribute(t,e),Hf.add(Ff)),i=Math.max(i,n.distanceToSquared(Hf))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,i=e.position.array,r=e.normal.array,o=e.uv.array,a=i.length/3;void 0===e.tangent&&this.setAttribute("tangent",new Lf(new Float32Array(4*a),4));const s=e.tangent.array,l=[],c=[];for(let T=0;T<a;T++)l[T]=new np,c[T]=new np;const u=new np,h=new np,d=new np,p=new Vd,f=new Vd,m=new Vd,g=new np,v=new np;function x(t,e,n){u.fromArray(i,3*t),h.fromArray(i,3*e),d.fromArray(i,3*n),p.fromArray(o,2*t),f.fromArray(o,2*e),m.fromArray(o,2*n),h.sub(u),d.sub(u),f.sub(p),m.sub(p);const r=1/(f.x*m.y-m.x*f.y);isFinite(r)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(r),v.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(r),l[t].add(g),l[e].add(g),l[n].add(g),c[t].add(v),c[e].add(v),c[n].add(v))}let y=this.groups;0===y.length&&(y=[{start:0,count:n.length}]);for(let T=0,E=y.length;T<E;++T){const t=y[T],e=t.start,i=t.count;for(let r=e,o=e+i;r<o;r+=3)x(n[r+0],n[r+1],n[r+2])}const _=new np,b=new np,w=new np,M=new np;function S(t){w.fromArray(r,3*t),M.copy(w);const e=l[t];_.copy(e),_.sub(w.multiplyScalar(w.dot(e))).normalize(),b.crossVectors(M,e);const n=b.dot(c[t]),i=n<0?-1:1;s[4*t]=_.x,s[4*t+1]=_.y,s[4*t+2]=_.z,s[4*t+3]=i}for(let T=0,E=y.length;T<E;++T){const t=y[T],e=t.start,i=t.count;for(let r=e,o=e+i;r<o;r+=3)S(n[r+0]),S(n[r+1]),S(n[r+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Lf(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new np,r=new np,o=new np,a=new np,s=new np,l=new np,c=new np,u=new np;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),p=t.getX(h+1),f=t.getX(h+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,p),o.fromBufferAttribute(e,f),c.subVectors(o,r),u.subVectors(i,r),c.cross(u),a.fromBufferAttribute(n,d),s.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),a.add(c),s.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(p,s.x,s.y,s.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,h=e.count;t<h;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),c.subVectors(o,r),u.subVectors(i,r),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(void 0===t.attributes[i])continue;const r=n[i],o=r.array,a=t.attributes[i],s=a.array,l=a.itemSize*e,c=Math.min(s.length,o.length-l);for(let t=0,e=l;t<c;t++,e++)o[e]=s[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Hf.fromBufferAttribute(t,e),Hf.normalize(),t.setXYZ(e,Hf.x,Hf.y,Hf.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,o=new n.constructor(e.length*i);let a=0,s=0;for(let l=0,c=e.length;l<c;l++){a=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*i;for(let t=0;t<i;t++)o[s++]=n[a++]}return new Lf(o,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Bf,n=this.index.array,i=this.attributes;for(const a in i){const r=i[a],o=t(r,n);e.setAttribute(a,o)}const r=this.morphAttributes;for(const a in r){const i=[],o=r[a];for(let e=0,r=o.length;e<r;e++){const r=o[e],a=t(r,n);i.push(a)}e.morphAttributes[a]=i}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,s=o.length;a<s;a++){const t=o[a];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const s in n){const e=n[s];t.data.attributes[s]=e.toJSON(t.data)}const i={};let r=!1;for(const s in this.morphAttributes){const e=this.morphAttributes[s],n=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];n.push(r.toJSON(t.data))}n.length>0&&(i[s]=n,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const i=t.attributes;for(const l in i){const t=i[l];this.setAttribute(l,t.clone(e))}const r=t.morphAttributes;for(const l in r){const t=[],n=r[l];for(let i=0,r=n.length;i<r;i++)t.push(n[i].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let l=0,c=o.length;l<c;l++){const t=o[l];this.addGroup(t.start,t.count,t.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=t.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Bf.prototype.isBufferGeometry=!0;const Vf=new Dp,Gf=new Np,Wf=new Sp,jf=new np,qf=new np,Xf=new np,Yf=new np,$f=new np,Zf=new np,Jf=new np,Kf=new np,Qf=new np,tm=new Vd,em=new Vd,nm=new Vd,im=new np,rm=new np;class om extends of{constructor(t=new Bf,e=new Ef){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),Wf.copy(n.boundingSphere),Wf.applyMatrix4(r),!1===t.ray.intersectsSphere(Wf))return;if(Vf.copy(r).invert(),Gf.copy(t.ray).applyMatrix4(Vf),null!==n.boundingBox&&!1===Gf.intersectsBox(n.boundingBox))return;let o;if(n.isBufferGeometry){const r=n.index,a=n.attributes.position,s=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==r)if(Array.isArray(i))for(let n=0,p=h.length;n<p;n++){const p=h[n],f=i[p.materialIndex],m=Math.max(p.start,d.start),g=Math.min(r.count,Math.min(p.start+p.count,d.start+d.count));for(let n=m,i=g;n<i;n+=3){const i=r.getX(n),h=r.getX(n+1),d=r.getX(n+2);o=sm(this,f,t,Gf,a,s,l,c,u,i,h,d),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=p.materialIndex,e.push(o))}}else{const n=Math.max(0,d.start),h=Math.min(r.count,d.start+d.count);for(let d=n,p=h;d<p;d+=3){const n=r.getX(d),h=r.getX(d+1),p=r.getX(d+2);o=sm(this,i,t,Gf,a,s,l,c,u,n,h,p),o&&(o.faceIndex=Math.floor(d/3),e.push(o))}}else if(void 0!==a)if(Array.isArray(i))for(let n=0,p=h.length;n<p;n++){const r=h[n],p=i[r.materialIndex],f=Math.max(r.start,d.start),m=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));for(let n=f,i=m;n<i;n+=3){const i=n,h=n+1,d=n+2;o=sm(this,p,t,Gf,a,s,l,c,u,i,h,d),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=r.materialIndex,e.push(o))}}else{const n=Math.max(0,d.start),r=Math.min(a.count,d.start+d.count);for(let h=n,d=r;h<d;h+=3){const n=h,r=h+1,d=h+2;o=sm(this,i,t,Gf,a,s,l,c,u,n,r,d),o&&(o.faceIndex=Math.floor(h/3),e.push(o))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function am(t,e,n,i,r,o,a,s){let l;if(l=e.side===Rc?i.intersectTriangle(a,o,r,!0,s):i.intersectTriangle(r,o,a,e.side!==Pc,s),null===l)return null;rm.copy(s),rm.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(rm);return c<n.near||c>n.far?null:{distance:c,point:rm.clone(),object:t}}function sm(t,e,n,i,r,o,a,s,l,c,u,h){jf.fromBufferAttribute(r,c),qf.fromBufferAttribute(r,u),Xf.fromBufferAttribute(r,h);const d=t.morphTargetInfluences;if(o&&d){Jf.set(0,0,0),Kf.set(0,0,0),Qf.set(0,0,0);for(let t=0,e=o.length;t<e;t++){const e=d[t],n=o[t];0!==e&&(Yf.fromBufferAttribute(n,c),$f.fromBufferAttribute(n,u),Zf.fromBufferAttribute(n,h),a?(Jf.addScaledVector(Yf,e),Kf.addScaledVector($f,e),Qf.addScaledVector(Zf,e)):(Jf.addScaledVector(Yf.sub(jf),e),Kf.addScaledVector($f.sub(qf),e),Qf.addScaledVector(Zf.sub(Xf),e)))}jf.add(Jf),qf.add(Kf),Xf.add(Qf)}t.isSkinnedMesh&&(t.boneTransform(c,jf),t.boneTransform(u,qf),t.boneTransform(h,Xf));const p=am(t,e,n,i,jf,qf,Xf,im);if(p){s&&(tm.fromBufferAttribute(s,c),em.fromBufferAttribute(s,u),nm.fromBufferAttribute(s,h),p.uv=gf.getUV(im,jf,qf,Xf,tm,em,nm,new Vd)),l&&(tm.fromBufferAttribute(l,c),em.fromBufferAttribute(l,u),nm.fromBufferAttribute(l,h),p.uv2=gf.getUV(im,jf,qf,Xf,tm,em,nm,new Vd));const t={a:c,b:u,c:h,normal:new np,materialIndex:0};gf.getNormal(jf,qf,Xf,t.normal),p.face=t}return p}om.prototype.isMesh=!0;class lm extends Bf{constructor(t=1,e=1,n=1,i=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};const a=this;i=Math.floor(i),r=Math.floor(r),o=Math.floor(o);const s=[],l=[],c=[],u=[];let h=0,d=0;function p(t,e,n,i,r,o,p,f,m,g,v){const x=o/m,y=p/g,_=o/2,b=p/2,w=f/2,M=m+1,S=g+1;let T=0,E=0;const C=new np;for(let a=0;a<S;a++){const o=a*y-b;for(let s=0;s<M;s++){const h=s*x-_;C[t]=h*i,C[e]=o*r,C[n]=w,l.push(C.x,C.y,C.z),C[t]=0,C[e]=0,C[n]=f>0?1:-1,c.push(C.x,C.y,C.z),u.push(s/m),u.push(1-a/g),T+=1}}for(let a=0;a<g;a++)for(let t=0;t<m;t++){const e=h+t+M*a,n=h+t+M*(a+1),i=h+(t+1)+M*(a+1),r=h+(t+1)+M*a;s.push(e,n,r),s.push(n,i,r),E+=6}a.addGroup(d,E,v),d+=E,h+=T}p("z","y","x",-1,-1,n,e,t,o,r,0),p("z","y","x",1,-1,n,e,-t,o,r,1),p("x","z","y",1,1,t,n,e,i,o,2),p("x","z","y",1,-1,t,n,-e,i,o,3),p("x","y","z",1,-1,t,e,n,i,r,4),p("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(s),this.setAttribute("position",new Df(l,3)),this.setAttribute("normal",new Df(c,3)),this.setAttribute("uv",new Df(u,2))}static fromJSON(t){return new lm(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function cm(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function um(t){const e={};for(let n=0;n<t.length;n++){const i=cm(t[n]);for(const t in i)e[t]=i[t]}return e}const hm={clone:cm,merge:um};var dm="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",pm="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";class fm extends xf{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=dm,this.fragmentShader=pm,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=cm(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i],r=n.value;r&&r.isTexture?e.uniforms[i]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[i]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[i]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[i]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[i]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[i]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[i]={type:"m4",value:r.toArray()}:e.uniforms[i]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}fm.prototype.isShaderMaterial=!0;class mm extends of{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Dp,this.projectionMatrix=new Dp,this.projectionMatrixInverse=new Dp}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}mm.prototype.isCamera=!0;class gm extends mm{constructor(t=50,e=1,n=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*_d*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*yd*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*_d*Math.atan(Math.tan(.5*yd*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,i,r,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*yd*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,a=o.fullHeight;r+=o.offsetX*i/t,e-=o.offsetY*n/a,i*=o.width/t,n*=o.height/a}const a=this.filmOffset;0!==a&&(r+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}gm.prototype.isPerspectiveCamera=!0;const vm=90,xm=1;class ym extends of{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const i=new gm(vm,xm,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new np(1,0,0)),this.add(i);const r=new gm(vm,xm,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new np(-1,0,0)),this.add(r);const o=new gm(vm,xm,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new np(0,1,0)),this.add(o);const a=new gm(vm,xm,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new np(0,-1,0)),this.add(a);const s=new gm(vm,xm,t,e);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new np(0,0,1)),this.add(s);const l=new gm(vm,xm,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new np(0,0,-1)),this.add(l)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[i,r,o,a,s,l]=this.children,c=t.xr.enabled,u=t.getRenderTarget();t.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,r),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,s),n.texture.generateMipmaps=h,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(u),t.xr.enabled=c}}class _m extends $d{constructor(t,e,n,i,r,o,a,s,l,c){t=void 0!==t?t:[],e=void 0!==e?e:yu,super(t,e,n,i,r,o,a,s,l,c),this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}_m.prototype.isCubeTexture=!0;class bm extends Kd{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),e=e||{},this.texture=new _m(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:Pu,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=Yu,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new lm(5,5,5),r=new fm({name:"CubemapFromEquirect",uniforms:cm(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Rc,blending:Dc});r.uniforms.tEquirect.value=e;const o=new om(i,r),a=e.minFilter;e.minFilter===Du&&(e.minFilter=Pu);const s=new ym(1,10,this);return s.update(t,o),e.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(t,e,n,i){const r=t.getRenderTarget();for(let o=0;o<6;o++)t.setRenderTarget(this,o),t.clear(e,n,i);t.setRenderTarget(r)}}bm.prototype.isWebGLCubeRenderTarget=!0;const wm=new np,Mm=new np,Sm=new Gd;class Tm{constructor(t=new np(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=wm.subVectors(n,e).cross(Mm.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(wm),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(n).multiplyScalar(r).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Sm.getNormalMatrix(t),i=this.coplanarPoint(wm).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Tm.prototype.isPlane=!0;const Em=new Sp,Cm=new np;class Am{constructor(t=new Tm,e=new Tm,n=new Tm,i=new Tm,r=new Tm,o=new Tm){this.planes=[t,e,n,i,r,o]}set(t,e,n,i,r,o){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],x=n[15];return e[0].setComponents(a-i,u-s,f-h,x-m).normalize(),e[1].setComponents(a+i,u+s,f+h,x+m).normalize(),e[2].setComponents(a+r,u+l,f+d,x+g).normalize(),e[3].setComponents(a-r,u-l,f-d,x-g).normalize(),e[4].setComponents(a-o,u-c,f-p,x-v).normalize(),e[5].setComponents(a+o,u+c,f+p,x+v).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Em.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Em)}intersectsSprite(t){return Em.center.set(0,0,0),Em.radius=.7071067811865476,Em.applyMatrix4(t.matrixWorld),this.intersectsSphere(Em)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let r=0;r<6;r++){const t=e[r].distanceToPoint(n);if(t<i)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(Cm.x=i.normal.x>0?t.max.x:t.min.x,Cm.y=i.normal.y>0?t.max.y:t.min.y,Cm.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(Cm)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Lm(){let t=null,e=!1,n=null,i=null;function r(e,o){n(e,o),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Rm(t,e){const n=e.isWebGL2,i=new WeakMap;function r(e,i){const r=e.array,o=e.usage,a=t.createBuffer();t.bindBuffer(i,a),t.bufferData(i,r,o),e.onUploadCallback();let s=5126;return r instanceof Float32Array?s=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?e.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:r instanceof Int16Array?s=5122:r instanceof Uint32Array?s=5125:r instanceof Int32Array?s=5124:r instanceof Int8Array?s=5120:(r instanceof Uint8Array||r instanceof Uint8ClampedArray)&&(s=5121),{buffer:a,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}function o(e,i,r){const o=i.array,a=i.updateRange;t.bindBuffer(r,e),-1===a.count?t.bufferSubData(r,0,o):(n?t.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}function a(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)}function s(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=i.get(e);n&&(t.deleteBuffer(n.buffer),i.delete(e))}function l(t,e){if(t.isGLBufferAttribute){const e=i.get(t);return void((!e||e.version<t.version)&&i.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const n=i.get(t);void 0===n?i.set(t,r(t,e)):n.version<t.version&&(o(n.buffer,t,e),n.version=t.version)}return{get:a,remove:s,update:l}}class Pm extends Bf{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,o=e/2,a=Math.floor(n),s=Math.floor(i),l=a+1,c=s+1,u=t/a,h=e/s,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){const t=g*h-o;for(let e=0;e<l;e++){const n=e*u-r;p.push(n,-t,0),f.push(0,0,1),m.push(e/a),m.push(1-g/s)}}for(let g=0;g<s;g++)for(let t=0;t<a;t++){const e=t+l*g,n=t+l*(g+1),i=t+1+l*(g+1),r=t+1+l*g;d.push(e,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new Df(p,3)),this.setAttribute("normal",new Df(f,3)),this.setAttribute("uv",new Df(m,2))}static fromJSON(t){return new Pm(t.width,t.height,t.widthSegments,t.heightSegments)}}var Nm="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",Dm="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",km="#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",Im="#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",Om="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",Fm="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",Um="vec3 transformed = vec3( position );",zm="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",Hm="vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",Bm="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",Vm="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",Gm="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",Wm="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",jm="#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",qm="#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",Xm="#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",Ym="#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",$m="#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",Zm="#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",Jm="#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",Km="vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",Qm="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",tg="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",eg="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",ng="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",ig="gl_FragColor = linearToOutputTexel( gl_FragColor );",rg="vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",og="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",ag="#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",sg="#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",lg="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",cg="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",ug="#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",hg="#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",dg="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",pg="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",fg="#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",mg="#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",gg="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",vg="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",xg="uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",yg="#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",_g="ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",bg="varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",wg="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",Mg="varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",Sg="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= specularColorMapTexelToLinear( texture2D( specularColorMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= sheenColorMapTexelToLinear( texture2D( sheenColorMap, vUv ) ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",Tg="struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",Eg="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",Cg="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",Ag="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",Lg="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",Rg="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",Pg="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",Ng="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",Dg="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",kg="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",Ig="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",Og="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",Fg="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",Ug="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",zg="#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",Hg="#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",Bg="#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",Vg="float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",Gg="#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",Wg="#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",jg="#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",qg="#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",Xg="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",Yg="#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",$g="#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",Zg="#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",Jg="#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",Kg="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",Qg="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",tv="vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",ev="#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",nv="#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",iv="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",rv="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",ov="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",av="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",sv="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",lv="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",cv="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",uv="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",hv="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",dv="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",pv="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",fv="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",mv="#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",gv="#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",vv="#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",xv="#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",yv="#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",_v="#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",bv="#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",wv="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",Mv="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",Sv="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",Tv="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif";const Ev="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",Cv="uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",Av="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",Lv="#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",Rv="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",Pv="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",Nv="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",Dv="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",kv="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",Iv="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",Ov="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",Fv="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",Uv="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",zv="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Hv="#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Bv="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Vv="#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",Gv="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Wv="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",jv="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",qv="#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Xv="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Yv="#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",$v="#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Zv="#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Jv="#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Kv="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",Qv="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",tx="#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",ex="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",nx="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",ix="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",rx={alphamap_fragment:Nm,alphamap_pars_fragment:Dm,alphatest_fragment:km,alphatest_pars_fragment:Im,aomap_fragment:Om,aomap_pars_fragment:Fm,begin_vertex:Um,beginnormal_vertex:zm,bsdfs:Hm,bumpmap_pars_fragment:Bm,clipping_planes_fragment:Vm,clipping_planes_pars_fragment:Gm,clipping_planes_pars_vertex:Wm,clipping_planes_vertex:jm,color_fragment:qm,color_pars_fragment:Xm,color_pars_vertex:Ym,color_vertex:$m,common:Zm,cube_uv_reflection_fragment:Jm,defaultnormal_vertex:Km,displacementmap_pars_vertex:Qm,displacementmap_vertex:tg,emissivemap_fragment:eg,emissivemap_pars_fragment:ng,encodings_fragment:ig,encodings_pars_fragment:rg,envmap_fragment:og,envmap_common_pars_fragment:ag,envmap_pars_fragment:sg,envmap_pars_vertex:lg,envmap_physical_pars_fragment:yg,envmap_vertex:cg,fog_vertex:ug,fog_pars_vertex:hg,fog_fragment:dg,fog_pars_fragment:pg,gradientmap_pars_fragment:fg,lightmap_fragment:mg,lightmap_pars_fragment:gg,lights_lambert_vertex:vg,lights_pars_begin:xg,lights_toon_fragment:_g,lights_toon_pars_fragment:bg,lights_phong_fragment:wg,lights_phong_pars_fragment:Mg,lights_physical_fragment:Sg,lights_physical_pars_fragment:Tg,lights_fragment_begin:Eg,lights_fragment_maps:Cg,lights_fragment_end:Ag,logdepthbuf_fragment:Lg,logdepthbuf_pars_fragment:Rg,logdepthbuf_pars_vertex:Pg,logdepthbuf_vertex:Ng,map_fragment:Dg,map_pars_fragment:kg,map_particle_fragment:Ig,map_particle_pars_fragment:Og,metalnessmap_fragment:Fg,metalnessmap_pars_fragment:Ug,morphnormal_vertex:zg,morphtarget_pars_vertex:Hg,morphtarget_vertex:Bg,normal_fragment_begin:Vg,normal_fragment_maps:Gg,normal_pars_fragment:Wg,normal_pars_vertex:jg,normal_vertex:qg,normalmap_pars_fragment:Xg,clearcoat_normal_fragment_begin:Yg,clearcoat_normal_fragment_maps:$g,clearcoat_pars_fragment:Zg,output_fragment:Jg,packing:Kg,premultiplied_alpha_fragment:Qg,project_vertex:tv,dithering_fragment:ev,dithering_pars_fragment:nv,roughnessmap_fragment:iv,roughnessmap_pars_fragment:rv,shadowmap_pars_fragment:ov,shadowmap_pars_vertex:av,shadowmap_vertex:sv,shadowmask_pars_fragment:lv,skinbase_vertex:cv,skinning_pars_vertex:uv,skinning_vertex:hv,skinnormal_vertex:dv,specularmap_fragment:pv,specularmap_pars_fragment:fv,tonemapping_fragment:mv,tonemapping_pars_fragment:gv,transmission_fragment:vv,transmission_pars_fragment:xv,uv_pars_fragment:yv,uv_pars_vertex:_v,uv_vertex:bv,uv2_pars_fragment:wv,uv2_pars_vertex:Mv,uv2_vertex:Sv,worldpos_vertex:Tv,background_vert:Ev,background_frag:Cv,cube_vert:Av,cube_frag:Lv,depth_vert:Rv,depth_frag:Pv,distanceRGBA_vert:Nv,distanceRGBA_frag:Dv,equirect_vert:kv,equirect_frag:Iv,linedashed_vert:Ov,linedashed_frag:Fv,meshbasic_vert:Uv,meshbasic_frag:zv,meshlambert_vert:Hv,meshlambert_frag:Bv,meshmatcap_vert:Vv,meshmatcap_frag:Gv,meshnormal_vert:Wv,meshnormal_frag:jv,meshphong_vert:qv,meshphong_frag:Xv,meshphysical_vert:Yv,meshphysical_frag:$v,meshtoon_vert:Zv,meshtoon_frag:Jv,points_vert:Kv,points_frag:Qv,shadow_vert:tx,shadow_frag:ex,sprite_vert:nx,sprite_frag:ix},ox={common:{diffuse:{value:new Tf(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Gd},uv2Transform:{value:new Gd},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vd(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Tf(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Tf(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Gd}},sprite:{diffuse:{value:new Tf(16777215)},opacity:{value:1},center:{value:new Vd(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Gd}}},ax={basic:{uniforms:um([ox.common,ox.specularmap,ox.envmap,ox.aomap,ox.lightmap,ox.fog]),vertexShader:rx.meshbasic_vert,fragmentShader:rx.meshbasic_frag},lambert:{uniforms:um([ox.common,ox.specularmap,ox.envmap,ox.aomap,ox.lightmap,ox.emissivemap,ox.fog,ox.lights,{emissive:{value:new Tf(0)}}]),vertexShader:rx.meshlambert_vert,fragmentShader:rx.meshlambert_frag},phong:{uniforms:um([ox.common,ox.specularmap,ox.envmap,ox.aomap,ox.lightmap,ox.emissivemap,ox.bumpmap,ox.normalmap,ox.displacementmap,ox.fog,ox.lights,{emissive:{value:new Tf(0)},specular:{value:new Tf(1118481)},shininess:{value:30}}]),vertexShader:rx.meshphong_vert,fragmentShader:rx.meshphong_frag},standard:{uniforms:um([ox.common,ox.envmap,ox.aomap,ox.lightmap,ox.emissivemap,ox.bumpmap,ox.normalmap,ox.displacementmap,ox.roughnessmap,ox.metalnessmap,ox.fog,ox.lights,{emissive:{value:new Tf(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:rx.meshphysical_vert,fragmentShader:rx.meshphysical_frag},toon:{uniforms:um([ox.common,ox.aomap,ox.lightmap,ox.emissivemap,ox.bumpmap,ox.normalmap,ox.displacementmap,ox.gradientmap,ox.fog,ox.lights,{emissive:{value:new Tf(0)}}]),vertexShader:rx.meshtoon_vert,fragmentShader:rx.meshtoon_frag},matcap:{uniforms:um([ox.common,ox.bumpmap,ox.normalmap,ox.displacementmap,ox.fog,{matcap:{value:null}}]),vertexShader:rx.meshmatcap_vert,fragmentShader:rx.meshmatcap_frag},points:{uniforms:um([ox.points,ox.fog]),vertexShader:rx.points_vert,fragmentShader:rx.points_frag},dashed:{uniforms:um([ox.common,ox.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:rx.linedashed_vert,fragmentShader:rx.linedashed_frag},depth:{uniforms:um([ox.common,ox.displacementmap]),vertexShader:rx.depth_vert,fragmentShader:rx.depth_frag},normal:{uniforms:um([ox.common,ox.bumpmap,ox.normalmap,ox.displacementmap,{opacity:{value:1}}]),vertexShader:rx.meshnormal_vert,fragmentShader:rx.meshnormal_frag},sprite:{uniforms:um([ox.sprite,ox.fog]),vertexShader:rx.sprite_vert,fragmentShader:rx.sprite_frag},background:{uniforms:{uvTransform:{value:new Gd},t2D:{value:null}},vertexShader:rx.background_vert,fragmentShader:rx.background_frag},cube:{uniforms:um([ox.envmap,{opacity:{value:1}}]),vertexShader:rx.cube_vert,fragmentShader:rx.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:rx.equirect_vert,fragmentShader:rx.equirect_frag},distanceRGBA:{uniforms:um([ox.common,ox.displacementmap,{referencePosition:{value:new np},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:rx.distanceRGBA_vert,fragmentShader:rx.distanceRGBA_frag},shadow:{uniforms:um([ox.lights,ox.fog,{color:{value:new Tf(0)},opacity:{value:1}}]),vertexShader:rx.shadow_vert,fragmentShader:rx.shadow_frag}};function sx(t,e,n,i,r){const o=new Tf(0);let a,s,l=0,c=null,u=0,h=null;function d(n,r){let d=!1,f=!0===r.isScene?r.background:null;f&&f.isTexture&&(f=e.get(f));const m=t.xr,g=m.getSession&&m.getSession();g&&"additive"===g.environmentBlendMode&&(f=null),null===f?p(o,l):f&&f.isColor&&(p(f,1),d=!0),(t.autoClear||d)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),f&&(f.isCubeTexture||f.mapping===Mu)?(void 0===s&&(s=new om(new lm(1,1,1),new fm({name:"BackgroundCubeMaterial",uniforms:cm(ax.cube.uniforms),vertexShader:ax.cube.vertexShader,fragmentShader:ax.cube.fragmentShader,side:Rc,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),s.geometry.deleteAttribute("uv"),s.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(s.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(s)),s.material.uniforms.envMap.value=f,s.material.uniforms.flipEnvMap.value=f.isCubeTexture&&!1===f.isRenderTargetTexture?-1:1,c===f&&u===f.version&&h===t.toneMapping||(s.material.needsUpdate=!0,c=f,u=f.version,h=t.toneMapping),n.unshift(s,s.geometry,s.material,0,0,null)):f&&f.isTexture&&(void 0===a&&(a=new om(new Pm(2,2),new fm({name:"BackgroundMaterial",uniforms:cm(ax.background.uniforms),vertexShader:ax.background.vertexShader,fragmentShader:ax.background.fragmentShader,side:Lc,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=f,!0===f.matrixAutoUpdate&&f.updateMatrix(),a.material.uniforms.uvTransform.value.copy(f.matrix),c===f&&u===f.version&&h===t.toneMapping||(a.material.needsUpdate=!0,c=f,u=f.version,h=t.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}function p(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,r)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),l=e,p(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(t){l=t,p(o,l)},render:d}}function lx(t,e,n,i){const r=t.getParameter(34921),o=i.isWebGL2?null:e.get("OES_vertex_array_object"),a=i.isWebGL2||null!==o,s={},l=m(null);let c=l;function u(e,i,r,o,s){let l=!1;if(a){const t=f(o,r,i);c!==t&&(c=t,d(c.object)),l=g(o,s),l&&v(o,s)}else{const t=!0===i.wireframe;c.geometry===o.id&&c.program===r.id&&c.wireframe===t||(c.geometry=o.id,c.program=r.id,c.wireframe=t,l=!0)}!0===e.isInstancedMesh&&(l=!0),null!==s&&n.update(s,34963),l&&(M(e,i,r,o),null!==s&&t.bindBuffer(34963,n.get(s).buffer))}function h(){return i.isWebGL2?t.createVertexArray():o.createVertexArrayOES()}function d(e){return i.isWebGL2?t.bindVertexArray(e):o.bindVertexArrayOES(e)}function p(e){return i.isWebGL2?t.deleteVertexArray(e):o.deleteVertexArrayOES(e)}function f(t,e,n){const i=!0===n.wireframe;let r=s[t.id];void 0===r&&(r={},s[t.id]=r);let o=r[e.id];void 0===o&&(o={},r[e.id]=o);let a=o[i];return void 0===a&&(a=m(h()),o[i]=a),a}function m(t){const e=[],n=[],i=[];for(let o=0;o<r;o++)e[o]=0,n[o]=0,i[o]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:i,object:t,attributes:{},index:null}}function g(t,e){const n=c.attributes,i=t.attributes;let r=0;for(const o in i){const t=n[o],e=i[o];if(void 0===t)return!0;if(t.attribute!==e)return!0;if(t.data!==e.data)return!0;r++}return c.attributesNum!==r||c.index!==e}function v(t,e){const n={},i=t.attributes;let r=0;for(const o in i){const t=i[o],e={};e.attribute=t,t.data&&(e.data=t.data),n[o]=e,r++}c.attributes=n,c.attributesNum=r,c.index=e}function x(){const t=c.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function y(t){_(t,0)}function _(n,r){const o=c.newAttributes,a=c.enabledAttributes,s=c.attributeDivisors;if(o[n]=1,0===a[n]&&(t.enableVertexAttribArray(n),a[n]=1),s[n]!==r){const o=i.isWebGL2?t:e.get("ANGLE_instanced_arrays");o[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),s[n]=r}}function b(){const e=c.newAttributes,n=c.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function w(e,n,r,o,a,s){!0!==i.isWebGL2||5124!==r&&5125!==r?t.vertexAttribPointer(e,n,r,o,a,s):t.vertexAttribIPointer(e,n,r,a,s)}function M(r,o,a,s){if(!1===i.isWebGL2&&(r.isInstancedMesh||s.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;x();const l=s.attributes,c=a.getAttributes(),u=o.defaultAttributeValues;for(const e in c){const i=c[e];if(i.location>=0){let o=l[e];if(void 0===o&&("instanceMatrix"===e&&r.instanceMatrix&&(o=r.instanceMatrix),"instanceColor"===e&&r.instanceColor&&(o=r.instanceColor)),void 0!==o){const e=o.normalized,a=o.itemSize,l=n.get(o);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,l=n.stride,d=o.offset;if(n&&n.isInstancedInterleavedBuffer){for(let t=0;t<i.locationSize;t++)_(i.location+t,n.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let t=0;t<i.locationSize;t++)y(i.location+t);t.bindBuffer(34962,c);for(let t=0;t<i.locationSize;t++)w(i.location+t,a/i.locationSize,u,e,l*h,(d+a/i.locationSize*t)*h)}else{if(o.isInstancedBufferAttribute){for(let t=0;t<i.locationSize;t++)_(i.location+t,o.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let t=0;t<i.locationSize;t++)y(i.location+t);t.bindBuffer(34962,c);for(let t=0;t<i.locationSize;t++)w(i.location+t,a/i.locationSize,u,e,a*h,a/i.locationSize*t*h)}}else if(void 0!==u){const n=u[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(i.location,n);break;case 3:t.vertexAttrib3fv(i.location,n);break;case 4:t.vertexAttrib4fv(i.location,n);break;default:t.vertexAttrib1fv(i.location,n)}}}}b()}function S(){C();for(const t in s){const e=s[t];for(const t in e){const n=e[t];for(const t in n)p(n[t].object),delete n[t];delete e[t]}delete s[t]}}function T(t){if(void 0===s[t.id])return;const e=s[t.id];for(const n in e){const t=e[n];for(const e in t)p(t[e].object),delete t[e];delete e[n]}delete s[t.id]}function E(t){for(const e in s){const n=s[e];if(void 0===n[t.id])continue;const i=n[t.id];for(const t in i)p(i[t].object),delete i[t];delete n[t.id]}}function C(){A(),c!==l&&(c=l,d(c.object))}function A(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:C,resetDefaultState:A,dispose:S,releaseStatesOfGeometry:T,releaseStatesOfProgram:E,initAttributes:x,enableAttribute:y,disableUnusedAttributes:b}}function cx(t,e,n,i){const r=i.isWebGL2;let o;function a(t){o=t}function s(e,i){t.drawArrays(o,e,i),n.update(i,o,1)}function l(i,a,s){if(0===s)return;let l,c;if(r)l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](o,i,a,s),n.update(a,o,s)}this.setMode=a,this.render=s,this.renderInstances=l}function ux(t,e,n){let i;function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a="undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let s=void 0!==n.precision?n.precision:"highp";const l=o(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);const c=a||e.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,h=t.getParameter(34930),d=t.getParameter(35660),p=t.getParameter(3379),f=t.getParameter(34076),m=t.getParameter(34921),g=t.getParameter(36347),v=t.getParameter(36348),x=t.getParameter(36349),y=d>0,_=a||e.has("OES_texture_float"),b=y&&_,w=a?t.getParameter(36183):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:o,precision:s,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:x,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:b,maxSamples:w}}function hx(t){const e=this;let n=null,i=0,r=!1,o=!1;const a=new Tm,s=new Gd,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(t,n,i,r){const o=null!==t?t.length:0;let c=null;if(0!==o){if(c=l.value,!0!==r||null===c){const e=i+4*o,r=n.matrixWorldInverse;s.getNormalMatrix(r),(null===c||c.length<e)&&(c=new Float32Array(e));for(let n=0,l=i;n!==o;++n,l+=4)a.copy(t[n]).applyMatrix4(r,s),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=o,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,o){const a=0!==t.length||e||0!==i||r;return r=e,n=u(t,o,0),i=t.length,a},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,c()},this.setState=function(e,a,s){const h=e.clippingPlanes,d=e.clipIntersection,p=e.clipShadows,f=t.get(e);if(!r||null===h||0===h.length||o&&!p)o?u(null):c();else{const t=o?0:i,e=4*t;let r=f.clippingState||null;l.value=r,r=u(h,a,e,s);for(let i=0;i!==e;++i)r[i]=n[i];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function dx(t){let e=new WeakMap;function n(t,e){return e===bu?t.mapping=yu:e===wu&&(t.mapping=_u),t}function i(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const o=i.mapping;if(o===bu||o===wu){if(e.has(i)){const t=e.get(i).texture;return n(t,i.mapping)}{const o=i.image;if(o&&o.height>0){const a=t.getRenderTarget(),s=new bm(o.height/2);return s.fromEquirectangularTexture(t,i),e.set(i,s),t.setRenderTarget(a),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}}return i}function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}ax.physical={uniforms:um([ax.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Vd(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Tf(0)},sheenColorMap:{value:null},sheenRoughness:{value:0},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Vd},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Tf(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularColor:{value:new Tf(1,1,1)},specularColorMap:{value:null}}]),vertexShader:rx.meshphysical_vert,fragmentShader:rx.meshphysical_frag};class px extends mm{constructor(t=-1,e=1,n=1,i=-1,r=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,o=n+t,a=i+e,s=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,o=r+t*this.view.width,a-=e*this.view.offsetY,s=a-e*this.view.height}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}px.prototype.isOrthographicCamera=!0;class fx extends fm{constructor(t){super(t),this.type="RawShaderMaterial"}}fx.prototype.isRawShaderMaterial=!0;const mx=4,gx=8,vx=Math.pow(2,gx),xx=[.125,.215,.35,.446,.526,.582],yx=gx-mx+1+xx.length,_x=20,bx={[od]:0,[ad]:1},wx=new px,{_lodPlanes:Mx,_sizeLods:Sx,_sigmas:Tx}=Nx(),Ex=new Tf;let Cx=null;const Ax=(1+Math.sqrt(5))/2,Lx=1/Ax,Rx=[new np(1,1,1),new np(-1,1,1),new np(1,1,-1),new np(-1,1,-1),new np(0,Ax,Lx),new np(0,Ax,-Lx),new np(Lx,0,Ax),new np(-Lx,0,Ax),new np(Ax,Lx,0),new np(-Ax,Lx,0)];class Px{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=Ix(_x),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){Cx=this._renderer.getRenderTarget();const r=this._allocateTargets();return this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t){return this._fromTexture(t)}fromCubemap(t){return this._fromTexture(t)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=Fx(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=Ox(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<Mx.length;t++)Mx[t].dispose()}_cleanup(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Cx),t.scissorTest=!1,kx(t,0,0,t.width,t.height)}_fromTexture(t){Cx=this._renderer.getRenderTarget();const e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e}_allocateTargets(t){const e={magFilter:Pu,minFilter:Pu,generateMipmaps:!1,type:Bu,format:Yu,encoding:od,depthBuffer:!1},n=Dx(e);return n.depthBuffer=!t,this._pingPongRenderTarget=Dx(e),n}_compileMaterial(t){const e=new om(Mx[0],t);this._renderer.compile(e,wx)}_sceneToCubeUV(t,e,n,i){const r=90,o=1,a=new gm(r,o,e,n),s=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],c=this._renderer,u=c.autoClear,h=c.toneMapping;c.getClearColor(Ex),c.toneMapping=du,c.autoClear=!1;const d=new Ef({name:"PMREM.Background",side:Rc,depthWrite:!1,depthTest:!1}),p=new om(new lm,d);let f=!1;const m=t.background;m?m.isColor&&(d.color.copy(m),t.background=null,f=!0):(d.color.copy(Ex),f=!0);for(let g=0;g<6;g++){const e=g%3;0==e?(a.up.set(0,s[g],0),a.lookAt(l[g],0,0)):1==e?(a.up.set(0,0,s[g]),a.lookAt(0,l[g],0)):(a.up.set(0,s[g],0),a.lookAt(0,0,l[g])),kx(i,e*vx,g>2?vx:0,vx,vx),c.setRenderTarget(i),f&&c.render(p,a),c.render(t,a)}p.geometry.dispose(),p.material.dispose(),c.toneMapping=h,c.autoClear=u,t.background=m}_setEncoding(t,e){!0===this._renderer.capabilities.isWebGL2&&e.format===Yu&&e.type===ku&&e.encoding===ad?t.value=bx[od]:t.value=bx[e.encoding]}_textureToCubeUV(t,e){const n=this._renderer,i=t.mapping===yu||t.mapping===_u;i?null==this._cubemapShader&&(this._cubemapShader=Fx()):null==this._equirectShader&&(this._equirectShader=Ox());const r=i?this._cubemapShader:this._equirectShader,o=new om(Mx[0],r),a=r.uniforms;a["envMap"].value=t,i||a["texelSize"].value.set(1/t.image.width,1/t.image.height),this._setEncoding(a["inputEncoding"],t),kx(e,0,0,3*vx,2*vx),n.setRenderTarget(e),n.render(o,wx)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let i=1;i<yx;i++){const e=Math.sqrt(Tx[i]*Tx[i]-Tx[i-1]*Tx[i-1]),n=Rx[(i-1)%Rx.length];this._blur(t,i-1,i,e,n)}e.autoClear=n}_blur(t,e,n,i,r){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,i,"latitudinal",r),this._halfBlur(o,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,o,a){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,u=new om(Mx[i],l),h=l.uniforms,d=Sx[n]-1,p=isFinite(r)?Math.PI/(2*d):2*Math.PI/(2*_x-1),f=r/p,m=isFinite(r)?1+Math.floor(c*f):_x;m>_x&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${_x}`);const g=[];let v=0;for(let b=0;b<_x;++b){const t=b/f,e=Math.exp(-t*t/2);g.push(e),0==b?v+=e:b<m&&(v+=2*e)}for(let b=0;b<g.length;b++)g[b]=g[b]/v;h["envMap"].value=t.texture,h["samples"].value=m,h["weights"].value=g,h["latitudinal"].value="latitudinal"===o,a&&(h["poleAxis"].value=a),h["dTheta"].value=p,h["mipInt"].value=gx-n;const x=Sx[i],y=3*Math.max(0,vx-2*x),_=(0===i?0:2*vx)+2*x*(i>gx-mx?i-gx+mx:0);kx(e,y,_,3*x,2*x),s.setRenderTarget(e),s.render(u,wx)}}function Nx(){const t=[],e=[],n=[];let i=gx;for(let r=0;r<yx;r++){const o=Math.pow(2,i);e.push(o);let a=1/o;r>gx-mx?a=xx[r-gx+mx-1]:0==r&&(a=0),n.push(a);const s=1/(o-1),l=-s/2,c=1+s/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=6,d=6,p=3,f=2,m=1,g=new Float32Array(p*d*h),v=new Float32Array(f*d*h),x=new Float32Array(m*d*h);for(let t=0;t<h;t++){const e=t%3*2/3-1,n=t>2?0:-1,i=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];g.set(i,p*d*t),v.set(u,f*d*t);const r=[t,t,t,t,t,t];x.set(r,m*d*t)}const y=new Bf;y.setAttribute("position",new Lf(g,p)),y.setAttribute("uv",new Lf(v,f)),y.setAttribute("faceIndex",new Lf(x,m)),t.push(y),i>mx&&i--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}function Dx(t){const e=new Kd(3*vx,3*vx,t);return e.texture.mapping=Mu,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function kx(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function Ix(t){const e=new Float32Array(t),n=new np(0,1,0),i=new fx({name:"SphericalGaussianBlur",defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:Ux(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t${zx()}\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t`,blending:Dc,depthTest:!1,depthWrite:!1});return i}function Ox(){const t=new Vd(1,1),e=new fx({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:t},inputEncoding:{value:bx[od]}},vertexShader:Ux(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t${zx()}\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t`,blending:Dc,depthTest:!1,depthWrite:!1});return e}function Fx(){const t=new fx({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:bx[od]}},vertexShader:Ux(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t${zx()}\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) );\n\n\t\t\t}\n\t\t`,blending:Dc,depthTest:!1,depthWrite:!1});return t}function Ux(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function zx(){return"\n\n\t\tuniform int inputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t"}function Hx(t){let e=new WeakMap,n=null;function i(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const a=i.mapping,s=a===bu||a===wu,l=a===yu||a===_u;if(s||l){if(e.has(i))return e.get(i).texture;{const a=i.image;if(s&&a&&a.height>0||l&&a&&r(a)){const r=t.getRenderTarget();null===n&&(n=new Px(t));const a=s?n.fromEquirectangular(i):n.fromCubemap(i);return e.set(i,a),t.setRenderTarget(r),i.addEventListener("dispose",o),a.texture}return null}}}return i}function r(t){let e=0;const n=6;for(let i=0;i<n;i++)void 0!==t[i]&&e++;return e===n}function o(t){const n=t.target;n.removeEventListener("dispose",o);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}function a(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}return{get:i,dispose:a}}function Bx(t){const e={};function n(n){if(void 0!==e[n])return e[n];let i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(t){const e=n(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function Vx(t,e,n,i){const r={},o=new WeakMap;function a(t){const s=t.target;null!==s.index&&e.remove(s.index);for(const n in s.attributes)e.remove(s.attributes[n]);s.removeEventListener("dispose",a),delete r[s.id];const l=o.get(s);l&&(e.remove(l),o.delete(s)),i.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(t,e){return!0===r[e.id]||(e.addEventListener("dispose",a),r[e.id]=!0,n.memory.geometries++),e}function l(t){const n=t.attributes;for(const r in n)e.update(n[r],34962);const i=t.morphAttributes;for(const r in i){const t=i[r];for(let n=0,i=t.length;n<i;n++)e.update(t[n],34962)}}function c(t){const n=[],i=t.index,r=t.attributes.position;let a=0;if(null!==i){const t=i.array;a=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],r=t[e+1],o=t[e+2];n.push(i,r,r,o,o,i)}}else{const t=r.array;a=r.version;for(let e=0,i=t.length/3-1;e<i;e+=3){const t=e+0,i=e+1,r=e+2;n.push(t,i,i,r,r,t)}}const s=new(Wd(n)>65535?Pf:Rf)(n,1);s.version=a;const l=o.get(t);l&&e.remove(l),o.set(t,s)}function u(t){const e=o.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&c(t)}else c(t);return o.get(t)}return{get:s,update:l,getWireframeAttribute:u}}function Gx(t,e,n,i){const r=i.isWebGL2;let o,a,s;function l(t){o=t}function c(t){a=t.type,s=t.bytesPerElement}function u(e,i){t.drawElements(o,i,a,e*s),n.update(i,o,1)}function h(i,l,c){if(0===c)return;let u,h;if(r)u=t,h="drawElementsInstanced";else if(u=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](o,l,a,i*s,c),n.update(l,o,c)}this.setMode=l,this.setIndex=c,this.render=u,this.renderInstances=h}function Wx(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(t,e,i){switch(n.calls++,e){case 4:n.triangles+=i*(t/3);break;case 1:n.lines+=i*(t/2);break;case 3:n.lines+=i*(t-1);break;case 2:n.lines+=i*t;break;case 0:n.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",e);break}}function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}class jx extends $d{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=Au,this.minFilter=Au,this.wrapR=Eu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function qx(t,e){return t[0]-e[0]}function Xx(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Yx(t,e){let n=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?n=127:i instanceof Int16Array?n=32767:i instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),t.divideScalar(n)}function $x(t,e,n){const i={},r=new Float32Array(8),o=new WeakMap,a=new np,s=[];for(let c=0;c<8;c++)s[c]=[c,0];function l(l,c,u,h){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const i=c.morphAttributes.position.length;let r=o.get(c);if(void 0===r||r.count!==i){void 0!==r&&r.texture.dispose();const t=void 0!==c.morphAttributes.normal,n=c.morphAttributes.position,s=c.morphAttributes.normal||[],l=c.attributes.position.count,u=!0===t?2:1;let h=l*u,d=1;h>e.maxTextureSize&&(d=Math.ceil(h/e.maxTextureSize),h=e.maxTextureSize);const p=new Float32Array(h*d*4*i),f=new jx(p,h,d,i);f.format=Yu,f.type=Hu,f.needsUpdate=!0;const m=4*u;for(let e=0;e<i;e++){const i=n[e],r=s[e],o=h*d*4*e;for(let e=0;e<i.count;e++){a.fromBufferAttribute(i,e),!0===i.normalized&&Yx(a,i);const n=e*m;p[o+n+0]=a.x,p[o+n+1]=a.y,p[o+n+2]=a.z,p[o+n+3]=0,!0===t&&(a.fromBufferAttribute(r,e),!0===r.normalized&&Yx(a,r),p[o+n+4]=a.x,p[o+n+5]=a.y,p[o+n+6]=a.z,p[o+n+7]=0)}}r={count:i,texture:f,size:new Vd(h,d)},o.set(c,r)}let s=0;for(let t=0;t<d.length;t++)s+=d[t];const l=c.morphTargetsRelative?1:1-s;h.getUniforms().setValue(t,"morphTargetBaseInfluence",l),h.getUniforms().setValue(t,"morphTargetInfluences",d),h.getUniforms().setValue(t,"morphTargetsTexture",r.texture,n),h.getUniforms().setValue(t,"morphTargetsTextureSize",r.size)}else{const e=void 0===d?0:d.length;let n=i[c.id];if(void 0===n||n.length!==e){n=[];for(let t=0;t<e;t++)n[t]=[t,0];i[c.id]=n}for(let t=0;t<e;t++){const e=n[t];e[0]=t,e[1]=d[t]}n.sort(Xx);for(let t=0;t<8;t++)t<e&&n[t][1]?(s[t][0]=n[t][0],s[t][1]=n[t][1]):(s[t][0]=Number.MAX_SAFE_INTEGER,s[t][1]=0);s.sort(qx);const o=c.morphAttributes.position,a=c.morphAttributes.normal;let l=0;for(let t=0;t<8;t++){const e=s[t],n=e[0],i=e[1];n!==Number.MAX_SAFE_INTEGER&&i?(o&&c.getAttribute("morphTarget"+t)!==o[n]&&c.setAttribute("morphTarget"+t,o[n]),a&&c.getAttribute("morphNormal"+t)!==a[n]&&c.setAttribute("morphNormal"+t,a[n]),r[t]=i,l+=i):(o&&!0===c.hasAttribute("morphTarget"+t)&&c.deleteAttribute("morphTarget"+t),a&&!0===c.hasAttribute("morphNormal"+t)&&c.deleteAttribute("morphNormal"+t),r[t]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(t,"morphTargetBaseInfluence",u),h.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function Zx(t,e,n,i){let r=new WeakMap;function o(t){const o=i.render.frame,a=t.geometry,l=e.get(t,a);return r.get(l)!==o&&(e.update(l),r.set(l,o)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",s)&&t.addEventListener("dispose",s),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),l}function a(){r=new WeakMap}function s(t){const e=t.target;e.removeEventListener("dispose",s),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:o,dispose:a}}jx.prototype.isDataTexture2DArray=!0;class Jx extends $d{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=Au,this.minFilter=Au,this.wrapR=Eu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Jx.prototype.isDataTexture3D=!0;const Kx=new $d,Qx=new jx,ty=new Jx,ey=new _m,ny=[],iy=[],ry=new Float32Array(16),oy=new Float32Array(9),ay=new Float32Array(4);function sy(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let o=ny[r];if(void 0===o&&(o=new Float32Array(r),ny[r]=o),0!==e){i.toArray(o,0);for(let i=1,r=0;i!==e;++i)r+=n,t[i].toArray(o,r)}return o}function ly(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function cy(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function uy(t,e){let n=iy[e];void 0===n&&(n=new Int32Array(e),iy[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function hy(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function dy(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ly(n,e))return;t.uniform2fv(this.addr,e),cy(n,e)}}function py(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(ly(n,e))return;t.uniform3fv(this.addr,e),cy(n,e)}}function fy(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ly(n,e))return;t.uniform4fv(this.addr,e),cy(n,e)}}function my(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(ly(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),cy(n,e)}else{if(ly(n,i))return;ay.set(i),t.uniformMatrix2fv(this.addr,!1,ay),cy(n,i)}}function gy(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(ly(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),cy(n,e)}else{if(ly(n,i))return;oy.set(i),t.uniformMatrix3fv(this.addr,!1,oy),cy(n,i)}}function vy(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(ly(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),cy(n,e)}else{if(ly(n,i))return;ry.set(i),t.uniformMatrix4fv(this.addr,!1,ry),cy(n,i)}}function xy(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function yy(t,e){const n=this.cache;ly(n,e)||(t.uniform2iv(this.addr,e),cy(n,e))}function _y(t,e){const n=this.cache;ly(n,e)||(t.uniform3iv(this.addr,e),cy(n,e))}function by(t,e){const n=this.cache;ly(n,e)||(t.uniform4iv(this.addr,e),cy(n,e))}function wy(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function My(t,e){const n=this.cache;ly(n,e)||(t.uniform2uiv(this.addr,e),cy(n,e))}function Sy(t,e){const n=this.cache;ly(n,e)||(t.uniform3uiv(this.addr,e),cy(n,e))}function Ty(t,e){const n=this.cache;ly(n,e)||(t.uniform4uiv(this.addr,e),cy(n,e))}function Ey(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(e||Kx,r)}function Cy(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||ty,r)}function Ay(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(e||ey,r)}function Ly(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||Qx,r)}function Ry(t){switch(t){case 5126:return hy;case 35664:return dy;case 35665:return py;case 35666:return fy;case 35674:return my;case 35675:return gy;case 35676:return vy;case 5124:case 35670:return xy;case 35667:case 35671:return yy;case 35668:case 35672:return _y;case 35669:case 35673:return by;case 5125:return wy;case 36294:return My;case 36295:return Sy;case 36296:return Ty;case 35678:case 36198:case 36298:case 36306:case 35682:return Ey;case 35679:case 36299:case 36307:return Cy;case 35680:case 36300:case 36308:case 36293:return Ay;case 36289:case 36303:case 36311:case 36292:return Ly}}function Py(t,e){t.uniform1fv(this.addr,e)}function Ny(t,e){const n=sy(e,this.size,2);t.uniform2fv(this.addr,n)}function Dy(t,e){const n=sy(e,this.size,3);t.uniform3fv(this.addr,n)}function ky(t,e){const n=sy(e,this.size,4);t.uniform4fv(this.addr,n)}function Iy(t,e){const n=sy(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Oy(t,e){const n=sy(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Fy(t,e){const n=sy(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Uy(t,e){t.uniform1iv(this.addr,e)}function zy(t,e){t.uniform2iv(this.addr,e)}function Hy(t,e){t.uniform3iv(this.addr,e)}function By(t,e){t.uniform4iv(this.addr,e)}function Vy(t,e){t.uniform1uiv(this.addr,e)}function Gy(t,e){t.uniform2uiv(this.addr,e)}function Wy(t,e){t.uniform3uiv(this.addr,e)}function jy(t,e){t.uniform4uiv(this.addr,e)}function qy(t,e,n){const i=e.length,r=uy(n,i);t.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)n.safeSetTexture2D(e[o]||Kx,r[o])}function Xy(t,e,n){const i=e.length,r=uy(n,i);t.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)n.setTexture3D(e[o]||ty,r[o])}function Yy(t,e,n){const i=e.length,r=uy(n,i);t.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)n.safeSetTextureCube(e[o]||ey,r[o])}function $y(t,e,n){const i=e.length,r=uy(n,i);t.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)n.setTexture2DArray(e[o]||Qx,r[o])}function Zy(t){switch(t){case 5126:return Py;case 35664:return Ny;case 35665:return Dy;case 35666:return ky;case 35674:return Iy;case 35675:return Oy;case 35676:return Fy;case 5124:case 35670:return Uy;case 35667:case 35671:return zy;case 35668:case 35672:return Hy;case 35669:case 35673:return By;case 5125:return Vy;case 36294:return Gy;case 36295:return Wy;case 36296:return jy;case 35678:case 36198:case 36298:case 36306:case 35682:return qy;case 35679:case 36299:case 36307:return Xy;case 35680:case 36300:case 36308:case 36293:return Yy;case 36289:case 36303:case 36311:case 36292:return $y}}function Jy(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=Ry(e.type)}function Ky(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=Zy(e.type)}function Qy(t){this.id=t,this.seq=[],this.map={}}Ky.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),cy(e,t)},Qy.prototype.setValue=function(t,e,n){const i=this.seq;for(let r=0,o=i.length;r!==o;++r){const o=i[r];o.setValue(t,e[o.id],n)}};const t_=/(\w+)(\])?(\[|\.)?/g;function e_(t,e){t.seq.push(e),t.map[e.id]=e}function n_(t,e,n){const i=t.name,r=i.length;t_.lastIndex=0;while(1){const o=t_.exec(i),a=t_.lastIndex;let s=o[1];const l="]"===o[2],c=o[3];if(l&&(s|=0),void 0===c||"["===c&&a+2===r){e_(n,void 0===c?new Jy(s,t,e):new Ky(s,t,e));break}{const t=n.map;let e=t[s];void 0===e&&(e=new Qy(s),e_(n,e)),n=e}}}function i_(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){const n=t.getActiveUniform(e,i),r=t.getUniformLocation(e,n.name);n_(n,r,this)}}function r_(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}i_.prototype.setValue=function(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)},i_.prototype.setOptional=function(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)},i_.upload=function(t,e,n,i){for(let r=0,o=e.length;r!==o;++r){const o=e[r],a=n[o.id];!1!==a.needsUpdate&&o.setValue(t,a.value,i)}},i_.seqWithValue=function(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const r=t[i];r.id in e&&n.push(r)}return n};let o_=0;function a_(t){const e=t.split("\n");for(let n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}function s_(t){switch(t){case od:return["Linear","( value )"];case ad:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function l_(t,e,n){const i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();return i&&""===r?"":n.toUpperCase()+"\n\n"+r+"\n\n"+a_(t.getShaderSource(e))}function c_(t,e){const n=s_(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function u_(t,e){const n=s_(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function h_(t,e){let n;switch(e){case pu:n="Linear";break;case fu:n="Reinhard";break;case mu:n="OptimizedCineon";break;case gu:n="ACESFilmic";break;case vu:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function d_(t){const e=[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return e.filter(m_).join("\n")}function p_(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}function f_(t,e){const n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r),o=i.name;let a=1;35674===i.type&&(a=2),35675===i.type&&(a=3),35676===i.type&&(a=4),n[o]={type:i.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function m_(t){return""!==t}function g_(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function v_(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const x_=/^[ \t]*#include +<([\w\d./]+)>/gm;function y_(t){return t.replace(x_,__)}function __(t,e){const n=rx[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return y_(n)}const b_=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,w_=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function M_(t){return t.replace(w_,T_).replace(b_,S_)}function S_(t,e,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),T_(t,e,n,i)}function T_(t,e,n,i){let r="";for(let o=parseInt(e);o<parseInt(n);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function E_(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function C_(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===Ec?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===Cc?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Ac&&(e="SHADOWMAP_TYPE_VSM"),e}function A_(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case yu:case _u:e="ENVMAP_TYPE_CUBE";break;case Mu:case Su:e="ENVMAP_TYPE_CUBE_UV";break}return e}function L_(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case _u:case Su:e="ENVMAP_MODE_REFRACTION";break}return e}function R_(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case cu:e="ENVMAP_BLENDING_MULTIPLY";break;case uu:e="ENVMAP_BLENDING_MIX";break;case hu:e="ENVMAP_BLENDING_ADD";break}return e}function P_(t,e,n,i){const r=t.getContext(),o=n.defines;let a=n.vertexShader,s=n.fragmentShader;const l=C_(n),c=A_(n),u=L_(n),h=R_(n),d=n.isWebGL2?"":d_(n),p=p_(o),f=r.createProgram();let m,g,v=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(m=[p].filter(m_).join("\n"),m.length>0&&(m+="\n"),g=[d,p].filter(m_).join("\n"),g.length>0&&(g+="\n")):(m=[E_(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(m_).join("\n"),g=[d,E_(n),"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==du?"#define TONE_MAPPING":"",n.toneMapping!==du?rx["tonemapping_pars_fragment"]:"",n.toneMapping!==du?h_("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.format===Xu?"#define OPAQUE":"",rx["encodings_pars_fragment"],n.map?c_("mapTexelToLinear",n.mapEncoding):"",n.matcap?c_("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?c_("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?c_("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.specularColorMap?c_("specularColorMapTexelToLinear",n.specularColorMapEncoding):"",n.sheenColorMap?c_("sheenColorMapTexelToLinear",n.sheenColorMapEncoding):"",n.lightMap?c_("lightMapTexelToLinear",n.lightMapEncoding):"",u_("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(m_).join("\n")),a=y_(a),a=g_(a,n),a=v_(a,n),s=y_(s),s=g_(s,n),s=v_(s,n),a=M_(a),s=M_(s),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(v="#version 300 es\n",m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#define varying in",n.glslVersion===md?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===md?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const x=v+m+a,y=v+g+s,_=r_(r,35633,x),b=r_(r,35632,y);if(r.attachShader(f,_),r.attachShader(f,b),void 0!==n.index0AttributeName?r.bindAttribLocation(f,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(f,0,"position"),r.linkProgram(f),t.debug.checkShaderErrors){const t=r.getProgramInfoLog(f).trim(),e=r.getShaderInfoLog(_).trim(),n=r.getShaderInfoLog(b).trim();let i=!0,o=!0;if(!1===r.getProgramParameter(f,35714)){i=!1;const e=l_(r,_,"vertex"),n=l_(r,b,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(f,35715)+"\n\nProgram Info Log: "+t+"\n"+e+"\n"+n)}else""!==t?console.warn("THREE.WebGLProgram: Program Info Log:",t):""!==e&&""!==n||(o=!1);o&&(this.diagnostics={runnable:i,programLog:t,vertexShader:{log:e,prefix:m},fragmentShader:{log:n,prefix:g}})}let w,M;return r.deleteShader(_),r.deleteShader(b),this.getUniforms=function(){return void 0===w&&(w=new i_(r,f)),w},this.getAttributes=function(){return void 0===M&&(M=f_(r,f)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(f),this.program=void 0},this.name=n.shaderName,this.id=o_++,this.cacheKey=e,this.usedTimes=1,this.program=f,this.vertexShader=_,this.fragmentShader=b,this}let N_=0;class D_{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),r=this._getShaderStage(n),o=this._getShaderCacheForMaterial(t);return!1===o.has(i)&&(o.add(i),i.usedTimes++),!1===o.has(r)&&(o.add(r),r.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;return!1===e.has(t)&&e.set(t,new Set),e.get(t)}_getShaderStage(t){const e=this.shaderCache;if(!1===e.has(t)){const n=new k_;e.set(t,n)}return e.get(t)}}class k_{constructor(){this.id=N_++,this.usedTimes=0}}function I_(t,e,n,i,r,o,a){const s=new Wp,l=new D_,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.floatVertexTextures,p=r.maxVertexUniforms,f=r.vertexTextures;let m=r.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(t){const e=t.skeleton,n=e.bones;if(d)return 1024;{const t=p,e=Math.floor((t-20)/4),i=Math.min(e,n.length);return i<n.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+n.length+" bones. This GPU supports "+i+"."),0):i}}function x(t){let e;return t&&t.isTexture?e=t.encoding:t&&t.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=od,u&&t&&t.isTexture&&t.format===Yu&&t.type===ku&&t.encoding===ad&&(e=od),e}function y(o,s,c,p,y){const _=p.fog,b=o.isMeshStandardMaterial?p.environment:null,w=(o.isMeshStandardMaterial?n:e).get(o.envMap||b),M=g[o.type],S=y.isSkinnedMesh?v(y):0;let T,E,C,A;if(null!==o.precision&&(m=r.getMaxPrecision(o.precision),m!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",m,"instead.")),M){const t=ax[M];T=t.vertexShader,E=t.fragmentShader}else T=o.vertexShader,E=o.fragmentShader,l.update(o),C=l.getVertexShaderID(o),A=l.getFragmentShaderID(o);const L=t.getRenderTarget(),R=o.alphaTest>0,P=o.clearcoat>0,N={isWebGL2:u,shaderID:M,shaderName:o.type,vertexShader:T,fragmentShader:E,defines:o.defines,customVertexShaderID:C,customFragmentShaderID:A,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:m,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:f,outputEncoding:null!==L?x(L.texture):t.outputEncoding,map:!!o.map,mapEncoding:x(o.map),matcap:!!o.matcap,matcapEncoding:x(o.matcap),envMap:!!w,envMapMode:w&&w.mapping,envMapEncoding:x(w),envMapCubeUV:!!w&&(w.mapping===Mu||w.mapping===Su),lightMap:!!o.lightMap,lightMapEncoding:x(o.lightMap),aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,emissiveMapEncoding:x(o.emissiveMap),bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:o.normalMapType===ud,tangentSpaceNormalMap:o.normalMapType===cd,clearcoat:P,clearcoatMap:P&&!!o.clearcoatMap,clearcoatRoughnessMap:P&&!!o.clearcoatRoughnessMap,clearcoatNormalMap:P&&!!o.clearcoatNormalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,specularIntensityMap:!!o.specularIntensityMap,specularColorMap:!!o.specularColorMap,specularColorMapEncoding:x(o.specularColorMap),alphaMap:!!o.alphaMap,alphaTest:R,gradientMap:!!o.gradientMap,sheen:o.sheen>0,sheenColorMap:!!o.sheenColorMap,sheenColorMapEncoding:x(o.sheenColorMap),sheenRoughnessMap:!!o.sheenRoughnessMap,transmission:o.transmission>0,transmissionMap:!!o.transmissionMap,thicknessMap:!!o.thicknessMap,combine:o.combine,vertexTangents:!!o.normalMap&&!!y.geometry&&!!y.geometry.attributes.tangent,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!y.geometry&&!!y.geometry.attributes.color&&4===y.geometry.attributes.color.itemSize,vertexUvs:!!o.map||!!o.bumpMap||!!o.normalMap||!!o.specularMap||!!o.alphaMap||!!o.emissiveMap||!!o.roughnessMap||!!o.metalnessMap||!!o.clearcoatMap||!!o.clearcoatRoughnessMap||!!o.clearcoatNormalMap||!!o.displacementMap||!!o.transmissionMap||!!o.thicknessMap||!!o.specularIntensityMap||!!o.specularColorMap||!!o.sheenColorMap||!!o.sheenRoughnessMap,uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.transmission>0||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheen>0||o.sheenColorMap||o.sheenRoughnessMap)&&!!o.displacementMap,fog:!!_,useFog:o.fog,fogExp2:_&&_.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===y.isSkinnedMesh&&S>0,maxBones:S,useVertexTexture:d,morphTargets:!!y.geometry&&!!y.geometry.morphAttributes.position,morphNormals:!!y.geometry&&!!y.geometry.morphAttributes.normal,morphTargetsCount:y.geometry&&y.geometry.morphAttributes.position?y.geometry.morphAttributes.position.length:0,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,format:o.format,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.length>0,shadowMapType:t.shadowMap.type,toneMapping:o.toneMapped?t.toneMapping:du,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===Pc,flipSided:o.side===Rc,depthPacking:void 0!==o.depthPacking&&o.depthPacking,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()};return N}function _(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(b(n,e),w(n,e),n.push(t.outputEncoding)),n.push(e.customProgramCacheKey),n.join()}function b(t,e){t.push(e.precision),t.push(e.outputEncoding),t.push(e.mapEncoding),t.push(e.matcapEncoding),t.push(e.envMapMode),t.push(e.envMapEncoding),t.push(e.lightMapEncoding),t.push(e.emissiveMapEncoding),t.push(e.combine),t.push(e.vertexUvs),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.maxBones),t.push(e.morphTargetsCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.format),t.push(e.specularColorMapEncoding),t.push(e.sheenColorMapEncoding)}function w(t,e){s.disableAll(),e.isWebGL2&&s.enable(0),e.supportsVertexTextures&&s.enable(1),e.instancing&&s.enable(2),e.instancingColor&&s.enable(3),e.map&&s.enable(4),e.matcap&&s.enable(5),e.envMap&&s.enable(6),e.envMapCubeUV&&s.enable(7),e.lightMap&&s.enable(8),e.aoMap&&s.enable(9),e.emissiveMap&&s.enable(10),e.bumpMap&&s.enable(11),e.normalMap&&s.enable(12),e.objectSpaceNormalMap&&s.enable(13),e.tangentSpaceNormalMap&&s.enable(14),e.clearcoat&&s.enable(15),e.clearcoatMap&&s.enable(16),e.clearcoatRoughnessMap&&s.enable(17),e.clearcoatNormalMap&&s.enable(18),e.displacementMap&&s.enable(19),e.specularMap&&s.enable(20),e.roughnessMap&&s.enable(21),e.metalnessMap&&s.enable(22),e.gradientMap&&s.enable(23),e.alphaMap&&s.enable(24),e.alphaTest&&s.enable(25),e.vertexColors&&s.enable(26),e.vertexAlphas&&s.enable(27),e.vertexUvs&&s.enable(28),e.vertexTangents&&s.enable(29),e.uvsVertexOnly&&s.enable(30),e.fog&&s.enable(31),t.push(s.mask),s.disableAll(),e.useFog&&s.enable(0),e.flatShading&&s.enable(1),e.logarithmicDepthBuffer&&s.enable(2),e.skinning&&s.enable(3),e.useVertexTexture&&s.enable(4),e.morphTargets&&s.enable(5),e.morphNormals&&s.enable(6),e.premultipliedAlpha&&s.enable(7),e.shadowMapEnabled&&s.enable(8),e.physicallyCorrectLights&&s.enable(9),e.doubleSided&&s.enable(10),e.flipSided&&s.enable(11),e.depthPacking&&s.enable(12),e.dithering&&s.enable(13),e.specularIntensityMap&&s.enable(14),e.specularColorMap&&s.enable(15),e.transmission&&s.enable(16),e.transmissionMap&&s.enable(17),e.thicknessMap&&s.enable(18),e.sheen&&s.enable(19),e.sheenColorMap&&s.enable(20),e.sheenRoughnessMap&&s.enable(21),t.push(s.mask)}function M(t){const e=g[t.type];let n;if(e){const t=ax[e];n=hm.clone(t.uniforms)}else n=t.uniforms;return n}function S(e,n){let i;for(let t=0,r=c.length;t<r;t++){const e=c[t];if(e.cacheKey===n){i=e,++i.usedTimes;break}}return void 0===i&&(i=new P_(t,n,e,o),c.push(i)),i}function T(t){if(0===--t.usedTimes){const e=c.indexOf(t);c[e]=c[c.length-1],c.pop(),t.destroy()}}function E(t){l.remove(t)}function C(){l.dispose()}return{getParameters:y,getProgramCacheKey:_,getUniforms:M,acquireProgram:S,releaseProgram:T,releaseShaderCache:E,programs:c,dispose:C}}function O_(){let t=new WeakMap;function e(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n}function n(e){t.delete(e)}function i(e,n,i){t.get(e)[n]=i}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function F_(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function U_(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function z_(){const t=[];let e=0;const n=[],i=[],r=[];function o(){e=0,n.length=0,i.length=0,r.length=0}function a(n,i,r,o,a,s){let l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:o,renderOrder:n.renderOrder,z:a,group:s},t[e]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=o,l.renderOrder=n.renderOrder,l.z=a,l.group=s),e++,l}function s(t,e,o,s,l,c){const u=a(t,e,o,s,l,c);o.transmission>0?i.push(u):!0===o.transparent?r.push(u):n.push(u)}function l(t,e,o,s,l,c){const u=a(t,e,o,s,l,c);o.transmission>0?i.unshift(u):!0===o.transparent?r.unshift(u):n.unshift(u)}function c(t,e){n.length>1&&n.sort(t||F_),i.length>1&&i.sort(e||U_),r.length>1&&r.sort(e||U_)}function u(){for(let n=e,i=t.length;n<i;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}}return{opaque:n,transmissive:i,transparent:r,init:o,push:s,unshift:l,finish:u,sort:c}}function H_(){let t=new WeakMap;function e(e,n){let i;return!1===t.has(e)?(i=new z_,t.set(e,[i])):n>=t.get(e).length?(i=new z_,t.get(e).push(i)):i=t.get(e)[n],i}function n(){t=new WeakMap}return{get:e,dispose:n}}function B_(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new np,color:new Tf};break;case"SpotLight":n={position:new np,direction:new np,color:new Tf,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new np,color:new Tf,distance:0,decay:0};break;case"HemisphereLight":n={direction:new np,skyColor:new Tf,groundColor:new Tf};break;case"RectAreaLight":n={color:new Tf,position:new np,halfWidth:new np,halfHeight:new np};break}return t[e.id]=n,n}}}function V_(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vd};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vd};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vd,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let G_=0;function W_(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function j_(t,e){const n=new B_,i=V_(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new np);const o=new np,a=new Dp,s=new Dp;function l(o,a){let s=0,l=0,c=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let u=0,h=0,d=0,p=0,f=0,m=0,g=0,v=0;o.sort(W_);const x=!0!==a?Math.PI:1;for(let t=0,e=o.length;t<e;t++){const e=o[t],a=e.color,y=e.intensity,_=e.distance,b=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)s+=a.r*y*x,l+=a.g*y*x,c+=a.b*y*x;else if(e.isLightProbe)for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],y);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*x),e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.directionalShadow[u]=n,r.directionalShadowMap[u]=b,r.directionalShadowMatrix[u]=e.shadow.matrix,m++}r.directional[u]=t,u++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(a).multiplyScalar(y*x),t.distance=_,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.spotShadow[d]=n,r.spotShadowMap[d]=b,r.spotShadowMatrix[d]=e.shadow.matrix,v++}r.spot[d]=t,d++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(a).multiplyScalar(y),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[p]=t,p++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*x),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,r.pointShadow[h]=n,r.pointShadowMap[h]=b,r.pointShadowMatrix[h]=e.shadow.matrix,g++}r.point[h]=t,h++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(y*x),t.groundColor.copy(e.groundColor).multiplyScalar(y*x),r.hemi[f]=t,f++}}p>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=ox.LTC_FLOAT_1,r.rectAreaLTC2=ox.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ox.LTC_HALF_1,r.rectAreaLTC2=ox.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=s,r.ambient[1]=l,r.ambient[2]=c;const y=r.hash;y.directionalLength===u&&y.pointLength===h&&y.spotLength===d&&y.rectAreaLength===p&&y.hemiLength===f&&y.numDirectionalShadows===m&&y.numPointShadows===g&&y.numSpotShadows===v||(r.directional.length=u,r.spot.length=d,r.rectArea.length=p,r.point.length=h,r.hemi.length=f,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=g,r.spotShadowMatrix.length=v,y.directionalLength=u,y.pointLength=h,y.spotLength=d,y.rectAreaLength=p,y.hemiLength=f,y.numDirectionalShadows=m,y.numPointShadows=g,y.numSpotShadows=v,r.version=G_++)}function c(t,e){let n=0,i=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let d=0,p=t.length;d<p;d++){const e=t[d];if(e.isDirectionalLight){const t=r.directional[n];t.direction.setFromMatrixPosition(e.matrixWorld),o.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),n++}else if(e.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(e.matrixWorld),o.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),l++}else if(e.isRectAreaLight){const t=r.rectArea[c];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),s.identity(),a.copy(e.matrixWorld),a.premultiply(h),s.extractRotation(a),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),t.halfWidth.applyMatrix4(s),t.halfHeight.applyMatrix4(s),c++}else if(e.isPointLight){const t=r.point[i];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),i++}else if(e.isHemisphereLight){const t=r.hemi[u];t.direction.setFromMatrixPosition(e.matrixWorld),t.direction.transformDirection(h),t.direction.normalize(),u++}}}return{setup:l,setupView:c,state:r}}function q_(t,e){const n=new j_(t,e),i=[],r=[];function o(){i.length=0,r.length=0}function a(t){i.push(t)}function s(t){r.push(t)}function l(t){n.setup(i,t)}function c(t){n.setupView(i,t)}const u={lightsArray:i,shadowsArray:r,lights:n};return{init:o,state:u,setupLights:l,setupLightsView:c,pushLight:a,pushShadow:s}}function X_(t,e){let n=new WeakMap;function i(i,r=0){let o;return!1===n.has(i)?(o=new q_(t,e),n.set(i,[o])):r>=n.get(i).length?(o=new q_(t,e),n.get(i).push(o)):o=n.get(i)[r],o}function r(){n=new WeakMap}return{get:i,dispose:r}}class Y_ extends xf{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=sd,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}Y_.prototype.isMeshDepthMaterial=!0;class $_ extends xf{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new np,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}$_.prototype.isMeshDistanceMaterial=!0;const Z_="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",J_="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function K_(t,e,n){let i=new Am;const r=new Vd,o=new Vd,a=new Jd,s=new Y_({depthPacking:ld}),l=new $_,c={},u=n.maxTextureSize,h={0:Rc,1:Lc,2:Pc},d=new fm({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vd},radius:{value:4}},vertexShader:Z_,fragmentShader:J_}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new Bf;f.setAttribute("position",new Lf(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new om(f,d),g=this;function v(n,i){const r=e.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,r,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,r,p,m,null)}function x(e,n,i,r,o,a,u){let d=null;const p=!0===r.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(d=void 0!==p?p:!0===r.isPointLight?l:s,t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length||i.displacementMap&&0!==i.displacementScale||i.alphaMap&&i.alphaTest>0){const t=d.uuid,e=i.uuid;let n=c[t];void 0===n&&(n={},c[t]=n);let r=n[e];void 0===r&&(r=d.clone(),n[e]=r),d=r}return d.visible=i.visible,d.wireframe=i.wireframe,d.side=u===Ac?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:h[i.side],d.alphaMap=i.alphaMap,d.alphaTest=i.alphaTest,d.clipShadows=i.clipShadows,d.clippingPlanes=i.clippingPlanes,d.clipIntersection=i.clipIntersection,d.displacementMap=i.displacementMap,d.displacementScale=i.displacementScale,d.displacementBias=i.displacementBias,d.wireframeLinewidth=i.wireframeLinewidth,d.linewidth=i.linewidth,!0===r.isPointLight&&!0===d.isMeshDistanceMaterial&&(d.referencePosition.setFromMatrixPosition(r.matrixWorld),d.nearDistance=o,d.farDistance=a),d}function y(n,r,o,a,s){if(!1===n.visible)return;const l=n.layers.test(r.layers);if(l&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===Ac)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const i=e.update(n),r=n.material;if(Array.isArray(r)){const e=i.groups;for(let l=0,c=e.length;l<c;l++){const c=e[l],u=r[c.materialIndex];if(u&&u.visible){const e=x(n,i,u,a,o.near,o.far,s);t.renderBufferDirect(o,null,i,e,n,c)}}}else if(r.visible){const e=x(n,i,r,a,o.near,o.far,s);t.renderBufferDirect(o,null,i,e,n,null)}}const c=n.children;for(let t=0,e=c.length;t<e;t++)y(c[t],r,o,a,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Ec,this.render=function(e,n,s){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(Dc),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let p=0,f=e.length;p<f;p++){const l=e[p],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const h=c.getFrameExtents();if(r.multiply(h),o.copy(c.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/h.x),r.x=o.x*h.x,c.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/h.y),r.y=o.y*h.y,c.mapSize.y=o.y)),null===c.map&&!c.isPointLightShadow&&this.type===Ac){const t={minFilter:Pu,magFilter:Pu,format:Yu};c.map=new Kd(r.x,r.y,t),c.map.texture.name=l.name+".shadowMap",c.mapPass=new Kd(r.x,r.y,t),c.camera.updateProjectionMatrix()}if(null===c.map){const t={minFilter:Au,magFilter:Au,format:Yu};c.map=new Kd(r.x,r.y,t),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}t.setRenderTarget(c.map),t.clear();const f=c.getViewportCount();for(let t=0;t<f;t++){const e=c.getViewport(t);a.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),d.viewport(a),c.updateMatrices(l,t),i=c.getFrustum(),y(n,s,c.camera,l,this.type)}c.isPointLightShadow||this.type!==Ac||v(c,s),c.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(l,c,h)}}function Q_(t,e,n){const i=n.isWebGL2;function r(){let e=!1;const n=new Jd;let i=null;const r=new Jd(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,o,a,s){!0===s&&(e*=a,i*=a,o*=a),n.set(e,i,o,a),!1===r.equals(n)&&(t.clearColor(e,i,o,a),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}}function o(){let e=!1,n=null,i=null,r=null;return{setTest:function(t){t?z(2929):H(2929)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case eu:t.depthFunc(512);break;case nu:t.depthFunc(519);break;case iu:t.depthFunc(513);break;case ru:t.depthFunc(515);break;case ou:t.depthFunc(514);break;case au:t.depthFunc(518);break;case su:t.depthFunc(516);break;case lu:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}}function a(){let e=!1,n=null,i=null,r=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(t){e||(t?z(2960):H(2960))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,a){i===e&&r===n&&o===a||(t.stencilFunc(e,n,a),i=e,r=n,o=a)},setOp:function(e,n,i){a===e&&s===n&&l===i||(t.stencilOp(e,n,i),a=e,s=n,l=i)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,i=null,r=null,o=null,a=null,s=null,l=null,c=null}}}const s=new r,l=new o,c=new a;let u={},h={},d=null,p=!1,f=null,m=null,g=null,v=null,x=null,y=null,_=null,b=!1,w=null,M=null,S=null,T=null,E=null;const C=t.getParameter(35661);let A=!1,L=0;const R=t.getParameter(7938);-1!==R.indexOf("WebGL")?(L=parseFloat(/^WebGL (\d)/.exec(R)[1]),A=L>=1):-1!==R.indexOf("OpenGL ES")&&(L=parseFloat(/^OpenGL ES (\d)/.exec(R)[1]),A=L>=2);let P=null,N={};const D=t.getParameter(3088),k=t.getParameter(2978),I=(new Jd).fromArray(D),O=(new Jd).fromArray(k);function F(e,n,i){const r=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let a=0;a<i;a++)t.texImage2D(n+a,0,6408,1,1,0,6408,5121,r);return o}const U={};function z(e){!0!==u[e]&&(t.enable(e),u[e]=!0)}function H(e){!1!==u[e]&&(t.disable(e),u[e]=!1)}function B(e,n){return h[e]!==n&&(t.bindFramebuffer(e,n),h[e]=n,i&&(36009===e&&(h[36160]=n),36160===e&&(h[36009]=n)),!0)}function V(e){return d!==e&&(t.useProgram(e),d=e,!0)}U[3553]=F(3553,3553,1),U[34067]=F(34067,34069,6),s.setClear(0,0,0,1),l.setClear(1),c.setClear(0),z(2929),l.setFunc(ru),X(!1),Y(Sc),z(2884),j(Dc);const G={[zc]:32774,[Hc]:32778,[Bc]:32779};if(i)G[Vc]=32775,G[Gc]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(G[Vc]=t.MIN_EXT,G[Gc]=t.MAX_EXT)}const W={[Wc]:0,[jc]:1,[qc]:768,[Yc]:770,[tu]:776,[Kc]:774,[Zc]:772,[Xc]:769,[$c]:771,[Qc]:775,[Jc]:773};function j(e,n,i,r,o,a,s,l){if(e!==Dc){if(!1===p&&(z(3042),p=!0),e===Uc)o=o||n,a=a||i,s=s||r,n===m&&o===x||(t.blendEquationSeparate(G[n],G[o]),m=n,x=o),i===g&&r===v&&a===y&&s===_||(t.blendFuncSeparate(W[i],W[r],W[a],W[s]),g=i,v=r,y=a,_=s),f=e,b=null;else if(e!==f||l!==b){if(m===zc&&x===zc||(t.blendEquation(32774),m=zc,x=zc),l)switch(e){case kc:t.blendFuncSeparate(1,771,1,771);break;case Ic:t.blendFunc(1,1);break;case Oc:t.blendFuncSeparate(0,0,769,771);break;case Fc:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case kc:t.blendFuncSeparate(770,771,1,771);break;case Ic:t.blendFunc(770,1);break;case Oc:t.blendFunc(0,769);break;case Fc:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}g=null,v=null,y=null,_=null,f=e,b=l}}else!0===p&&(H(3042),p=!1)}function q(t,e){t.side===Pc?H(2884):z(2884);let n=t.side===Rc;e&&(n=!n),X(n),t.blending===kc&&!1===t.transparent?j(Dc):j(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),l.setFunc(t.depthFunc),l.setTest(t.depthTest),l.setMask(t.depthWrite),s.setMask(t.colorWrite);const i=t.stencilWrite;c.setTest(i),i&&(c.setMask(t.stencilWriteMask),c.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),c.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Z(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?z(32926):H(32926)}function X(e){w!==e&&(e?t.frontFace(2304):t.frontFace(2305),w=e)}function Y(e){e!==Mc?(z(2884),e!==M&&(e===Sc?t.cullFace(1029):e===Tc?t.cullFace(1028):t.cullFace(1032))):H(2884),M=e}function $(e){e!==S&&(A&&t.lineWidth(e),S=e)}function Z(e,n,i){e?(z(32823),T===n&&E===i||(t.polygonOffset(n,i),T=n,E=i)):H(32823)}function J(t){t?z(3089):H(3089)}function K(e){void 0===e&&(e=33984+C-1),P!==e&&(t.activeTexture(e),P=e)}function Q(e,n){null===P&&K();let i=N[P];void 0===i&&(i={type:void 0,texture:void 0},N[P]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||U[e]),i.type=e,i.texture=n)}function tt(){const e=N[P];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)}function et(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function nt(){try{t.texSubImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function it(){try{t.texSubImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function rt(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function ot(){try{t.texStorage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function at(){try{t.texStorage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function st(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function lt(){try{t.texImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function ct(e){!1===I.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),I.copy(e))}function ut(e){!1===O.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),O.copy(e))}function ht(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===i&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},P=null,N={},h={},d=null,p=!1,f=null,m=null,g=null,v=null,x=null,y=null,_=null,b=!1,w=null,M=null,S=null,T=null,E=null,I.set(0,0,t.canvas.width,t.canvas.height),O.set(0,0,t.canvas.width,t.canvas.height),s.reset(),l.reset(),c.reset()}return{buffers:{color:s,depth:l,stencil:c},enable:z,disable:H,bindFramebuffer:B,useProgram:V,setBlending:j,setMaterial:q,setFlipSided:X,setCullFace:Y,setLineWidth:$,setPolygonOffset:Z,setScissorTest:J,activeTexture:K,bindTexture:Q,unbindTexture:tt,compressedTexImage2D:et,texImage2D:st,texImage3D:lt,texStorage2D:ot,texStorage3D:at,texSubImage2D:nt,texSubImage3D:it,compressedTexSubImage2D:rt,scissor:ct,viewport:ut,reset:ht}}function tb(t,e,n,i,r,o,a){const s=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture"),p=d?e.get("WEBGL_multisampled_render_to_texture"):void 0,f=new WeakMap;let m,g=!1;try{g="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(it){}function v(t,e){return g?new OffscreenCanvas(t,e):jd("canvas")}function x(t,e,n,i){let r=1;if((t.width>i||t.height>i)&&(r=i/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){const i=e?zd:Math.floor,o=i(r*t.width),a=i(r*t.height);void 0===m&&(m=v(o,a));const s=n?v(o,a):m;s.width=o,s.height=a;const l=s.getContext("2d");return l.drawImage(t,0,0,o,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+a+")."),s}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function y(t){return Fd(t.width)&&Fd(t.height)}function _(t){return!s&&(t.wrapS!==Eu||t.wrapT!==Eu||t.minFilter!==Au&&t.minFilter!==Pu)}function b(t,e){return t.generateMipmaps&&e&&t.minFilter!==Au&&t.minFilter!==Pu}function w(e){t.generateMipmap(e)}function M(n,i,r,o){if(!1===s)return i;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let a=i;return 6403===i&&(5126===r&&(a=33326),5131===r&&(a=33325),5121===r&&(a=33321)),6407===i&&(5126===r&&(a=34837),5131===r&&(a=34843),5121===r&&(a=32849)),6408===i&&(5126===r&&(a=34836),5131===r&&(a=34842),5121===r&&(a=o===ad?35907:32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||e.get("EXT_color_buffer_float"),a}function S(t,e,n){return!0===b(t,n)||t.isFramebufferTexture&&t.minFilter!==Au&&t.minFilter!==Pu?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function T(t){return t===Au||t===Lu||t===Ru?9728:9729}function E(t){const e=t.target;e.removeEventListener("dispose",E),A(e),e.isVideoTexture&&f.delete(e),a.memory.textures--}function C(t){const e=t.target;e.removeEventListener("dispose",C),L(e)}function A(e){const n=i.get(e);void 0!==n.__webglInit&&(t.deleteTexture(n.__webglTexture),i.remove(e))}function L(e){const n=e.texture,r=i.get(e),o=i.get(n);if(e){if(void 0!==o.__webglTexture&&(t.deleteTexture(o.__webglTexture),a.memory.textures--),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(r.__webglFramebuffer[e]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[e]);else t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&t.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer);if(e.isWebGLMultipleRenderTargets)for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);r.__webglTexture&&(t.deleteTexture(r.__webglTexture),a.memory.textures--),i.remove(n[e])}i.remove(n),i.remove(e)}}let R=0;function P(){R=0}function N(){const t=R;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),R+=1,t}function D(t,e){const r=i.get(t);if(t.isVideoTexture&&K(t),t.version>0&&r.__version!==t.version){const n=t.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void B(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,r.__webglTexture)}function k(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?B(r,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,r.__webglTexture))}function I(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?B(r,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,r.__webglTexture))}function O(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?V(r,t,e):(n.activeTexture(33984+e),n.bindTexture(34067,r.__webglTexture))}const F={[Tu]:10497,[Eu]:33071,[Cu]:33648},U={[Au]:9728,[Lu]:9984,[Ru]:9986,[Pu]:9729,[Nu]:9985,[Du]:9987};function z(n,o,a){if(a?(t.texParameteri(n,10242,F[o.wrapS]),t.texParameteri(n,10243,F[o.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,F[o.wrapR]),t.texParameteri(n,10240,U[o.magFilter]),t.texParameteri(n,10241,U[o.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),o.wrapS===Eu&&o.wrapT===Eu||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,T(o.magFilter)),t.texParameteri(n,10241,T(o.minFilter)),o.minFilter!==Au&&o.minFilter!==Pu&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const a=e.get("EXT_texture_filter_anisotropic");if(o.type===Hu&&!1===e.has("OES_texture_float_linear"))return;if(!1===s&&o.type===Bu&&!1===e.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||i.get(o).__currentAnisotropy)&&(t.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),i.get(o).__currentAnisotropy=o.anisotropy)}}function H(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",E),e.__webglTexture=t.createTexture(),a.memory.textures++)}function B(e,i,r){let a=3553;i.isDataTexture2DArray&&(a=35866),i.isDataTexture3D&&(a=32879),H(e,i),n.activeTexture(33984+r),n.bindTexture(a,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const l=_(i)&&!1===y(i.image),c=x(i.image,l,!1,u),h=y(c)||s,d=o.convert(i.format);let p,f=o.convert(i.type),m=M(i.internalFormat,d,f,i.encoding);z(a,i,h);const g=i.mipmaps,v=s&&!0!==i.isVideoTexture,T=void 0===e.__version,E=S(i,c,h);if(i.isDepthTexture)m=6402,s?m=i.type===Hu?36012:i.type===zu?33190:i.type===ju?35056:33189:i.type===Hu&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===Ju&&6402===m&&i.type!==Fu&&i.type!==zu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=Fu,f=o.convert(i.type)),i.format===Ku&&6402===m&&(m=34041,i.type!==ju&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=ju,f=o.convert(i.type))),v&&T?n.texStorage2D(3553,1,m,c.width,c.height):n.texImage2D(3553,0,m,c.width,c.height,0,d,f,null);else if(i.isDataTexture)if(g.length>0&&h){v&&T&&n.texStorage2D(3553,E,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],v?n.texSubImage2D(3553,0,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data);i.generateMipmaps=!1}else v?(T&&n.texStorage2D(3553,E,m,c.width,c.height),n.texSubImage2D(3553,0,0,0,c.width,c.height,d,f,c.data)):n.texImage2D(3553,0,m,c.width,c.height,0,d,f,c.data);else if(i.isCompressedTexture){v&&T&&n.texStorage2D(3553,E,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],i.format!==Yu&&i.format!==Xu?null!==d?v?n.compressedTexSubImage2D(3553,t,0,0,p.width,p.height,d,p.data):n.compressedTexImage2D(3553,t,m,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):v?n.texSubImage2D(3553,t,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data)}else if(i.isDataTexture2DArray)v?(T&&n.texStorage3D(35866,E,m,c.width,c.height,c.depth),n.texSubImage3D(35866,0,0,0,0,c.width,c.height,c.depth,d,f,c.data)):n.texImage3D(35866,0,m,c.width,c.height,c.depth,0,d,f,c.data);else if(i.isDataTexture3D)v?(T&&n.texStorage3D(32879,E,m,c.width,c.height,c.depth),n.texSubImage3D(32879,0,0,0,0,c.width,c.height,c.depth,d,f,c.data)):n.texImage3D(32879,0,m,c.width,c.height,c.depth,0,d,f,c.data);else if(i.isFramebufferTexture)v&&T?n.texStorage2D(3553,E,m,c.width,c.height):n.texImage2D(3553,0,m,c.width,c.height,0,d,f,null);else if(g.length>0&&h){v&&T&&n.texStorage2D(3553,E,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],v?n.texSubImage2D(3553,t,0,0,d,f,p):n.texImage2D(3553,t,m,d,f,p);i.generateMipmaps=!1}else v?(T&&n.texStorage2D(3553,E,m,c.width,c.height),n.texSubImage2D(3553,0,0,0,d,f,c)):n.texImage2D(3553,0,m,d,f,c);b(i,h)&&w(a),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function V(e,i,r){if(6!==i.image.length)return;H(e,i),n.activeTexture(33984+r),n.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const a=i&&(i.isCompressedTexture||i.image[0].isCompressedTexture),l=i.image[0]&&i.image[0].isDataTexture,u=[];for(let t=0;t<6;t++)u[t]=a||l?l?i.image[t].image:i.image[t]:x(i.image[t],!1,!0,c);const h=u[0],d=y(h)||s,p=o.convert(i.format),f=o.convert(i.type),m=M(i.internalFormat,p,f,i.encoding),g=s&&!0!==i.isVideoTexture,v=void 0===e.__version;let _,T=S(i,h,d);if(z(34067,i,d),a){g&&v&&n.texStorage2D(34067,T,m,h.width,h.height);for(let t=0;t<6;t++){_=u[t].mipmaps;for(let e=0;e<_.length;e++){const r=_[e];i.format!==Yu&&i.format!==Xu?null!==p?g?n.compressedTexSubImage2D(34069+t,e,0,0,r.width,r.height,p,r.data):n.compressedTexImage2D(34069+t,e,m,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g?n.texSubImage2D(34069+t,e,0,0,r.width,r.height,p,f,r.data):n.texImage2D(34069+t,e,m,r.width,r.height,0,p,f,r.data)}}}else{_=i.mipmaps,g&&v&&(_.length>0&&T++,n.texStorage2D(34067,T,m,u[0].width,u[0].height));for(let t=0;t<6;t++)if(l){g?n.texSubImage2D(34069+t,0,0,0,u[t].width,u[t].height,p,f,u[t].data):n.texImage2D(34069+t,0,m,u[t].width,u[t].height,0,p,f,u[t].data);for(let e=0;e<_.length;e++){const i=_[e],r=i.image[t].image;g?n.texSubImage2D(34069+t,e+1,0,0,r.width,r.height,p,f,r.data):n.texImage2D(34069+t,e+1,m,r.width,r.height,0,p,f,r.data)}}else{g?n.texSubImage2D(34069+t,0,0,0,p,f,u[t]):n.texImage2D(34069+t,0,m,p,f,u[t]);for(let e=0;e<_.length;e++){const i=_[e];g?n.texSubImage2D(34069+t,e+1,0,0,p,f,i.image[t]):n.texImage2D(34069+t,e+1,m,p,f,i.image[t])}}}b(i,d)&&w(34067),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function G(e,r,a,s,l){const c=o.convert(a.format),u=o.convert(a.type),h=M(a.internalFormat,c,u,a.encoding),d=i.get(r);d.__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,r.width,r.height,r.depth,0,c,u,null):n.texImage2D(l,0,h,r.width,r.height,0,c,u,null)),n.bindFramebuffer(36160,e),r.useRenderToTexture?p.framebufferTexture2DMultisampleEXT(36160,s,l,i.get(a).__webglTexture,0,J(r)):t.framebufferTexture2D(36160,s,l,i.get(a).__webglTexture,0),n.bindFramebuffer(36160,null)}function W(e,n,i){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i||n.useRenderToTexture){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===Hu?r=36012:e.type===zu&&(r=33190));const i=J(n);n.useRenderToTexture?p.renderbufferStorageMultisampleEXT(36161,i,r,n.width,n.height):t.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else t.renderbufferStorage(36161,r,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){const r=J(n);i&&n.useRenderbuffer?t.renderbufferStorageMultisample(36161,r,35056,n.width,n.height):n.useRenderToTexture?p.renderbufferStorageMultisampleEXT(36161,r,35056,n.width,n.height):t.renderbufferStorage(36161,34041,n.width,n.height),t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,r=o.convert(e.format),a=o.convert(e.type),s=M(e.internalFormat,r,a,e.encoding),l=J(n);i&&n.useRenderbuffer?t.renderbufferStorageMultisample(36161,l,s,n.width,n.height):n.useRenderToTexture?p.renderbufferStorageMultisampleEXT(36161,l,s,n.width,n.height):t.renderbufferStorage(36161,s,n.width,n.height)}t.bindRenderbuffer(36161,null)}function j(e,r){const o=r&&r.isWebGLCubeRenderTarget;if(o)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),D(r.depthTexture,0);const a=i.get(r.depthTexture).__webglTexture,s=J(r);if(r.depthTexture.format===Ju)r.useRenderToTexture?p.framebufferTexture2DMultisampleEXT(36160,36096,3553,a,0,s):t.framebufferTexture2D(36160,36096,3553,a,0);else{if(r.depthTexture.format!==Ku)throw new Error("Unknown depthTexture format");r.useRenderToTexture?p.framebufferTexture2DMultisampleEXT(36160,33306,3553,a,0,s):t.framebufferTexture2D(36160,33306,3553,a,0)}}function q(e){const r=i.get(e),o=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(o)throw new Error("target.depthTexture not supported in Cube render targets");j(r.__webglFramebuffer,e)}else if(o){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(36160,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=t.createRenderbuffer(),W(r.__webglDepthbuffer[i],e,!1)}else n.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),W(r.__webglDepthbuffer,e,!1);n.bindFramebuffer(36160,null)}function X(t,e,n){const r=i.get(t);void 0!==e&&G(r.__webglFramebuffer,t,t.texture,36064,3553),void 0!==n&&q(t)}function Y(e){const l=e.texture,c=i.get(e),u=i.get(l);e.addEventListener("dispose",C),!0!==e.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=t.createTexture()),u.__version=l.version,a.memory.textures++);const h=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,p=l.isDataTexture3D||l.isDataTexture2DArray,f=y(e)||s;if(!s||l.format!==Xu||l.type!==Hu&&l.type!==Bu||(l.format=Yu,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),h){c.__webglFramebuffer=[];for(let e=0;e<6;e++)c.__webglFramebuffer[e]=t.createFramebuffer()}else if(c.__webglFramebuffer=t.createFramebuffer(),d)if(r.drawBuffers){const n=e.texture;for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);void 0===r.__webglTexture&&(r.__webglTexture=t.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(e.useRenderbuffer)if(s){c.__webglMultisampledFramebuffer=t.createFramebuffer(),c.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const i=o.convert(l.format),r=o.convert(l.type),a=M(l.internalFormat,i,r,l.encoding),s=J(e);t.renderbufferStorageMultisample(36161,s,a,e.width,e.height),n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(c.__webglDepthRenderbuffer=t.createRenderbuffer(),W(c.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(h){n.bindTexture(34067,u.__webglTexture),z(34067,l,f);for(let t=0;t<6;t++)G(c.__webglFramebuffer[t],e,l,36064,34069+t);b(l,f)&&w(34067),n.unbindTexture()}else if(d){const t=e.texture;for(let r=0,o=t.length;r<o;r++){const o=t[r],a=i.get(o);n.bindTexture(3553,a.__webglTexture),z(3553,o,f),G(c.__webglFramebuffer,e,o,36064+r,3553),b(o,f)&&w(3553)}n.unbindTexture()}else{let t=3553;if(p)if(s){const e=l.isDataTexture3D;t=e?32879:35866}else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");n.bindTexture(t,u.__webglTexture),z(t,l,f),G(c.__webglFramebuffer,e,l,36064,t),b(l,f)&&w(t),n.unbindTexture()}e.depthBuffer&&q(e)}function $(t){const e=y(t)||s,r=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let o=0,a=r.length;o<a;o++){const a=r[o];if(b(a,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,r=i.get(a).__webglTexture;n.bindTexture(e,r),w(e),n.unbindTexture()}}}function Z(e){if(e.useRenderbuffer)if(s){const r=e.width,o=e.height;let a=16384;const s=[36064],l=e.stencilBuffer?33306:36096;e.depthBuffer&&s.push(l),e.ignoreDepthForMultisampleCopy||(e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024));const c=i.get(e);n.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,c.__webglFramebuffer),e.ignoreDepthForMultisampleCopy&&(t.invalidateFramebuffer(36008,[l]),t.invalidateFramebuffer(36009,[l])),t.blitFramebuffer(0,0,r,o,0,0,r,o,a,9728),t.invalidateFramebuffer(36008,s),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function J(t){return s&&(t.useRenderbuffer||t.useRenderToTexture)?Math.min(h,t.samples):0}function K(t){const e=a.render.frame;f.get(t)!==e&&(f.set(t,e),t.update())}let Q=!1,tt=!1;function et(t,e){t&&t.isWebGLRenderTarget&&(!1===Q&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Q=!0),t=t.texture),D(t,e)}function nt(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===tt&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),tt=!0),t=t.texture),O(t,e)}this.allocateTextureUnit=N,this.resetTextureUnits=P,this.setTexture2D=D,this.setTexture2DArray=k,this.setTexture3D=I,this.setTextureCube=O,this.rebindTextures=X,this.setupRenderTarget=Y,this.updateRenderTargetMipmap=$,this.updateMultisampleRenderTarget=Z,this.setupDepthRenderbuffer=q,this.setupFrameBufferTexture=G,this.safeSetTexture2D=et,this.safeSetTextureCube=nt}function eb(t,e,n){const i=n.isWebGL2;function r(t){let n;if(t===ku)return 5121;if(t===Vu)return 32819;if(t===Gu)return 32820;if(t===Wu)return 33635;if(t===Iu)return 5120;if(t===Ou)return 5122;if(t===Fu)return 5123;if(t===Uu)return 5124;if(t===zu)return 5125;if(t===Hu)return 5126;if(t===Bu)return i?5131:(n=e.get("OES_texture_half_float"),null!==n?n.HALF_FLOAT_OES:null);if(t===qu)return 6406;if(t===Xu)return 6407;if(t===Yu)return 6408;if(t===$u)return 6409;if(t===Zu)return 6410;if(t===Ju)return 6402;if(t===Ku)return 34041;if(t===Qu)return 6403;if(t===th)return 36244;if(t===eh)return 33319;if(t===nh)return 33320;if(t===ih)return 36248;if(t===rh)return 36249;if(t===oh||t===ah||t===sh||t===lh){if(n=e.get("WEBGL_compressed_texture_s3tc"),null===n)return null;if(t===oh)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===ah)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===sh)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===lh)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===ch||t===uh||t===hh||t===dh){if(n=e.get("WEBGL_compressed_texture_pvrtc"),null===n)return null;if(t===ch)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===uh)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===hh)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===dh)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===ph)return n=e.get("WEBGL_compressed_texture_etc1"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((t===fh||t===mh)&&(n=e.get("WEBGL_compressed_texture_etc"),null!==n)){if(t===fh)return n.COMPRESSED_RGB8_ETC2;if(t===mh)return n.COMPRESSED_RGBA8_ETC2_EAC}return t===gh||t===vh||t===xh||t===yh||t===_h||t===bh||t===wh||t===Mh||t===Sh||t===Th||t===Eh||t===Ch||t===Ah||t===Lh||t===Ph||t===Nh||t===Dh||t===kh||t===Ih||t===Oh||t===Fh||t===Uh||t===zh||t===Hh||t===Bh||t===Vh||t===Gh||t===Wh?(n=e.get("WEBGL_compressed_texture_astc"),null!==n?t:null):t===Rh?(n=e.get("EXT_texture_compression_bptc"),null!==n?t:null):t===ju?i?34042:(n=e.get("WEBGL_depth_texture"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}return{convert:r}}class nb extends gm{constructor(t=[]){super(),this.cameras=t}}nb.prototype.isArrayCamera=!0;class ib extends of{constructor(){super(),this.type="Group"}}ib.prototype.isGroup=!0;const rb={type:"move"};class ob{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ib,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ib,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new np,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new np),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ib,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new np,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new np),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,o=null;const a=this._targetRay,s=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==a&&(i=e.getPose(t.targetRaySpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(rb))),l&&t.hand){o=!0;for(const o of t.hand.values()){const t=e.getJointPose(o,n);if(void 0===l.joints[o.jointName]){const t=new ib;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[o.jointName]=t,l.add(t)}const i=l.joints[o.jointName];null!==t&&(i.matrix.fromArray(t.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=t.radius),i.visible=null!==t}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=i.position.distanceTo(r.position),s=.02,c=.005;l.inputState.pinching&&a>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&a<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==s&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1));return null!==a&&(a.visible=null!==i),null!==s&&(s.visible=null!==r),null!==l&&(l.visible=null!==o),this}}class ab extends $d{constructor(t,e,n,i,r,o,a,s,l,c){if(c=void 0!==c?c:Ju,c!==Ju&&c!==Ku)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Ju&&(n=Fu),void 0===n&&c===Ku&&(n=ju),super(null,i,r,o,a,s,c,n,l),this.image={width:t,height:e},this.magFilter=void 0!==a?a:Au,this.minFilter=void 0!==s?s:Au,this.flipY=!1,this.generateMipmaps=!1}}ab.prototype.isDepthTexture=!0;class sb extends gd{constructor(t,e){super();const n=this;let i=null,r=1,o=null,a="local-floor";const s=t.extensions.has("WEBGL_multisampled_render_to_texture");let l=null,c=null,u=null,h=null,d=!1,p=null;const f=e.getContextAttributes();let m=null,g=null;const v=[],x=new Map,y=new gm;y.layers.enable(1),y.viewport=new Jd;const _=new gm;_.layers.enable(2),_.viewport=new Jd;const b=[y,_],w=new nb;w.layers.enable(1),w.layers.enable(2);let M=null,S=null;function T(t){const e=x.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function E(){x.forEach((function(t,e){t.disconnect(e)})),x.clear(),M=null,S=null,t.setRenderTarget(m),h=null,u=null,c=null,i=null,g=null,k.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function C(t){const e=i.inputSources;for(let n=0;n<v.length;n++)x.set(e[n],v[n]);for(let n=0;n<t.removed.length;n++){const e=t.removed[n],i=x.get(e);i&&(i.dispatchEvent({type:"disconnected",data:e}),x.delete(e))}for(let n=0;n<t.added.length;n++){const e=t.added[n],i=x.get(e);i&&i.dispatchEvent({type:"connected",data:e})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=v[t];return void 0===e&&(e=new ob,v[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=v[t];return void 0===e&&(e=new ob,v[t]=e),e.getGripSpace()},this.getHand=function(t){let e=v[t];return void 0===e&&(e=new ob,v[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){r=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(l){if(i=l,null!==i){if(m=t.getRenderTarget(),i.addEventListener("select",T),i.addEventListener("selectstart",T),i.addEventListener("selectend",T),i.addEventListener("squeeze",T),i.addEventListener("squeezestart",T),i.addEventListener("squeezeend",T),i.addEventListener("end",E),i.addEventListener("inputsourceschange",C),!0!==f.xrCompatible&&await e.makeXRCompatible(),void 0===i.renderState.layers||!1===t.capabilities.isWebGL2){const n={antialias:void 0!==i.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};h=new XRWebGLLayer(i,e,n),i.updateRenderState({baseLayer:h}),g=new Kd(h.framebufferWidth,h.framebufferHeight,{format:Yu,type:ku,encoding:t.outputEncoding})}else{d=f.antialias;let n=null,o=null,a=null;f.depth&&(a=f.stencil?35056:33190,n=f.stencil?Ku:Ju,o=f.stencil?ju:Fu);const l={colorFormat:f.alpha||d?32856:32849,depthFormat:a,scaleFactor:r};c=new XRWebGLBinding(i,e),u=c.createProjectionLayer(l),i.updateRenderState({layers:[u]}),g=d?new tp(u.textureWidth,u.textureHeight,{format:Yu,type:ku,depthTexture:new ab(u.textureWidth,u.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,ignoreDepth:u.ignoreDepthValues,useRenderToTexture:s,encoding:t.outputEncoding}):new Kd(u.textureWidth,u.textureHeight,{format:f.alpha?Yu:Xu,type:ku,depthTexture:new ab(u.textureWidth,u.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,ignoreDepth:u.ignoreDepthValues,encoding:t.outputEncoding})}this.setFoveation(1),o=await i.requestReferenceSpace(a),k.setContext(i),k.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const A=new np,L=new np;function R(t,e,n){A.setFromMatrixPosition(e.matrixWorld),L.setFromMatrixPosition(n.matrixWorld);const i=A.distanceTo(L),r=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(o[8]+1)/o[0],d=a*u,p=a*h,f=i/(-u+h),m=f*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=a+f,v=s+f,x=d-m,y=p+(i-m),_=l*s/v*g,b=c*s/v*g;t.projectionMatrix.makePerspective(x,y,_,b,g,v)}function P(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===i)return;w.near=_.near=y.near=t.near,w.far=_.far=y.far=t.far,M===w.near&&S===w.far||(i.updateRenderState({depthNear:w.near,depthFar:w.far}),M=w.near,S=w.far);const e=t.parent,n=w.cameras;P(w,e);for(let i=0;i<n.length;i++)P(n[i],e);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),t.position.copy(w.position),t.quaternion.copy(w.quaternion),t.scale.copy(w.scale),t.matrix.copy(w.matrix),t.matrixWorld.copy(w.matrixWorld);const r=t.children;for(let i=0,o=r.length;i<o;i++)r[i].updateMatrixWorld(!0);2===n.length?R(w,y,_):w.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return w},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(t){null!==u&&(u.fixedFoveation=t),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=t)};let N=null;function D(e,n){if(l=n.getViewerPose(o),p=n,null!==l){const e=l.views;null!==h&&(t.setRenderTargetFramebuffer(g,h.framebuffer),t.setRenderTarget(g));let n=!1;e.length!==w.cameras.length&&(w.cameras.length=0,n=!0);for(let i=0;i<e.length;i++){const r=e[i];let o=null;if(null!==h)o=h.getViewport(r);else{const e=c.getViewSubImage(u,r);o=e.viewport,0===i&&(t.setRenderTargetTextures(g,e.colorTexture,u.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(g))}const a=b[i];a.matrix.fromArray(r.transform.matrix),a.projectionMatrix.fromArray(r.projectionMatrix),a.viewport.set(o.x,o.y,o.width,o.height),0===i&&w.matrix.copy(a.matrix),!0===n&&w.cameras.push(a)}}const r=i.inputSources;for(let t=0;t<v.length;t++){const e=v[t],i=r[t];e.update(i,n,o)}N&&N(e,n),p=null}const k=new Lm;k.setAnimationLoop(D),this.setAnimationLoop=function(t){N=t},this.dispose=function(){}}}function lb(t){function e(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function n(t,e,n,v,x){e.isMeshBasicMaterial?i(t,e):e.isMeshLambertMaterial?(i(t,e),l(t,e)):e.isMeshToonMaterial?(i(t,e),u(t,e)):e.isMeshPhongMaterial?(i(t,e),c(t,e)):e.isMeshStandardMaterial?(i(t,e),e.isMeshPhysicalMaterial?d(t,e,x):h(t,e)):e.isMeshMatcapMaterial?(i(t,e),p(t,e)):e.isMeshDepthMaterial?(i(t,e),f(t,e)):e.isMeshDistanceMaterial?(i(t,e),m(t,e)):e.isMeshNormalMaterial?(i(t,e),g(t,e)):e.isLineBasicMaterial?(r(t,e),e.isLineDashedMaterial&&o(t,e)):e.isPointsMaterial?a(t,e,n,v):e.isSpriteMaterial?s(t,e):e.isShadowMaterial?(t.color.value.copy(e.color),t.opacity.value=e.opacity):e.isShaderMaterial&&(e.uniformsNeedUpdate=!1)}function i(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest);const i=t.get(n).envMap;let r,o;i&&(e.envMap.value=i,e.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,e.reflectivity.value=n.reflectivity,e.ior.value=n.ior,e.refractionRatio.value=n.refractionRatio),n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap?r=n.clearcoatRoughnessMap:n.specularIntensityMap?r=n.specularIntensityMap:n.specularColorMap?r=n.specularColorMap:n.transmissionMap?r=n.transmissionMap:n.thicknessMap?r=n.thicknessMap:n.sheenColorMap?r=n.sheenColorMap:n.sheenRoughnessMap&&(r=n.sheenRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),n.aoMap?o=n.aoMap:n.lightMap&&(o=n.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),e.uv2Transform.value.copy(o.matrix))}function r(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}function o(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function a(t,e,n,i){let r;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?r=e.map:e.alphaMap&&(r=e.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}function s(t,e){let n;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?n=e.map:e.alphaMap&&(n=e.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}function l(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function c(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===Rc&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===Rc&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function u(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===Rc&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===Rc&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function h(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,n.side===Rc&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),n.side===Rc&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias);const i=t.get(n).envMap;i&&(e.envMapIntensity.value=n.envMapIntensity)}function d(t,e,n){h(t,e),t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap)),e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===Rc&&t.clearcoatNormalScale.value.negate())),e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=n.texture,t.transmissionSamplerSize.value.set(n.width,n.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor)),t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}function p(t,e){e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===Rc&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===Rc&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function f(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function m(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}function g(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===Rc&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===Rc&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}return{refreshFogUniforms:e,refreshMaterialUniforms:n}}function cb(){const t=jd("canvas");return t.style.display="block",t}function ub(t={}){const e=void 0!==t.canvas?t.canvas:cb(),n=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,r=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",u=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let h=null,d=null;const p=[],f=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=od,this.physicallyCorrectLights=!1,this.toneMapping=du,this.toneMappingExposure=1;const m=this;let g=!1,v=0,x=0,y=null,_=-1,b=null;const w=new Jd,M=new Jd;let S=null,T=e.width,E=e.height,C=1,A=null,L=null;const R=new Jd(0,0,T,E),P=new Jd(0,0,T,E);let N=!1;const D=[],k=new Am;let I=!1,O=!1,F=null;const U=new Dp,z=new np,H={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function B(){return null===y?C:1}let V,G,W,j,q,X,Y,$,Z,J,K,Q,tt,et,nt,it,rt,ot,at,st,lt,ct,ut,ht=n;function dt(t,n){for(let i=0;i<t.length;i++){const r=t[i],o=e.getContext(r,n);if(null!==o)return o}return null}try{const t={alpha:i,depth:r,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r"+_c),e.addEventListener("webglcontextlost",mt,!1),e.addEventListener("webglcontextrestored",gt,!1),null===ht){const e=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&e.shift(),ht=dt(e,t),null===ht)throw dt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ht.getShaderPrecisionFormat&&(ht.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(It){throw console.error("THREE.WebGLRenderer: "+It.message),It}function pt(){V=new Bx(ht),G=new ux(ht,V,t),V.init(G),ct=new eb(ht,V,G),W=new Q_(ht,V,G),D[0]=1029,j=new Wx(ht),q=new O_,X=new tb(ht,V,W,q,G,ct,j),Y=new dx(m),$=new Hx(m),Z=new Rm(ht,G),ut=new lx(ht,V,Z,G),J=new Vx(ht,Z,j,ut),K=new Zx(ht,J,Z,j),at=new $x(ht,G,X),it=new hx(q),Q=new I_(m,Y,$,V,G,ut,it),tt=new lb(q),et=new H_,nt=new X_(V,G),ot=new sx(m,Y,W,K,s),rt=new K_(m,K,G),st=new cx(ht,V,j,G),lt=new Gx(ht,V,j,G),j.programs=Q.programs,m.capabilities=G,m.extensions=V,m.properties=q,m.renderLists=et,m.shadowMap=rt,m.state=W,m.info=j}pt();const ft=new sb(m,ht);function mt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function gt(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const t=j.autoReset,e=rt.enabled,n=rt.autoUpdate,i=rt.needsUpdate,r=rt.type;pt(),j.autoReset=t,rt.enabled=e,rt.autoUpdate=n,rt.needsUpdate=i,rt.type=r}function vt(t){const e=t.target;e.removeEventListener("dispose",vt),xt(e)}function xt(t){yt(t),q.remove(t)}function yt(t){const e=q.get(t).programs;void 0!==e&&(e.forEach((function(t){Q.releaseProgram(t)})),t.isShaderMaterial&&Q.releaseShaderCache(t))}this.xr=ft,this.getContext=function(){return ht},this.getContextAttributes=function(){return ht.getContextAttributes()},this.forceContextLoss=function(){const t=V.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=V.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(t){void 0!==t&&(C=t,this.setSize(T,E,!1))},this.getSize=function(t){return t.set(T,E)},this.setSize=function(t,n,i){ft.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(T=t,E=n,e.width=Math.floor(t*C),e.height=Math.floor(n*C),!1!==i&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(T*C,E*C).floor()},this.setDrawingBufferSize=function(t,n,i){T=t,E=n,C=i,e.width=Math.floor(t*i),e.height=Math.floor(n*i),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(w)},this.getViewport=function(t){return t.copy(R)},this.setViewport=function(t,e,n,i){t.isVector4?R.set(t.x,t.y,t.z,t.w):R.set(t,e,n,i),W.viewport(w.copy(R).multiplyScalar(C).floor())},this.getScissor=function(t){return t.copy(P)},this.setScissor=function(t,e,n,i){t.isVector4?P.set(t.x,t.y,t.z,t.w):P.set(t,e,n,i),W.scissor(M.copy(P).multiplyScalar(C).floor())},this.getScissorTest=function(){return N},this.setScissorTest=function(t){W.setScissorTest(N=t)},this.setOpaqueSort=function(t){A=t},this.setTransparentSort=function(t){L=t},this.getClearColor=function(t){return t.copy(ot.getClearColor())},this.setClearColor=function(){ot.setClearColor.apply(ot,arguments)},this.getClearAlpha=function(){return ot.getClearAlpha()},this.setClearAlpha=function(){ot.setClearAlpha.apply(ot,arguments)},this.clear=function(t,e,n){let i=0;(void 0===t||t)&&(i|=16384),(void 0===e||e)&&(i|=256),(void 0===n||n)&&(i|=1024),ht.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",mt,!1),e.removeEventListener("webglcontextrestored",gt,!1),et.dispose(),nt.dispose(),q.dispose(),Y.dispose(),$.dispose(),K.dispose(),ut.dispose(),Q.dispose(),ft.dispose(),ft.removeEventListener("sessionstart",wt),ft.removeEventListener("sessionend",Mt),F&&(F.dispose(),F=null),St.stop()},this.renderBufferDirect=function(t,e,n,i,r,o){null===e&&(e=H);const a=r.isMesh&&r.matrixWorld.determinant()<0,s=Nt(t,e,n,i,r);W.setMaterial(i,a);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===i.wireframe&&(l=J.getWireframeAttribute(n),h=2),ut.setup(r,i,s,n,l);let d=st;null!==l&&(u=Z.get(l),d=lt,d.setIndex(u));const p=null!==l?l.count:c.count,f=n.drawRange.start*h,m=n.drawRange.count*h,g=null!==o?o.start*h:0,v=null!==o?o.count*h:1/0,x=Math.max(f,g),y=Math.min(p,f+m,g+v)-1,_=Math.max(0,y-x+1);if(0!==_){if(r.isMesh)!0===i.wireframe?(W.setLineWidth(i.wireframeLinewidth*B()),d.setMode(1)):d.setMode(4);else if(r.isLine){let t=i.linewidth;void 0===t&&(t=1),W.setLineWidth(t*B()),r.isLineSegments?d.setMode(1):r.isLineLoop?d.setMode(2):d.setMode(3)}else r.isPoints?d.setMode(0):r.isSprite&&d.setMode(4);if(r.isInstancedMesh)d.renderInstances(x,_,r.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(x,_,t)}else d.render(x,_)}},this.compile=function(t,e){d=nt.get(t),d.init(),f.push(d),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))})),d.setupLights(m.physicallyCorrectLights),t.traverse((function(e){const n=e.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++){const r=n[i];Rt(r,t,e)}else Rt(n,t,e)})),f.pop(),d=null};let _t=null;function bt(t){_t&&_t(t)}function wt(){St.stop()}function Mt(){St.start()}const St=new Lm;function Tt(t,e,n,i){if(!1===t.visible)return;const r=t.layers.test(e.layers);if(r)if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||k.intersectsSprite(t)){i&&z.setFromMatrixPosition(t.matrixWorld).applyMatrix4(U);const e=K.update(t),r=t.material;r.visible&&h.push(t,e,r,n,z.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==j.render.frame&&(t.skeleton.update(),t.skeleton.frame=j.render.frame),!t.frustumCulled||k.intersectsObject(t))){i&&z.setFromMatrixPosition(t.matrixWorld).applyMatrix4(U);const e=K.update(t),r=t.material;if(Array.isArray(r)){const i=e.groups;for(let o=0,a=i.length;o<a;o++){const a=i[o],s=r[a.materialIndex];s&&s.visible&&h.push(t,e,s,n,z.z,a)}}else r.visible&&h.push(t,e,r,n,z.z,null)}const o=t.children;for(let a=0,s=o.length;a<s;a++)Tt(o[a],e,n,i)}function Et(t,e,n,i){const r=t.opaque,o=t.transmissive,a=t.transparent;d.setupLightsView(n),o.length>0&&Ct(r,e,n),i&&W.viewport(w.copy(i)),r.length>0&&At(r,e,n),o.length>0&&At(o,e,n),a.length>0&&At(a,e,n)}function Ct(t,e,n){if(null===F){const t=!0===a&&!0===G.isWebGL2,e=t?tp:Kd;F=new e(1024,1024,{generateMipmaps:!0,type:null!==ct.convert(Bu)?Bu:ku,minFilter:Du,magFilter:Au,wrapS:Eu,wrapT:Eu,useRenderToTexture:V.has("WEBGL_multisampled_render_to_texture")})}const i=m.getRenderTarget();m.setRenderTarget(F),m.clear();const r=m.toneMapping;m.toneMapping=du,At(t,e,n),m.toneMapping=r,X.updateMultisampleRenderTarget(F),X.updateRenderTargetMipmap(F),m.setRenderTarget(i)}function At(t,e,n){const i=!0===e.isScene?e.overrideMaterial:null;for(let r=0,o=t.length;r<o;r++){const o=t[r],a=o.object,s=o.geometry,l=null===i?o.material:i,c=o.group;a.layers.test(n.layers)&&Lt(a,e,n,s,l,c)}}function Lt(t,e,n,i,r,o){t.onBeforeRender(m,e,n,i,r,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender(m,e,n,i,t,o),!0===r.transparent&&r.side===Pc?(r.side=Rc,r.needsUpdate=!0,m.renderBufferDirect(n,e,i,r,t,o),r.side=Lc,r.needsUpdate=!0,m.renderBufferDirect(n,e,i,r,t,o),r.side=Pc):m.renderBufferDirect(n,e,i,r,t,o),t.onAfterRender(m,e,n,i,r,o)}function Rt(t,e,n){!0!==e.isScene&&(e=H);const i=q.get(t),r=d.state.lights,o=d.state.shadowsArray,a=r.state.version,s=Q.getParameters(t,r.state,o,e,n),l=Q.getProgramCacheKey(s);let c=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=(t.isMeshStandardMaterial?$:Y).get(t.envMap||i.environment),void 0===c&&(t.addEventListener("dispose",vt),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===a)return Pt(t,s),u}else s.uniforms=Q.getUniforms(t),t.onBuild(n,s,m),t.onBeforeCompile(s,m),u=Q.acquireProgram(s,l),c.set(l,u),i.uniforms=s.uniforms;const h=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(h.clippingPlanes=it.uniform),Pt(t,s),i.needsLights=kt(t),i.lightsStateVersion=a,i.needsLights&&(h.ambientLightColor.value=r.state.ambient,h.lightProbe.value=r.state.probe,h.directionalLights.value=r.state.directional,h.directionalLightShadows.value=r.state.directionalShadow,h.spotLights.value=r.state.spot,h.spotLightShadows.value=r.state.spotShadow,h.rectAreaLights.value=r.state.rectArea,h.ltc_1.value=r.state.rectAreaLTC1,h.ltc_2.value=r.state.rectAreaLTC2,h.pointLights.value=r.state.point,h.pointLightShadows.value=r.state.pointShadow,h.hemisphereLights.value=r.state.hemi,h.directionalShadowMap.value=r.state.directionalShadowMap,h.directionalShadowMatrix.value=r.state.directionalShadowMatrix,h.spotShadowMap.value=r.state.spotShadowMap,h.spotShadowMatrix.value=r.state.spotShadowMatrix,h.pointShadowMap.value=r.state.pointShadowMap,h.pointShadowMatrix.value=r.state.pointShadowMatrix);const p=u.getUniforms(),f=i_.seqWithValue(p.seq,h);return i.currentProgram=u,i.uniformsList=f,u}function Pt(t,e){const n=q.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}function Nt(t,e,n,i,r){!0!==e.isScene&&(e=H),X.resetTextureUnits();const o=e.fog,a=i.isMeshStandardMaterial?e.environment:null,s=null===y?m.outputEncoding:y.texture.encoding,l=(i.isMeshStandardMaterial?$:Y).get(i.envMap||a),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!i.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,f=n.morphAttributes.position?n.morphAttributes.position.length:0,g=i.toneMapped?m.toneMapping:du,v=q.get(i),x=d.state.lights;if(!0===I&&(!0===O||t!==b)){const e=t===b&&i.id===_;it.setState(i,t,e)}let w=!1;i.version===v.__version?v.needsLights&&v.lightsStateVersion!==x.state.version||v.outputEncoding!==s||r.isInstancedMesh&&!1===v.instancing?w=!0:r.isInstancedMesh||!0!==v.instancing?r.isSkinnedMesh&&!1===v.skinning?w=!0:r.isSkinnedMesh||!0!==v.skinning?v.envMap!==l||i.fog&&v.fog!==o?w=!0:void 0===v.numClippingPlanes||v.numClippingPlanes===it.numPlanes&&v.numIntersection===it.numIntersection?(v.vertexAlphas!==c||v.vertexTangents!==u||v.morphTargets!==h||v.morphNormals!==p||v.toneMapping!==g||!0===G.isWebGL2&&v.morphTargetsCount!==f)&&(w=!0):w=!0:w=!0:w=!0:(w=!0,v.__version=i.version);let M=v.currentProgram;!0===w&&(M=Rt(i,e,r));let S=!1,T=!1,A=!1;const L=M.getUniforms(),R=v.uniforms;if(W.useProgram(M.program)&&(S=!0,T=!0,A=!0),i.id!==_&&(_=i.id,T=!0),S||b!==t){if(L.setValue(ht,"projectionMatrix",t.projectionMatrix),G.logarithmicDepthBuffer&&L.setValue(ht,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),b!==t&&(b=t,T=!0,A=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){const e=L.map.cameraPosition;void 0!==e&&e.setValue(ht,z.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&L.setValue(ht,"isOrthographic",!0===t.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||r.isSkinnedMesh)&&L.setValue(ht,"viewMatrix",t.matrixWorldInverse)}if(r.isSkinnedMesh){L.setOptional(ht,r,"bindMatrix"),L.setOptional(ht,r,"bindMatrixInverse");const t=r.skeleton;t&&(G.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),L.setValue(ht,"boneTexture",t.boneTexture,X),L.setValue(ht,"boneTextureSize",t.boneTextureSize)):L.setOptional(ht,t,"boneMatrices"))}return!n||void 0===n.morphAttributes.position&&void 0===n.morphAttributes.normal||at.update(r,n,i,M),(T||v.receiveShadow!==r.receiveShadow)&&(v.receiveShadow=r.receiveShadow,L.setValue(ht,"receiveShadow",r.receiveShadow)),T&&(L.setValue(ht,"toneMappingExposure",m.toneMappingExposure),v.needsLights&&Dt(R,A),o&&i.fog&&tt.refreshFogUniforms(R,o),tt.refreshMaterialUniforms(R,i,C,E,F),i_.upload(ht,v.uniformsList,R,X)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(i_.upload(ht,v.uniformsList,R,X),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&L.setValue(ht,"center",r.center),L.setValue(ht,"modelViewMatrix",r.modelViewMatrix),L.setValue(ht,"normalMatrix",r.normalMatrix),L.setValue(ht,"modelMatrix",r.matrixWorld),M}function Dt(t,e){t.ambientLightColor.needsUpdate=e,t.lightProbe.needsUpdate=e,t.directionalLights.needsUpdate=e,t.directionalLightShadows.needsUpdate=e,t.pointLights.needsUpdate=e,t.pointLightShadows.needsUpdate=e,t.spotLights.needsUpdate=e,t.spotLightShadows.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function kt(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}St.setAnimationLoop(bt),"undefined"!==typeof window&&St.setContext(window),this.setAnimationLoop=function(t){_t=t,ft.setAnimationLoop(t),null===t?St.stop():St.start()},ft.addEventListener("sessionstart",wt),ft.addEventListener("sessionend",Mt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===ft.enabled&&!0===ft.isPresenting&&(!0===ft.cameraAutoUpdate&&ft.updateCamera(e),e=ft.getCamera()),!0===t.isScene&&t.onBeforeRender(m,t,e,y),d=nt.get(t,f.length),d.init(),f.push(d),U.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),k.setFromProjectionMatrix(U),O=this.localClippingEnabled,I=it.init(this.clippingPlanes,O,e),h=et.get(t,p.length),h.init(),p.push(h),Tt(t,e,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(A,L),!0===I&&it.beginShadows();const n=d.state.shadowsArray;if(rt.render(n,t,e),!0===I&&it.endShadows(),!0===this.info.autoReset&&this.info.reset(),ot.render(h,t),d.setupLights(m.physicallyCorrectLights),e.isArrayCamera){const n=e.cameras;for(let e=0,i=n.length;e<i;e++){const i=n[e];Et(h,t,i,i.viewport)}}else Et(h,t,e);null!==y&&(X.updateMultisampleRenderTarget(y),X.updateRenderTargetMipmap(y)),!0===t.isScene&&t.onAfterRender(m,t,e),W.buffers.depth.setTest(!0),W.buffers.depth.setMask(!0),W.buffers.color.setMask(!0),W.setPolygonOffset(!1),ut.resetDefaultState(),_=-1,b=null,f.pop(),d=f.length>0?f[f.length-1]:null,p.pop(),h=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return y},this.setRenderTargetTextures=function(t,e,n){q.get(t.texture).__webglTexture=e,q.get(t.depthTexture).__webglTexture=n;const i=q.get(t);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||t.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),t.useRenderToTexture=!1,t.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(t,e){const n=q.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,n=0){y=t,v=e,x=n;let i=!0;if(t){const e=q.get(t);void 0!==e.__useDefaultFramebuffer?(W.bindFramebuffer(36160,null),i=!1):void 0===e.__webglFramebuffer?X.setupRenderTarget(t):e.__hasExternalTextures&&X.rebindTextures(t,q.get(t.texture).__webglTexture,q.get(t.depthTexture).__webglTexture)}let r=null,o=!1,a=!1;if(t){const n=t.texture;(n.isDataTexture3D||n.isDataTexture2DArray)&&(a=!0);const i=q.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=i[e],o=!0):r=t.useRenderbuffer?q.get(t).__webglMultisampledFramebuffer:i,w.copy(t.viewport),M.copy(t.scissor),S=t.scissorTest}else w.copy(R).multiplyScalar(C).floor(),M.copy(P).multiplyScalar(C).floor(),S=N;const s=W.bindFramebuffer(36160,r);if(s&&G.drawBuffers&&i){let e=!1;if(t)if(t.isWebGLMultipleRenderTargets){const n=t.texture;if(D.length!==n.length||36064!==D[0]){for(let t=0,e=n.length;t<e;t++)D[t]=36064+t;D.length=n.length,e=!0}}else 1===D.length&&36064===D[0]||(D[0]=36064,D.length=1,e=!0);else 1===D.length&&1029===D[0]||(D[0]=1029,D.length=1,e=!0);e&&(G.isWebGL2?ht.drawBuffers(D):V.get("WEBGL_draw_buffers").drawBuffersWEBGL(D))}if(W.viewport(w),W.scissor(M),W.setScissorTest(S),o){const i=q.get(t.texture);ht.framebufferTexture2D(36160,36064,34069+e,i.__webglTexture,n)}else if(a){const i=q.get(t.texture),r=e||0;ht.framebufferTextureLayer(36160,36064,i.__webglTexture,n||0,r)}_=-1},this.readRenderTargetPixels=function(t,e,n,i,r,o,a){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=q.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){W.bindFramebuffer(36160,s);try{const a=t.texture,s=a.format,l=a.type;if(s!==Yu&&ct.convert(s)!==ht.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===Bu&&(V.has("EXT_color_buffer_half_float")||G.isWebGL2&&V.has("EXT_color_buffer_float"));if(l!==ku&&ct.convert(l)!==ht.getParameter(35738)&&(l!==Hu||!(G.isWebGL2||V.has("OES_texture_float")||V.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ht.checkFramebufferStatus(36160)?e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&ht.readPixels(e,n,i,r,ct.convert(s),ct.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const t=null!==y?q.get(y).__webglFramebuffer:null;W.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){if(!0!==e.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),o=Math.floor(e.image.height*i);X.setTexture2D(e,0),ht.copyTexSubImage2D(3553,n,0,0,t.x,t.y,r,o),W.unbindTexture()},this.copyTextureToTexture=function(t,e,n,i=0){const r=e.image.width,o=e.image.height,a=ct.convert(n.format),s=ct.convert(n.type);X.setTexture2D(n,0),ht.pixelStorei(37440,n.flipY),ht.pixelStorei(37441,n.premultiplyAlpha),ht.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?ht.texSubImage2D(3553,i,t.x,t.y,r,o,a,s,e.image.data):e.isCompressedTexture?ht.compressedTexSubImage2D(3553,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,a,e.mipmaps[0].data):ht.texSubImage2D(3553,i,t.x,t.y,a,s,e.image),0===i&&n.generateMipmaps&&ht.generateMipmap(3553),W.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,i,r=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const o=t.max.x-t.min.x+1,a=t.max.y-t.min.y+1,s=t.max.z-t.min.z+1,l=ct.convert(i.format),c=ct.convert(i.type);let u;if(i.isDataTexture3D)X.setTexture3D(i,0),u=32879;else{if(!i.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");X.setTexture2DArray(i,0),u=35866}ht.pixelStorei(37440,i.flipY),ht.pixelStorei(37441,i.premultiplyAlpha),ht.pixelStorei(3317,i.unpackAlignment);const h=ht.getParameter(3314),d=ht.getParameter(32878),p=ht.getParameter(3316),f=ht.getParameter(3315),g=ht.getParameter(32877),v=n.isCompressedTexture?n.mipmaps[0]:n.image;ht.pixelStorei(3314,v.width),ht.pixelStorei(32878,v.height),ht.pixelStorei(3316,t.min.x),ht.pixelStorei(3315,t.min.y),ht.pixelStorei(32877,t.min.z),n.isDataTexture||n.isDataTexture3D?ht.texSubImage3D(u,r,e.x,e.y,e.z,o,a,s,l,c,v.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ht.compressedTexSubImage3D(u,r,e.x,e.y,e.z,o,a,s,l,v.data)):ht.texSubImage3D(u,r,e.x,e.y,e.z,o,a,s,l,c,v),ht.pixelStorei(3314,h),ht.pixelStorei(32878,d),ht.pixelStorei(3316,p),ht.pixelStorei(3315,f),ht.pixelStorei(32877,g),0===r&&i.generateMipmaps&&ht.generateMipmap(u),W.unbindTexture()},this.initTexture=function(t){X.setTexture2D(t,0),W.unbindTexture()},this.resetState=function(){v=0,x=0,y=null,W.reset(),ut.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ub.prototype.isWebGLRenderer=!0;class hb extends ub{}hb.prototype.isWebGL1Renderer=!0;class db{constructor(t,e=25e-5){this.name="",this.color=new Tf(t),this.density=e}clone(){return new db(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}db.prototype.isFogExp2=!0;class pb{constructor(t,e=1,n=1e3){this.name="",this.color=new Tf(t),this.near=e,this.far=n}clone(){return new pb(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}pb.prototype.isFog=!0;class fb extends of{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}fb.prototype.isScene=!0;class mb{constructor(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=pd,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=bd()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=bd()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=bd()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}mb.prototype.isInterleavedBuffer=!0;const gb=new np;class vb{constructor(t,e,n,i=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)gb.x=this.getX(e),gb.y=this.getY(e),gb.z=this.getZ(e),gb.applyMatrix4(t),this.setXYZ(e,gb.x,gb.y,gb.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)gb.x=this.getX(e),gb.y=this.getY(e),gb.z=this.getZ(e),gb.applyNormalMatrix(t),this.setXYZ(e,gb.x,gb.y,gb.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)gb.x=this.getX(e),gb.y=this.getY(e),gb.z=this.getZ(e),gb.transformDirection(t),this.setXYZ(e,gb.x,gb.y,gb.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Lf(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new vb(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}vb.prototype.isInterleavedBufferAttribute=!0;class xb extends xf{constructor(t){super(),this.type="SpriteMaterial",this.color=new Tf(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let yb;xb.prototype.isSpriteMaterial=!0;const _b=new np,bb=new np,wb=new np,Mb=new Vd,Sb=new Vd,Tb=new Dp,Eb=new np,Cb=new np,Ab=new np,Lb=new Vd,Rb=new Vd,Pb=new Vd;class Nb extends of{constructor(t){if(super(),this.type="Sprite",void 0===yb){yb=new Bf;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new mb(t,5);yb.setIndex([0,1,2,0,2,3]),yb.setAttribute("position",new vb(e,3,0,!1)),yb.setAttribute("uv",new vb(e,2,3,!1))}this.geometry=yb,this.material=void 0!==t?t:new xb,this.center=new Vd(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),bb.setFromMatrixScale(this.matrixWorld),Tb.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),wb.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&bb.multiplyScalar(-wb.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const o=this.center;Db(Eb.set(-.5,-.5,0),wb,o,bb,i,r),Db(Cb.set(.5,-.5,0),wb,o,bb,i,r),Db(Ab.set(.5,.5,0),wb,o,bb,i,r),Lb.set(0,0),Rb.set(1,0),Pb.set(1,1);let a=t.ray.intersectTriangle(Eb,Cb,Ab,!1,_b);if(null===a&&(Db(Cb.set(-.5,.5,0),wb,o,bb,i,r),Rb.set(0,1),a=t.ray.intersectTriangle(Eb,Ab,Cb,!1,_b),null===a))return;const s=t.ray.origin.distanceTo(_b);s<t.near||s>t.far||e.push({distance:s,point:_b.clone(),uv:gf.getUV(_b,Eb,Cb,Ab,Lb,Rb,Pb,new Vd),face:null,object:this})}copy(t){return super.copy(t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}function Db(t,e,n,i,r,o){Mb.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(Sb.x=o*Mb.x-r*Mb.y,Sb.y=r*Mb.x+o*Mb.y):Sb.copy(Mb),t.copy(e),t.x+=Sb.x,t.y+=Sb.y,t.applyMatrix4(Tb)}Nb.prototype.isSprite=!0;const kb=new np,Ib=new Jd,Ob=new Jd,Fb=new np,Ub=new Dp;class zb extends om{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Dp,this.bindMatrixInverse=new Dp}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Jd,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,i=this.geometry;Ib.fromBufferAttribute(i.attributes.skinIndex,t),Ob.fromBufferAttribute(i.attributes.skinWeight,t),kb.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let r=0;r<4;r++){const t=Ob.getComponent(r);if(0!==t){const i=Ib.getComponent(r);Ub.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),e.addScaledVector(Fb.copy(kb).applyMatrix4(Ub),t)}}return e.applyMatrix4(this.bindMatrixInverse)}}zb.prototype.isSkinnedMesh=!0;class Hb extends of{constructor(){super(),this.type="Bone"}}Hb.prototype.isBone=!0;class Bb extends $d{constructor(t=null,e=1,n=1,i,r,o,a,s,l=Au,c=Au,u,h){super(null,o,a,s,l,c,i,r,u,h),this.image={data:t,width:e,height:n},this.magFilter=l,this.minFilter=c,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Bb.prototype.isDataTexture=!0;const Vb=new Dp,Gb=new Dp;class Wb{constructor(t=[],e=[]){this.uuid=bd(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new Dp)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new Dp;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,o=t.length;r<o;r++){const i=t[r]?t[r].matrixWorld:Gb;Vb.multiplyMatrices(i,e[r]),Vb.toArray(n,16*r)}null!==i&&(i.needsUpdate=!0)}clone(){return new Wb(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=Ud(t),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new Bb(e,t,t,Yu,Hu);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,i=t.bones.length;n<i;n++){const i=t.bones[n];let r=e[i];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),r=new Hb),this.bones.push(r),this.boneInverses.push((new Dp).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let i=0,r=e.length;i<r;i++){const r=e[i];t.bones.push(r.uuid);const o=n[i];t.boneInverses.push(o.toArray())}return t}}class jb extends Lf{constructor(t,e,n,i=1){"number"===typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}jb.prototype.isInstancedBufferAttribute=!0;const qb=new Dp,Xb=new Dp,Yb=[],$b=new om;class Zb extends om{constructor(t,e,n){super(t,e),this.instanceMatrix=new jb(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,i=this.count;if($b.geometry=this.geometry,$b.material=this.material,void 0!==$b.material)for(let r=0;r<i;r++){this.getMatrixAt(r,qb),Xb.multiplyMatrices(n,qb),$b.matrixWorld=Xb,$b.raycast(t,Yb);for(let t=0,n=Yb.length;t<n;t++){const n=Yb[t];n.instanceId=r,n.object=this,e.push(n)}Yb.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new jb(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Zb.prototype.isInstancedMesh=!0;class Jb extends xf{constructor(t){super(),this.type="LineBasicMaterial",this.color=new Tf(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}}Jb.prototype.isLineBasicMaterial=!0;const Kb=new np,Qb=new np,tw=new Dp,ew=new Np,nw=new Sp;class iw extends of{constructor(t=new Bf,e=new Jb){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,i=e.count;t<i;t++)Kb.fromBufferAttribute(e,t-1),Qb.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=Kb.distanceTo(Qb);t.setAttribute("lineDistance",new Df(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),nw.copy(n.boundingSphere),nw.applyMatrix4(i),nw.radius+=r,!1===t.ray.intersectsSphere(nw))return;tw.copy(i).invert(),ew.copy(t.ray).applyMatrix4(tw);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,l=new np,c=new np,u=new np,h=new np,d=this.isLineSegments?2:1;if(n.isBufferGeometry){const i=n.index,r=n.attributes,a=r.position;if(null!==i){const n=Math.max(0,o.start),r=Math.min(i.count,o.start+o.count);for(let o=n,p=r-1;o<p;o+=d){const n=i.getX(o),r=i.getX(o+1);l.fromBufferAttribute(a,n),c.fromBufferAttribute(a,r);const d=ew.distanceSqToSegment(l,c,h,u);if(d>s)continue;h.applyMatrix4(this.matrixWorld);const p=t.ray.origin.distanceTo(h);p<t.near||p>t.far||e.push({distance:p,point:u.clone().applyMatrix4(this.matrixWorld),index:o,face:null,faceIndex:null,object:this})}}else{const n=Math.max(0,o.start),i=Math.min(a.count,o.start+o.count);for(let r=n,o=i-1;r<o;r+=d){l.fromBufferAttribute(a,r),c.fromBufferAttribute(a,r+1);const n=ew.distanceSqToSegment(l,c,h,u);if(n>s)continue;h.applyMatrix4(this.matrixWorld);const i=t.ray.origin.distanceTo(h);i<t.near||i>t.far||e.push({distance:i,point:u.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}iw.prototype.isLine=!0;const rw=new np,ow=new np;class aw extends iw{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,i=e.count;t<i;t+=2)rw.fromBufferAttribute(e,t),ow.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+rw.distanceTo(ow);t.setAttribute("lineDistance",new Df(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}aw.prototype.isLineSegments=!0;class sw extends iw{constructor(t,e){super(t,e),this.type="LineLoop"}}sw.prototype.isLineLoop=!0;class lw extends xf{constructor(t){super(),this.type="PointsMaterial",this.color=new Tf(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this}}lw.prototype.isPointsMaterial=!0;const cw=new Dp,uw=new Np,hw=new Sp,dw=new np;class pw extends of{constructor(t=new Bf,e=new lw){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),hw.copy(n.boundingSphere),hw.applyMatrix4(i),hw.radius+=r,!1===t.ray.intersectsSphere(hw))return;cw.copy(i).invert(),uw.copy(t.ray).applyMatrix4(cw);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a;if(n.isBufferGeometry){const r=n.index,a=n.attributes,l=a.position;if(null!==r){const n=Math.max(0,o.start),a=Math.min(r.count,o.start+o.count);for(let o=n,c=a;o<c;o++){const n=r.getX(o);dw.fromBufferAttribute(l,n),fw(dw,n,s,i,t,e,this)}}else{const n=Math.max(0,o.start),r=Math.min(l.count,o.start+o.count);for(let o=n,a=r;o<a;o++)dw.fromBufferAttribute(l,o),fw(dw,o,s,i,t,e,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function fw(t,e,n,i,r,o,a){const s=uw.distanceSqToPoint(t);if(s<n){const n=new np;uw.closestPointToPoint(t,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;o.push({distance:l,distanceToRay:Math.sqrt(s),point:n,index:e,face:null,object:a})}}pw.prototype.isPoints=!0;class mw extends $d{constructor(t,e,n,i,r,o,a,s,l){super(t,e,n,i,r,o,a,s,l),this.format=void 0!==a?a:Xu,this.minFilter=void 0!==o?o:Pu,this.magFilter=void 0!==r?r:Pu,this.generateMipmaps=!1;const c=this;function u(){c.needsUpdate=!0,t.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image,e="requestVideoFrameCallback"in t;!1===e&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}mw.prototype.isVideoTexture=!0;class gw extends $d{constructor(t,e,n){super({width:t,height:e}),this.format=n,this.magFilter=Au,this.minFilter=Au,this.generateMipmaps=!1,this.needsUpdate=!0}}gw.prototype.isFramebufferTexture=!0;class vw extends $d{constructor(t,e,n,i,r,o,a,s,l,c,u,h){super(null,o,a,s,l,c,i,r,u,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}vw.prototype.isCompressedTexture=!0;class xw extends $d{constructor(t,e,n,i,r,o,a,s,l){super(t,e,n,i,r,o,a,s,l),this.needsUpdate=!0}}xw.prototype.isCanvasTexture=!0;new np,new np,new np,new gf;class yw{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),r=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let i=0;const r=n.length;let o;o=e||t*n[r-1];let a,s=0,l=r-1;while(s<=l)if(i=Math.floor(s+(l-s)/2),a=n[i]-o,a<0)s=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(i=l,n[i]===o)return i/(r-1);const c=n[i],u=n[i+1],h=u-c,d=(o-c)/h,p=(i+d)/(r-1);return p}getTangent(t,e){const n=1e-4;let i=t-n,r=t+n;i<0&&(i=0),r>1&&(r=1);const o=this.getPoint(i),a=this.getPoint(r),s=e||(o.isVector2?new Vd:new np);return s.copy(a).sub(o).normalize(),s}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new np,i=[],r=[],o=[],a=new np,s=new Dp;for(let d=0;d<=t;d++){const e=d/t;i[d]=this.getTangentAt(e,new np)}r[0]=new np,o[0]=new np;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),o[0].crossVectors(i[0],r[0]);for(let d=1;d<=t;d++){if(r[d]=r[d-1].clone(),o[d]=o[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(wd(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(s.makeRotationAxis(a,t))}o[d].crossVectors(i[d],r[d])}if(!0===e){let e=Math.acos(wd(r[0].dot(r[t]),-1,1));e/=t,i[0].dot(a.crossVectors(r[0],r[t]))>0&&(e=-e);for(let n=1;n<=t;n++)r[n].applyMatrix4(s.makeRotationAxis(i[n],e*n)),o[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class _w extends yw{constructor(t=0,e=0,n=1,i=1,r=0,o=2*Math.PI,a=!1,s=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s}getPoint(t,e){const n=e||new Vd,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;while(r<0)r+=i;while(r>i)r-=i;r<Number.EPSILON&&(r=o?0:i),!0!==this.aClockwise||o||(r===i?r=-i:r-=i);const a=this.aStartAngle+t*r;let s=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=s-this.aX,i=l-this.aY;s=n*t-i*e+this.aX,l=n*e+i*t+this.aY}return n.set(s,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}_w.prototype.isEllipseCurve=!0;class bw extends _w{constructor(t,e,n,i,r,o){super(t,e,n,n,i,r,o),this.type="ArcCurve"}}function ww(){let t=0,e=0,n=0,i=0;function r(r,o,a,s){t=r,e=a,n=-3*r+3*o-2*a-s,i=2*r-2*o+a+s}return{initCatmullRom:function(t,e,n,i,o){r(e,n,o*(n-t),o*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,o,a,s){let l=(e-t)/o-(n-t)/(o+a)+(n-e)/a,c=(n-e)/a-(i-e)/(a+s)+(i-n)/s;l*=a,c*=a,r(e,n,l,c)},calc:function(r){const o=r*r,a=o*r;return t+e*r+n*o+i*a}}}bw.prototype.isArcCurve=!0;const Mw=new np,Sw=new ww,Tw=new ww,Ew=new ww;class Cw extends yw{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new np){const n=e,i=this.points,r=i.length,o=(r-(this.closed?0:1))*t;let a,s,l=Math.floor(o),c=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===c&&l===r-1&&(l=r-2,c=1),this.closed||l>0?a=i[(l-1)%r]:(Mw.subVectors(i[0],i[1]).add(i[0]),a=Mw);const u=i[l%r],h=i[(l+1)%r];if(this.closed||l+2<r?s=i[(l+2)%r]:(Mw.subVectors(i[r-1],i[r-2]).add(i[r-1]),s=Mw),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(a.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(h),t),i=Math.pow(h.distanceToSquared(s),t);n<1e-4&&(n=1),e<1e-4&&(e=n),i<1e-4&&(i=n),Sw.initNonuniformCatmullRom(a.x,u.x,h.x,s.x,e,n,i),Tw.initNonuniformCatmullRom(a.y,u.y,h.y,s.y,e,n,i),Ew.initNonuniformCatmullRom(a.z,u.z,h.z,s.z,e,n,i)}else"catmullrom"===this.curveType&&(Sw.initCatmullRom(a.x,u.x,h.x,s.x,this.tension),Tw.initCatmullRom(a.y,u.y,h.y,s.y,this.tension),Ew.initCatmullRom(a.z,u.z,h.z,s.z,this.tension));return n.set(Sw.calc(c),Tw.calc(c),Ew.calc(c)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new np).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Aw(t,e,n,i,r){const o=.5*(i-e),a=.5*(r-n),s=t*t,l=t*s;return(2*n-2*i+o+a)*l+(-3*n+3*i-2*o-a)*s+o*t+n}function Lw(t,e){const n=1-t;return n*n*e}function Rw(t,e){return 2*(1-t)*t*e}function Pw(t,e){return t*t*e}function Nw(t,e,n,i){return Lw(t,e)+Rw(t,n)+Pw(t,i)}function Dw(t,e){const n=1-t;return n*n*n*e}function kw(t,e){const n=1-t;return 3*n*n*t*e}function Iw(t,e){return 3*(1-t)*t*t*e}function Ow(t,e){return t*t*t*e}function Fw(t,e,n,i,r){return Dw(t,e)+kw(t,n)+Iw(t,i)+Ow(t,r)}Cw.prototype.isCatmullRomCurve3=!0;class Uw extends yw{constructor(t=new Vd,e=new Vd,n=new Vd,i=new Vd){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new Vd){const n=e,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(Fw(t,i.x,r.x,o.x,a.x),Fw(t,i.y,r.y,o.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Uw.prototype.isCubicBezierCurve=!0;class zw extends yw{constructor(t=new np,e=new np,n=new np,i=new np){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new np){const n=e,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(Fw(t,i.x,r.x,o.x,a.x),Fw(t,i.y,r.y,o.y,a.y),Fw(t,i.z,r.z,o.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}zw.prototype.isCubicBezierCurve3=!0;class Hw extends yw{constructor(t=new Vd,e=new Vd){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Vd){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new Vd;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Hw.prototype.isLineCurve=!0;class Bw extends yw{constructor(t=new np,e=new np){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new np){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Vw extends yw{constructor(t=new Vd,e=new Vd,n=new Vd){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Vd){const n=e,i=this.v0,r=this.v1,o=this.v2;return n.set(Nw(t,i.x,r.x,o.x),Nw(t,i.y,r.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Vw.prototype.isQuadraticBezierCurve=!0;class Gw extends yw{constructor(t=new np,e=new np,n=new np){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new np){const n=e,i=this.v0,r=this.v1,o=this.v2;return n.set(Nw(t,i.x,r.x,o.x),Nw(t,i.y,r.y,o.y),Nw(t,i.z,r.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Gw.prototype.isQuadraticBezierCurve3=!0;class Ww extends yw{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new Vd){const n=e,i=this.points,r=(i.length-1)*t,o=Math.floor(r),a=r-o,s=i[0===o?o:o-1],l=i[o],c=i[o>i.length-2?i.length-1:o+1],u=i[o>i.length-3?i.length-1:o+2];return n.set(Aw(a,s.x,l.x,c.x,u.x),Aw(a,s.y,l.y,c.y,u.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Vd).fromArray(n))}return this}}Ww.prototype.isSplineCurve=!0;var jw=Object.freeze({__proto__:null,ArcCurve:bw,CatmullRomCurve3:Cw,CubicBezierCurve:Uw,CubicBezierCurve3:zw,EllipseCurve:_w,LineCurve:Hw,LineCurve3:Bw,QuadraticBezierCurve:Vw,QuadraticBezierCurve3:Gw,SplineCurve:Ww});class qw extends yw{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Hw(e,t))}getPoint(t,e){const n=t*this.getLength(),i=this.getCurveLengths();let r=0;while(r<i.length){if(i[r]>=n){const t=i[r]-n,o=this.curves[r],a=o.getLength(),s=0===a?0:1-t/a;return o.getPointAt(s,e)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const o=r[i],a=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a);for(let t=0;t<s.length;t++){const i=s[t];n&&n.equals(i)||(e.push(i),n=i)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new jw[n.type]).fromJSON(n))}return this}}class Xw extends qw{constructor(t){super(),this.type="Path",this.currentPoint=new Vd,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Hw(this.currentPoint.clone(),new Vd(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){const r=new Vw(this.currentPoint.clone(),new Vd(t,e),new Vd(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,o){const a=new Uw(this.currentPoint.clone(),new Vd(t,e),new Vd(n,i),new Vd(r,o));return this.curves.push(a),this.currentPoint.set(r,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Ww(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,o){const a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,n,i,r,o),this}absarc(t,e,n,i,r,o){return this.absellipse(t,e,n,n,i,r,o),this}ellipse(t,e,n,i,r,o,a,s){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,i,r,o,a,s),this}absellipse(t,e,n,i,r,o,a,s){const l=new _w(t,e,n,i,r,o,a,s);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Yw extends Xw{constructor(t){super(t),this.uuid=bd(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new Xw).fromJSON(n))}return this}}const $w={triangulate:function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let o=Zw(t,0,r,n,!0);const a=[];if(!o||o.next===o.prev)return a;let s,l,c,u,h,d,p;if(i&&(o=iM(t,e,o,n)),t.length>80*n){s=c=t[0],l=u=t[1];for(let e=n;e<r;e+=n)h=t[e],d=t[e+1],h<s&&(s=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-s,u-l),p=0!==p?1/p:0}return Kw(o,a,n,s,l,p),a}};function Zw(t,e,n,i,r){let o,a;if(r===EM(t,e,n,i)>0)for(o=e;o<n;o+=i)a=MM(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=MM(o,t[o],t[o+1],a);return a&&mM(a,a.next)&&(SM(a),a=a.next),a}function Jw(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!mM(i,i.next)&&0!==fM(i.prev,i,i.next))i=i.next;else{if(SM(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function Kw(t,e,n,i,r,o,a){if(!t)return;!a&&o&&lM(t,i,r,o);let s,l,c=t;while(t.prev!==t.next)if(s=t.prev,l=t.next,o?tM(t,i,r,o):Qw(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),SM(t),t=l.next,c=l.next;else if(t=l,t===c){a?1===a?(t=eM(Jw(t),e,n),Kw(t,e,n,i,r,o,2)):2===a&&nM(t,e,n,i,r,o):Kw(Jw(t),e,n,i,r,o,1);break}}function Qw(t){const e=t.prev,n=t,i=t.next;if(fM(e,n,i)>=0)return!1;let r=t.next.next;while(r!==t.prev){if(dM(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&fM(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function tM(t,e,n,i){const r=t.prev,o=t,a=t.next;if(fM(r,o,a)>=0)return!1;const s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,c=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,u=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=uM(s,l,e,n,i),d=uM(c,u,e,n,i);let p=t.prevZ,f=t.nextZ;while(p&&p.z>=h&&f&&f.z<=d){if(p!==t.prev&&p!==t.next&&dM(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&fM(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&dM(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&fM(f.prev,f,f.next)>=0)return!1;f=f.nextZ}while(p&&p.z>=h){if(p!==t.prev&&p!==t.next&&dM(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&fM(p.prev,p,p.next)>=0)return!1;p=p.prevZ}while(f&&f.z<=d){if(f!==t.prev&&f!==t.next&&dM(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&fM(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function eM(t,e,n){let i=t;do{const r=i.prev,o=i.next.next;!mM(r,o)&&gM(r,i,i.next,o)&&_M(r,o)&&_M(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),SM(i),SM(i.next),i=t=o),i=i.next}while(i!==t);return Jw(i)}function nM(t,e,n,i,r,o){let a=t;do{let t=a.next.next;while(t!==a.prev){if(a.i!==t.i&&pM(a,t)){let s=wM(a,t);return a=Jw(a,a.next),s=Jw(s,s.next),Kw(a,e,n,i,r,o),void Kw(s,e,n,i,r,o)}t=t.next}a=a.next}while(a!==t)}function iM(t,e,n,i){const r=[];let o,a,s,l,c;for(o=0,a=e.length;o<a;o++)s=e[o]*i,l=o<a-1?e[o+1]*i:t.length,c=Zw(t,s,l,i,!1),c===c.next&&(c.steiner=!0),r.push(hM(c));for(r.sort(rM),o=0;o<r.length;o++)oM(r[o],n),n=Jw(n,n.next);return n}function rM(t,e){return t.x-e.x}function oM(t,e){if(e=aM(t,e),e){const n=wM(e,t);Jw(e,e.next),Jw(n,n.next)}}function aM(t,e){let n=e;const i=t.x,r=t.y;let o,a=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const t=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>a){if(a=t,t===i){if(r===n.y)return n;if(r===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(i===a)return o;const s=o,l=o.x,c=o.y;let u,h=1/0;n=o;do{i>=n.x&&n.x>=l&&i!==n.x&&dM(r<c?i:a,r,l,c,r<c?a:i,r,n.x,n.y)&&(u=Math.abs(r-n.y)/(i-n.x),_M(n,t)&&(u<h||u===h&&(n.x>o.x||n.x===o.x&&sM(o,n)))&&(o=n,h=u)),n=n.next}while(n!==s);return o}function sM(t,e){return fM(t.prev,t,e.prev)<0&&fM(e.next,t,t.next)<0}function lM(t,e,n,i){let r=t;do{null===r.z&&(r.z=uM(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,cM(r)}function cM(t){let e,n,i,r,o,a,s,l,c=1;do{n=t,t=null,o=null,a=0;while(n){for(a++,i=n,s=0,e=0;e<c;e++)if(s++,i=i.nextZ,!i)break;l=c;while(s>0||l>0&&i)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(a>1);return t}function uM(t,e,n,i,r){return t=32767*(t-n)*r,e=32767*(e-i)*r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function hM(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function dM(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function pM(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!yM(t,e)&&(_M(t,e)&&_M(e,t)&&bM(t,e)&&(fM(t.prev,t,e.prev)||fM(t,e.prev,e))||mM(t,e)&&fM(t.prev,t,t.next)>0&&fM(e.prev,e,e.next)>0)}function fM(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function mM(t,e){return t.x===e.x&&t.y===e.y}function gM(t,e,n,i){const r=xM(fM(t,e,n)),o=xM(fM(t,e,i)),a=xM(fM(n,i,t)),s=xM(fM(n,i,e));return r!==o&&a!==s||(!(0!==r||!vM(t,n,e))||(!(0!==o||!vM(t,i,e))||(!(0!==a||!vM(n,t,i))||!(0!==s||!vM(n,e,i)))))}function vM(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function xM(t){return t>0?1:t<0?-1:0}function yM(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&gM(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function _M(t,e){return fM(t.prev,t,t.next)<0?fM(t,e,t.next)>=0&&fM(t,t.prev,e)>=0:fM(t,e,t.prev)<0||fM(t,t.next,e)<0}function bM(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}function wM(t,e){const n=new TM(t.i,t.x,t.y),i=new TM(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function MM(t,e,n,i){const r=new TM(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function SM(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function TM(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function EM(t,e,n,i){let r=0;for(let o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}class CM{static area(t){const e=t.length;let n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n}static isClockWise(t){return CM.area(t)<0}static triangulateShape(t,e){const n=[],i=[],r=[];AM(t),LM(n,t);let o=t.length;e.forEach(AM);for(let s=0;s<e.length;s++)i.push(o),o+=e[s].length,LM(n,e[s]);const a=$w.triangulate(n,i);for(let s=0;s<a.length;s+=3)r.push(a.slice(s,s+3));return r}}function AM(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function LM(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class RM extends Bf{constructor(t=new Yw([new Vd(.5,.5),new Vd(-.5,.5),new Vd(-.5,-.5),new Vd(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,i=[],r=[];for(let a=0,s=t.length;a<s;a++){const e=t[a];o(e)}function o(t){const o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1;let l=void 0!==e.depth?e.depth:1,c=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:.2,h=void 0!==e.bevelSize?e.bevelSize:u-.1,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const f=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:PM;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);let g,v,x,y,_,b=!1;f&&(g=f.getSpacedPoints(s),b=!0,c=!1,v=f.computeFrenetFrames(s,!1),x=new np,y=new np,_=new np),c||(p=0,u=0,h=0,d=0);const w=t.extractPoints(a);let M=w.shape;const S=w.holes,T=!CM.isClockWise(M);if(T){M=M.reverse();for(let t=0,e=S.length;t<e;t++){const e=S[t];CM.isClockWise(e)&&(S[t]=e.reverse())}}const E=CM.triangulateShape(M,S),C=M;for(let e=0,n=S.length;e<n;e++){const t=S[e];M=M.concat(t)}function A(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}const L=M.length,R=E.length;function P(t,e,n){let i,r,o;const a=t.x-e.x,s=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=a*a+s*s,h=a*c-s*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=e.x-s/h,f=e.y+a/h,m=n.x-c/d,g=n.y+l/d,v=((m-p)*c-(g-f)*l)/(a*c-s*l);i=p+a*v-t.x,r=f+s*v-t.y;const x=i*i+r*r;if(x<=2)return new Vd(i,r);o=Math.sqrt(x/2)}else{let t=!1;a>Number.EPSILON?l>Number.EPSILON&&(t=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(s)===Math.sign(c)&&(t=!0),t?(i=-s,r=a,o=Math.sqrt(u)):(i=a,r=s,o=Math.sqrt(u/2))}return new Vd(i/o,r/o)}const N=[];for(let e=0,n=C.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),N[e]=P(C[e],C[i],C[r]);const D=[];let k,I=N.concat();for(let e=0,n=S.length;e<n;e++){const t=S[e];k=[];for(let e=0,n=t.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),k[e]=P(t[e],t[i],t[r]);D.push(k),I=I.concat(k)}for(let e=0;e<p;e++){const t=e/p,n=u*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,r=C.length;e<r;e++){const t=A(C[e],N[e],i);H(t.x,t.y,-n)}for(let e=0,r=S.length;e<r;e++){const t=S[e];k=D[e];for(let e=0,r=t.length;e<r;e++){const r=A(t[e],k[e],i);H(r.x,r.y,-n)}}}const O=h+d;for(let e=0;e<L;e++){const t=c?A(M[e],I[e],O):M[e];b?(y.copy(v.normals[0]).multiplyScalar(t.x),x.copy(v.binormals[0]).multiplyScalar(t.y),_.copy(g[0]).add(y).add(x),H(_.x,_.y,_.z)):H(t.x,t.y,0)}for(let e=1;e<=s;e++)for(let t=0;t<L;t++){const n=c?A(M[t],I[t],O):M[t];b?(y.copy(v.normals[e]).multiplyScalar(n.x),x.copy(v.binormals[e]).multiplyScalar(n.y),_.copy(g[e]).add(y).add(x),H(_.x,_.y,_.z)):H(n.x,n.y,l/s*e)}for(let e=p-1;e>=0;e--){const t=e/p,n=u*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,r=C.length;e<r;e++){const t=A(C[e],N[e],i);H(t.x,t.y,l+n)}for(let e=0,r=S.length;e<r;e++){const t=S[e];k=D[e];for(let e=0,r=t.length;e<r;e++){const r=A(t[e],k[e],i);b?H(r.x,r.y+g[s-1].y,g[s-1].x+n):H(r.x,r.y,l+n)}}}function F(){const t=i.length/3;if(c){let t=0,e=L*t;for(let n=0;n<R;n++){const t=E[n];B(t[2]+e,t[1]+e,t[0]+e)}t=s+2*p,e=L*t;for(let n=0;n<R;n++){const t=E[n];B(t[0]+e,t[1]+e,t[2]+e)}}else{for(let t=0;t<R;t++){const e=E[t];B(e[2],e[1],e[0])}for(let t=0;t<R;t++){const e=E[t];B(e[0]+L*s,e[1]+L*s,e[2]+L*s)}}n.addGroup(t,i.length/3-t,0)}function U(){const t=i.length/3;let e=0;z(C,e),e+=C.length;for(let n=0,i=S.length;n<i;n++){const t=S[n];z(t,e),e+=t.length}n.addGroup(t,i.length/3-t,1)}function z(t,e){let n=t.length;while(--n>=0){const i=n;let r=n-1;r<0&&(r=t.length-1);for(let t=0,n=s+2*p;t<n;t++){const n=L*t,o=L*(t+1),a=e+i+n,s=e+r+n,l=e+r+o,c=e+i+o;V(a,s,l,c)}}}function H(t,e,n){o.push(t),o.push(e),o.push(n)}function B(t,e,r){G(t),G(e),G(r);const o=i.length/3,a=m.generateTopUV(n,i,o-3,o-2,o-1);W(a[0]),W(a[1]),W(a[2])}function V(t,e,r,o){G(t),G(e),G(o),G(e),G(r),G(o);const a=i.length/3,s=m.generateSideWallUV(n,i,a-6,a-3,a-2,a-1);W(s[0]),W(s[1]),W(s[3]),W(s[1]),W(s[2]),W(s[3])}function G(t){i.push(o[3*t+0]),i.push(o[3*t+1]),i.push(o[3*t+2])}function W(t){r.push(t.x),r.push(t.y)}F(),U()}this.setAttribute("position",new Df(i,3)),this.setAttribute("uv",new Df(r,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON(),e=this.parameters.shapes,n=this.parameters.options;return NM(e,n,t)}static fromJSON(t,e){const n=[];for(let r=0,o=t.shapes.length;r<o;r++){const i=e[t.shapes[r]];n.push(i)}const i=t.options.extrudePath;return void 0!==i&&(t.options.extrudePath=(new jw[i.type]).fromJSON(i)),new RM(n,t.options)}}const PM={generateTopUV:function(t,e,n,i,r){const o=e[3*n],a=e[3*n+1],s=e[3*i],l=e[3*i+1],c=e[3*r],u=e[3*r+1];return[new Vd(o,a),new Vd(s,l),new Vd(c,u)]},generateSideWallUV:function(t,e,n,i,r,o){const a=e[3*n],s=e[3*n+1],l=e[3*n+2],c=e[3*i],u=e[3*i+1],h=e[3*i+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*o],g=e[3*o+1],v=e[3*o+2];return Math.abs(s-u)<Math.abs(a-c)?[new Vd(a,1-l),new Vd(c,1-h),new Vd(d,1-f),new Vd(m,1-v)]:[new Vd(s,1-l),new Vd(u,1-h),new Vd(p,1-f),new Vd(g,1-v)]}};function NM(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const e=t[i];n.shapes.push(e.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class DM extends Bf{constructor(t=new Yw([new Vd(0,.5),new Vd(-.5,-.5),new Vd(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],i=[],r=[],o=[];let a=0,s=0;if(!1===Array.isArray(t))l(t);else for(let c=0;c<t.length;c++)l(t[c]),this.addGroup(a,s,c),a+=s,s=0;function l(t){const a=i.length/3,l=t.extractPoints(e);let c=l.shape;const u=l.holes;!1===CM.isClockWise(c)&&(c=c.reverse());for(let e=0,n=u.length;e<n;e++){const t=u[e];!0===CM.isClockWise(t)&&(u[e]=t.reverse())}const h=CM.triangulateShape(c,u);for(let e=0,n=u.length;e<n;e++){const t=u[e];c=c.concat(t)}for(let e=0,n=c.length;e<n;e++){const t=c[e];i.push(t.x,t.y,0),r.push(0,0,1),o.push(t.x,t.y)}for(let e=0,i=h.length;e<i;e++){const t=h[e],i=t[0]+a,r=t[1]+a,o=t[2]+a;n.push(i,r,o),s+=3}}this.setIndex(n),this.setAttribute("position",new Df(i,3)),this.setAttribute("normal",new Df(r,3)),this.setAttribute("uv",new Df(o,2))}toJSON(){const t=super.toJSON(),e=this.parameters.shapes;return kM(e,t)}static fromJSON(t,e){const n=[];for(let i=0,r=t.shapes.length;i<r;i++){const r=e[t.shapes[i]];n.push(r)}return new DM(n,t.curveSegments)}}function kM(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}class IM extends xf{constructor(t){super(),this.type="ShadowMaterial",this.color=new Tf(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}IM.prototype.isShadowMaterial=!0;class OM extends xf{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Tf(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tf(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new Vd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}OM.prototype.isMeshStandardMaterial=!0;class FM extends OM{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vd(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return wd(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new Tf(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Tf(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Tf(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!==t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!==t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!==t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}FM.prototype.isMeshPhysicalMaterial=!0;class UM extends xf{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new Tf(16777215),this.specular=new Tf(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tf(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new Vd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=cu,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}UM.prototype.isMeshPhongMaterial=!0;class zM extends xf{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Tf(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tf(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new Vd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}zM.prototype.isMeshToonMaterial=!0;class HM extends xf{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new Vd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}HM.prototype.isMeshNormalMaterial=!0;class BM extends xf{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new Tf(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tf(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=cu,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}BM.prototype.isMeshLambertMaterial=!0;class VM extends xf{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Tf(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new Vd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this}}VM.prototype.isMeshMatcapMaterial=!0;class GM extends Jb{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}GM.prototype.isLineDashedMaterial=!0;const WM={arraySlice:function(t,e,n){return WM.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,n){return t[e]-t[n]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i},sortedArray:function(t,e,n){const i=t.length,r=new t.constructor(i);for(let o=0,a=0;a!==i;++o){const i=n[o]*e;for(let n=0;n!==e;++n)r[a++]=t[i+n]}return r},flattenJSON:function(t,e,n,i){let r=1,o=t[0];while(void 0!==o&&void 0===o[i])o=t[r++];if(void 0===o)return;let a=o[i];if(void 0!==a)if(Array.isArray(a))do{a=o[i],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[r++]}while(void 0!==o);else if(void 0!==a.toArray)do{a=o[i],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[r++]}while(void 0!==o);else do{a=o[i],void 0!==a&&(e.push(o.time),n.push(a)),o=t[r++]}while(void 0!==o)},subclip:function(t,e,n,i,r=30){const o=t.clone();o.name=e;const a=[];for(let l=0;l<o.tracks.length;++l){const t=o.tracks[l],e=t.getValueSize(),s=[],c=[];for(let o=0;o<t.times.length;++o){const a=t.times[o]*r;if(!(a<n||a>=i)){s.push(t.times[o]);for(let n=0;n<e;++n)c.push(t.values[o*e+n])}}0!==s.length&&(t.times=WM.convertArray(s,t.times.constructor),t.values=WM.convertArray(c,t.values.constructor),a.push(t))}o.tracks=a;let s=1/0;for(let l=0;l<o.tracks.length;++l)s>o.tracks[l].times[0]&&(s=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*s);return o.resetDuration(),o},makeClipAdditive:function(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,o=e/i;for(let a=0;a<r;++a){const e=n.tracks[a],i=e.ValueTypeName;if("bool"===i||"string"===i)continue;const r=t.tracks.find((function(t){return t.name===e.name&&t.ValueTypeName===i}));if(void 0===r)continue;let s=0;const l=e.getValueSize();e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=l/3);let c=0;const u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=e.times.length-1;let d;if(o<=e.times[0]){const t=s,n=l-s;d=WM.arraySlice(e.values,t,n)}else if(o>=e.times[h]){const t=h*l+s,n=t+l-s;d=WM.arraySlice(e.values,t,n)}else{const t=e.createInterpolant(),n=s,i=l-s;t.evaluate(o),d=WM.arraySlice(t.resultBuffer,n,i)}if("quaternion"===i){const t=(new ep).fromArray(d).normalize().conjugate();t.toArray(d)}const p=r.times.length;for(let t=0;t<p;++t){const e=t*u+c;if("quaternion"===i)ep.multiplyQuaternionsFlat(r.values,e,d,0,r.values,e);else{const t=u-2*c;for(let n=0;n<t;++n)r.values[e+n]-=d[n]}}}return t.blendMode=ed,t}};class jM{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{let o;n:{i:if(!(t<i)){for(let o=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===o)break;if(r=i,i=e[++n],t<i)break e}o=e.length;break n}if(t>=r)break t;{const a=e[1];t<a&&(n=2,r=a);for(let o=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===o)break;if(i=r,r=e[--n-1],t>=r)break e}o=n,n=0}}while(n<o){const i=n+o>>>1;t<e[i]?o=i:n=i+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let o=0;o!==i;++o)e[o]=n[r+o];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}jM.prototype.beforeStart_=jM.prototype.copySampleValue_,jM.prototype.afterEnd_=jM.prototype.copySampleValue_;class qM extends jM{constructor(t,e,n,i){super(t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Jh,endingEnd:Jh}}intervalChanged_(t,e,n){const i=this.parameterPositions;let r=t-2,o=t+1,a=i[r],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case Kh:r=t,a=2*e-n;break;case Qh:r=i.length-2,a=e+i[r]-i[r+1];break;default:r=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Kh:o=t,s=2*n-e;break;case Qh:o=1,s=n+i[1]-i[0];break;default:o=t-1,s=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(s-n),this._offsetPrev=r*c,this._offsetNext=o*c}interpolate_(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-e)/(i-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,x=(-1-d)*m+(1.5+d)*f+.5*p,y=d*m-d*f;for(let _=0;_!==a;++_)r[_]=g*o[c+_]+v*o[l+_]+x*o[s+_]+y*o[u+_];return r}}class XM extends jM{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=(n-e)/(i-e),u=1-c;for(let h=0;h!==a;++h)r[h]=o[l+h]*u+o[s+h]*c;return r}}class YM extends jM{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class $M{constructor(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=WM.convertArray(e,this.TimeBufferType),this.values=WM.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:WM.convertArray(t.times,Array),values:WM.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new YM(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new XM(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new qM(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case Yh:e=this.InterpolantFactoryMethodDiscrete;break;case $h:e=this.InterpolantFactoryMethodLinear;break;case Zh:e=this.InterpolantFactoryMethodSmooth;break}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Yh;case this.InterpolantFactoryMethodLinear:return $h;case this.InterpolantFactoryMethodSmooth:return Zh}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){const n=this.times,i=n.length;let r=0,o=i-1;while(r!==i&&n[r]<t)++r;while(-1!==o&&n[o]>e)--o;if(++o,0!==r||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);const t=this.getValueSize();this.times=WM.arraySlice(n,r,o),this.values=WM.arraySlice(this.values,r*t,o*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let a=0;a!==r;a++){const e=n[a];if("number"===typeof e&&isNaN(e)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,e),t=!1;break}if(null!==o&&o>e){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,e,o),t=!1;break}o=e}if(void 0!==i&&WM.isTypedArray(i))for(let a=0,s=i.length;a!==s;++a){const e=i[a];if(isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,e),t=!1;break}}return t}optimize(){const t=WM.arraySlice(this.times),e=WM.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===Zh,r=t.length-1;let o=1;for(let a=1;a<r;++a){let r=!1;const s=t[a],l=t[a+1];if(s!==l&&(1!==a||s!==t[0]))if(i)r=!0;else{const t=a*n,i=t-n,o=t+n;for(let a=0;a!==n;++a){const n=e[t+a];if(n!==e[i+a]||n!==e[o+a]){r=!0;break}}}if(r){if(a!==o){t[o]=t[a];const i=a*n,r=o*n;for(let t=0;t!==n;++t)e[r+t]=e[i+t]}++o}}if(r>0){t[o]=t[r];for(let t=r*n,i=o*n,a=0;a!==n;++a)e[i+a]=e[t+a];++o}return o!==t.length?(this.times=WM.arraySlice(t,0,o),this.values=WM.arraySlice(e,0,o*n)):(this.times=t,this.values=e),this}clone(){const t=WM.arraySlice(this.times,0),e=WM.arraySlice(this.values,0),n=this.constructor,i=new n(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}}$M.prototype.TimeBufferType=Float32Array,$M.prototype.ValueBufferType=Float32Array,$M.prototype.DefaultInterpolation=$h;class ZM extends $M{}ZM.prototype.ValueTypeName="bool",ZM.prototype.ValueBufferType=Array,ZM.prototype.DefaultInterpolation=Yh,ZM.prototype.InterpolantFactoryMethodLinear=void 0,ZM.prototype.InterpolantFactoryMethodSmooth=void 0;class JM extends $M{}JM.prototype.ValueTypeName="color";class KM extends $M{}KM.prototype.ValueTypeName="number";class QM extends jM{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-e)/(i-e);let l=t*a;for(let c=l+a;l!==c;l+=4)ep.slerpFlat(r,0,o,l-a,o,l,s);return r}}class tS extends $M{InterpolantFactoryMethodLinear(t){return new QM(this.times,this.values,this.getValueSize(),t)}}tS.prototype.ValueTypeName="quaternion",tS.prototype.DefaultInterpolation=$h,tS.prototype.InterpolantFactoryMethodSmooth=void 0;class eS extends $M{}eS.prototype.ValueTypeName="string",eS.prototype.ValueBufferType=Array,eS.prototype.DefaultInterpolation=Yh,eS.prototype.InterpolantFactoryMethodLinear=void 0,eS.prototype.InterpolantFactoryMethodSmooth=void 0;class nS extends $M{}nS.prototype.ValueTypeName="vector";class iS{constructor(t,e=-1,n,i=td){this.name=t,this.tracks=n,this.duration=e,this.blendMode=i,this.uuid=bd(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,i=1/(t.fps||1);for(let o=0,a=n.length;o!==a;++o)e.push(oS(n[o]).scale(i));const r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){const e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let r=0,o=n.length;r!==o;++r)e.push($M.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(t,e,n,i){const r=e.length,o=[];for(let a=0;a<r;a++){let t=[],s=[];t.push((a+r-1)%r,a,(a+1)%r),s.push(0,1,0);const l=WM.getKeyframeOrder(t);t=WM.sortedArray(t,1,l),s=WM.sortedArray(s,1,l),i||0!==t[0]||(t.push(r),s.push(s[0])),o.push(new KM(".morphTargetInfluences["+e[a].name+"]",t,s).scale(1/n))}return new this(t,-1,o)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,s=t.length;a<s;a++){const e=t[a],n=e.name.match(r);if(n&&n.length>1){const t=n[1];let r=i[t];r||(i[t]=r=[]),r.push(e)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],e,n));return o}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,i,r){if(0!==n.length){const o=[],a=[];WM.flattenJSON(n,o,a,i),0!==o.length&&r.push(new t(e,o,a))}},i=[],r=t.name||"default",o=t.fps||30,a=t.blendMode;let s=t.length||-1;const l=t.hierarchy||[];for(let u=0;u<l.length;u++){const t=l[u].keys;if(t&&0!==t.length)if(t[0].morphTargets){const e={};let n;for(n=0;n<t.length;n++)if(t[n].morphTargets)for(let i=0;i<t[n].morphTargets.length;i++)e[t[n].morphTargets[i]]=-1;for(const r in e){const e=[],o=[];for(let i=0;i!==t[n].morphTargets.length;++i){const i=t[n];e.push(i.time),o.push(i.morphTarget===r?1:0)}i.push(new KM(".morphTargetInfluence["+r+"]",e,o))}s=e.length*(o||1)}else{const r=".bones["+e[u].name+"]";n(nS,r+".position",t,"pos",i),n(tS,r+".quaternion",t,"rot",i),n(nS,r+".scale",t,"scl",i)}}if(0===i.length)return null;const c=new this(r,s,i,a);return c}resetDuration(){const t=this.tracks;let e=0;for(let n=0,i=t.length;n!==i;++n){const t=this.tracks[n];e=Math.max(e,t.times[t.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function rS(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return KM;case"vector":case"vector2":case"vector3":case"vector4":return nS;case"color":return JM;case"quaternion":return tS;case"bool":case"boolean":return ZM;case"string":return eS}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function oS(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=rS(t.type);if(void 0===t.times){const e=[],n=[];WM.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const aS={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class sS{constructor(t,e,n){const i=this;let r=!1,o=0,a=0,s=void 0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===r&&void 0!==i.onStart&&i.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}}const lS=new sS;class cS{constructor(t){this.manager=void 0!==t?t:lS,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(i,r){n.load(t,i,e,r)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const uS={};class hS extends cS{constructor(t){super(t)}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=aS.get(t);if(void 0!==r)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(void 0!==uS[t])return void uS[t].push({onLoad:e,onProgress:n,onError:i});uS[t]=[],uS[t].push({onLoad:e,onProgress:n,onError:i});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(o).then(e=>{if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===e.body.getReader)return e;const n=uS[t],i=e.body.getReader(),r=e.headers.get("Content-Length"),o=r?parseInt(r):0,a=0!==o;let s=0;const l=new ReadableStream({start(t){function e(){i.read().then(({done:i,value:r})=>{if(i)t.close();else{s+=r.byteLength;const i=new ProgressEvent("progress",{lengthComputable:a,loaded:s,total:o});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(i)}t.enqueue(r),e()}})}e()}});return new Response(l)}throw Error(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`)}).then(t=>{switch(this.responseType){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then(t=>{const e=new DOMParser;return e.parseFromString(t,this.mimeType)});case"json":return t.json();default:return t.text()}}).then(e=>{aS.add(t,e);const n=uS[t];delete uS[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onLoad&&i.onLoad(e)}}).catch(e=>{const n=uS[t];if(void 0===n)throw this.manager.itemError(t),e;delete uS[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class dS extends cS{constructor(t){super(t)}load(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,o=aS.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout((function(){e&&e(o),r.manager.itemEnd(t)}),0),o;const a=jd("img");function s(){c(),aS.add(t,this),e&&e(this),r.manager.itemEnd(t)}function l(e){c(),i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}function c(){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",s,!1),a.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a}}class pS extends cS{constructor(t){super(t)}load(t,e,n,i){const r=new _m,o=new dS(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function s(n){o.load(t[n],(function(t){r.images[n]=t,a++,6===a&&(r.needsUpdate=!0,e&&e(r))}),void 0,i)}for(let l=0;l<t.length;++l)s(l);return r}}class fS extends cS{constructor(t){super(t)}load(t,e,n,i){const r=new $d,o=new dS(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)}),n,i),r}}class mS extends of{constructor(t,e=1){super(),this.type="Light",this.color=new Tf(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}mS.prototype.isLight=!0;class gS extends mS{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(of.DefaultUp),this.updateMatrix(),this.groundColor=new Tf(e)}copy(t){return mS.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}gS.prototype.isHemisphereLight=!0;const vS=new Dp,xS=new np,yS=new np;class _S{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vd(512,512),this.map=null,this.mapPass=null,this.matrix=new Dp,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Am,this._frameExtents=new Vd(1,1),this._viewportCount=1,this._viewports=[new Jd(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;xS.setFromMatrixPosition(t.matrixWorld),e.position.copy(xS),yS.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(yS),e.updateMatrixWorld(),vS.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vS),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class bS extends _S{constructor(){super(new gm(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*_d*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}bS.prototype.isSpotLightShadow=!0;class wS extends mS{constructor(t,e,n=0,i=Math.PI/3,r=0,o=1){super(t,e),this.type="SpotLight",this.position.copy(of.DefaultUp),this.updateMatrix(),this.target=new of,this.distance=n,this.angle=i,this.penumbra=r,this.decay=o,this.shadow=new bS}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}wS.prototype.isSpotLight=!0;const MS=new Dp,SS=new np,TS=new np;class ES extends _S{constructor(){super(new gm(90,1,.5,500)),this._frameExtents=new Vd(4,2),this._viewportCount=6,this._viewports=[new Jd(2,1,1,1),new Jd(0,1,1,1),new Jd(3,1,1,1),new Jd(1,1,1,1),new Jd(3,0,1,1),new Jd(1,0,1,1)],this._cubeDirections=[new np(1,0,0),new np(-1,0,0),new np(0,0,1),new np(0,0,-1),new np(0,1,0),new np(0,-1,0)],this._cubeUps=[new np(0,1,0),new np(0,1,0),new np(0,1,0),new np(0,1,0),new np(0,0,1),new np(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),SS.setFromMatrixPosition(t.matrixWorld),n.position.copy(SS),TS.copy(n.position),TS.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(TS),n.updateMatrixWorld(),i.makeTranslation(-SS.x,-SS.y,-SS.z),MS.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MS)}}ES.prototype.isPointLightShadow=!0;class CS extends mS{constructor(t,e,n=0,i=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new ES}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}CS.prototype.isPointLight=!0;class AS extends _S{constructor(){super(new px(-5,5,5,-5,.5,500))}}AS.prototype.isDirectionalLightShadow=!0;class LS extends mS{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(of.DefaultUp),this.updateMatrix(),this.target=new of,this.shadow=new AS}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}LS.prototype.isDirectionalLight=!0;class RS extends mS{constructor(t,e){super(t,e),this.type="AmbientLight"}}RS.prototype.isAmbientLight=!0;class PS extends mS{constructor(t,e,n=10,i=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}PS.prototype.isRectAreaLight=!0;class NS{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new np)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,i=t.y,r=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*i),e.addScaledVector(o[2],.488603*r),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*i*1.092548),e.addScaledVector(o[5],i*r*1.092548),e.addScaledVector(o[6],.315392*(3*r*r-1)),e.addScaledVector(o[7],n*r*1.092548),e.addScaledVector(o[8],.546274*(n*n-i*i)),e}getIrradianceAt(t,e){const n=t.x,i=t.y,r=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*i),e.addScaledVector(o[2],1.023328*r),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*i),e.addScaledVector(o[5],.858086*i*r),e.addScaledVector(o[6],.743125*r*r-.247708),e.addScaledVector(o[7],.858086*n*r),e.addScaledVector(o[8],.429043*(n*n-i*i)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(t,e+3*i);return this}toArray(t=[],e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(t,e+3*i);return t}static getBasisAt(t,e){const n=t.x,i=t.y,r=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*r,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*n*r,e[8]=.546274*(n*n-i*i)}}NS.prototype.isSphericalHarmonics3=!0;class DS extends mS{constructor(t=new NS,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}DS.prototype.isLightProbe=!0;class kS{static decodeText(t){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let i=0,r=t.length;i<r;i++)e+=String.fromCharCode(t[i]);try{return decodeURIComponent(escape(e))}catch(n){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}static resolveURL(t,e){return"string"!==typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class IS extends Bf{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}IS.prototype.isInstancedBufferGeometry=!0;class OS extends cS{constructor(t){super(t),"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,o=aS.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout((function(){e&&e(o),r.manager.itemEnd(t)}),0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(r.options,{colorSpaceConversion:"none"}))})).then((function(n){aS.add(t,n),e&&e(n),r.manager.itemEnd(t)})).catch((function(e){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)})),r.manager.itemStart(t)}}let FS;OS.prototype.isImageBitmapLoader=!0;const US={getContext:function(){return void 0===FS&&(FS=new(window.AudioContext||window.webkitAudioContext)),FS},setContext:function(t){FS=t}};class zS extends cS{constructor(t){super(t)}load(t,e,n,i){const r=this,o=new hS(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(n){try{const t=n.slice(0),i=US.getContext();i.decodeAudioData(t,(function(t){e(t)}))}catch(o){i?i(o):console.error(o),r.manager.itemError(t)}}),n,i)}}class HS extends DS{constructor(t,e,n=1){super(void 0,n);const i=(new Tf).set(t),r=(new Tf).set(e),o=new np(i.r,i.g,i.b),a=new np(r.r,r.g,r.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(l)}}HS.prototype.isHemisphereLightProbe=!0;class BS extends DS{constructor(t,e=1){super(void 0,e);const n=(new Tf).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}BS.prototype.isAmbientLightProbe=!0;class VS{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=GS(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=GS();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}function GS(){return("undefined"===typeof performance?Date:performance).now()}class WS extends of{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}class jS{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}class qS{constructor(t,e,n){let i,r,o;switch(this.binding=t,this.valueSize=n,e){case"quaternion":i=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,i=this.valueSize,r=t*i+i;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==i;++t)n[r+t]=n[t];o=e}else{o+=e;const t=e/o;this._mixBufferRegion(n,r,0,t,i)}this.cumulativeWeight=o}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const t=e*this._origIndex;this._mixBufferRegion(n,i,t,1-r,e)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let s=e,l=e+e;s!==l;++s)if(n[s]!==n[s+e]){a.setValue(n,i);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,i=n*this._origIndex;t.getValue(e,i);for(let r=n,o=i;r!==o;++r)e[r]=e[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,i,r){if(i>=.5)for(let o=0;o!==r;++o)t[e+o]=t[n+o]}_slerp(t,e,n,i){ep.slerpFlat(t,e,t,e,t,n,i)}_slerpAdditive(t,e,n,i,r){const o=this._workIndex*r;ep.multiplyQuaternionsFlat(t,o,t,e,t,n),ep.slerpFlat(t,e,t,e,t,o,i)}_lerp(t,e,n,i,r){const o=1-i;for(let a=0;a!==r;++a){const r=e+a;t[r]=t[r]*o+t[n+a]*i}}_lerpAdditive(t,e,n,i,r){for(let o=0;o!==r;++o){const r=e+o;t[r]=t[r]+t[n+o]*i}}}const XS="\\[\\]\\.:\\/",YS=new RegExp("["+XS+"]","g"),$S="[^"+XS+"]",ZS="[^"+XS.replace("\\.","")+"]",JS=/((?:WC+[\/:])*)/.source.replace("WC",$S),KS=/(WCOD+)?/.source.replace("WCOD",ZS),QS=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",$S),tT=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",$S),eT=new RegExp("^"+JS+KS+QS+tT+"$"),nT=["material","materials","bones"];class iT{constructor(t,e,n){const i=n||rT.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}class rT{constructor(t,e,n){this.path=e,this.parsedPath=n||rT.parseTrackName(e),this.node=rT.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new rT.Composite(t,e,n):new rT(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(YS,"")}static parseTrackName(t){const e=eT.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const t=n.nodeName.substring(i+1);-1!==nT.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.name===e||r.uuid===e)return r;const o=n(r.children);if(o)return o}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=rT.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==i){if(void 0===t[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[i]}}const o=t[i];if(void 0===o){const n=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",t)}let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}s=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(s=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}rT.Composite=iT,rT.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},rT.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},rT.prototype.GetterByBindingType=[rT.prototype._getValue_direct,rT.prototype._getValue_array,rT.prototype._getValue_arrayElement,rT.prototype._getValue_toArray],rT.prototype.SetterByBindingTypeAndVersioning=[[rT.prototype._setValue_direct,rT.prototype._setValue_direct_setNeedsUpdate,rT.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[rT.prototype._setValue_array,rT.prototype._setValue_array_setNeedsUpdate,rT.prototype._setValue_array_setMatrixWorldNeedsUpdate],[rT.prototype._setValue_arrayElement,rT.prototype._setValue_arrayElement_setNeedsUpdate,rT.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[rT.prototype._setValue_fromArray,rT.prototype._setValue_fromArray_setNeedsUpdate,rT.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class oT{constructor(){this.uuid=bd(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let n=0,i=arguments.length;n!==i;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,o=r.length;let a=void 0,s=t.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=e[h];if(void 0===d){d=s++,e[h]=d,t.push(u);for(let t=0,e=o;t!==e;++t)r[t].push(new rT(u,n[t],i[t]))}else if(d<l){a=t[d];const s=--l,c=t[s];e[c.uuid]=d,t[d]=c,e[h]=s,t[s]=u;for(let t=0,e=o;t!==e;++t){const e=r[t],o=e[s];let a=e[d];e[d]=o,void 0===a&&(a=new rT(u,n[t],i[t])),e[s]=a}}else t[d]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o],s=a.uuid,l=e[s];if(void 0!==l&&l>=r){const o=r++,c=t[o];e[c.uuid]=l,t[l]=c,e[s]=o,t[o]=a;for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[o],r=e[l];e[l]=i,e[o]=r}}}this.nCachedObjects_=r}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,o=t.length;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a],l=s.uuid,c=e[l];if(void 0!==c)if(delete e[l],c<r){const a=--r,s=t[a],l=--o,u=t[l];e[s.uuid]=c,t[c]=s,e[u.uuid]=a,t[a]=u,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[a],r=e[l];e[c]=i,e[a]=r,e.pop()}}else{const r=--o,a=t[r];r>0&&(e[a.uuid]=c),t[c]=a,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t];e[c]=e[r],e.pop()}}}this.nCachedObjects_=r}subscribe_(t,e){const n=this._bindingsIndicesByPath;let i=n[t];const r=this._bindings;if(void 0!==i)return r[i];const o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);i=r.length,n[t]=i,o.push(t),a.push(e),r.push(u);for(let h=c,d=s.length;h!==d;++h){const n=s[h];u[h]=new rT(n,t,e)}return u}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a],l=t[a];e[l]=n,o[n]=s,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}}oT.prototype.isAnimationObjectGroup=!0;class aT{constructor(t,e,n=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=i;const r=e.tracks,o=r.length,a=new Array(o),s={endingStart:Jh,endingEnd:Jh};for(let l=0;l!==o;++l){const t=r[l].createInterpolant(null);a[l]=t,t.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qh,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,i=t._clip.duration,r=i/n,o=n/i;t.warp(1,r,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const i=this._mixer,r=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,l=a.sampleValues;return s[0]=r,s[1]=r+n,l[0]=t/o,l[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,i){if(!this.enabled)return void this._updateWeight(t);const r=this._startTime;if(null!==r){const i=(t-r)*n;if(i<0||0===n)return;this._startTime=null,e=n*i}e*=this._updateTimeScale(t);const o=this._updateTime(e),a=this._updateWeight(t);if(a>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case ed:for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(o),e[n].accumulateAdditive(a);break;case td:default:for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(o),e[n].accumulate(i,a)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){const i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let i=this.time+t,r=this._loopCount;const o=n===Xh;if(0===t)return-1===r?i:o&&1===(1&r)?e-i:i;if(n===jh){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i>=e)i=e;else{if(!(i<0)){this.time=i;break t}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),i>=e||i<0){const n=Math.floor(i/e);i-=e*n,r+=Math.abs(n);const a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(o&&1===(1&r))return e-i}return i}_setEndings(t,e,n){const i=this._interpolantSettings;n?(i.endingStart=Kh,i.endingEnd=Kh):(i.endingStart=t?this.zeroSlopeAtStart?Kh:Jh:Qh,i.endingEnd=e?this.zeroSlopeAtEnd?Kh:Jh:Qh)}_scheduleFading(t,e,n){const i=this._mixer,r=i.time;let o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=e,a[1]=r+t,s[1]=n,this}}class sT extends gd{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,l=this._bindingsByRootAndName;let c=l[s];void 0===c&&(c={},l[s]=c);for(let u=0;u!==r;++u){const t=i[u],r=t.name;let l=c[r];if(void 0!==l)o[u]=l;else{if(l=o[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,s,r));continue}const i=e&&e._propertyBindings[u].binding.parsedPath;l=new qS(rT.create(n,r,i),t.ValueTypeName,t.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,s,r),o[u]=l}a[u].resultBuffer=l.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const i=this._actions,r=this._actionsByClip;let o=r[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=i.length,i.push(t),o.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,l=s[s.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),t._byClipCacheIndex=null;const u=a.actionByRoot,h=(t._localRoot||this._root).uuid;delete u[h],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){const t=e[n];0===--t.referenceCount&&this._removeInactiveBinding(t)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_addInactiveBinding(t,e,n){const i=this._bindingsByRootAndName,r=this._bindings;let o=i[e];void 0===o&&(o={},i[e]=o),o[n]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],s=e[e.length-1],l=t._cacheIndex;s._cacheIndex=l,e[l]=s,e.pop(),delete a[r],0===Object.keys(a).length&&delete o[i]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new XM(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r}clipAction(t,e,n){const i=e||this._root,r=i.uuid;let o="string"===typeof t?iS.findByName(i,t):t;const a=null!==o?o.uuid:t,s=this._actionsByClip[a];let l=null;if(void 0===n&&(n=null!==o?o.blendMode:td),void 0!==s){const t=s.actionByRoot[r];if(void 0!==t&&t.blendMode===n)return t;l=s.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const c=new aT(this,o,e,n);return this._bindAction(c,l),this._addInactiveAction(c,a,r),c}existingAction(t,e){const n=e||this._root,i=n.uuid,r="string"===typeof t?iS.findByName(n,t):t,o=r?r.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[i]||null}stopAllAction(){const t=this._actions,e=this._nActiveActions;for(let n=e-1;n>=0;--n)t[n].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1;for(let l=0;l!==n;++l){const n=e[l];n._update(i,t,r,o)}const a=this._bindings,s=this._nActiveBindings;for(let l=0;l!==s;++l)a[l].apply(o);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const t=r.knownActions;for(let n=0,i=t.length;n!==i;++n){const i=t[n];this._deactivateAction(i);const r=i._cacheIndex,o=e[e.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,o._cacheIndex=r,e[r]=o,e.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const o in n){const t=n[o].actionByRoot,i=t[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}const i=this._bindingsByRootAndName,r=i[e];if(void 0!==r)for(const o in r){const t=r[o];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}sT.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class lT{constructor(t){"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new lT(void 0===this.value.clone?this.value:this.value.clone())}}class cT extends mb{constructor(t,e,n=1){super(t,e),this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}cT.prototype.isInstancedInterleavedBuffer=!0;class uT{constructor(t,e,n,i,r){this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}uT.prototype.isGLBufferAttribute=!0;class hT{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(wd(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const dT=new Vd;class pT{constructor(t=new Vd(1/0,1/0),e=new Vd(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=dT.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){const e=dT.copy(t).clamp(this.min,this.max);return e.sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}pT.prototype.isBox2=!0;const fT=new np,mT=new np;class gT{constructor(t=new np,e=new np){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){fT.subVectors(t,this.start),mT.subVectors(this.end,this.start);const n=mT.dot(mT),i=mT.dot(fT);let r=i/n;return e&&(r=wd(r,0,1)),r}closestPointToPoint(t,e,n){const i=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const vT=new np,xT=new Dp,yT=new Dp;class _T extends aw{constructor(t){const e=bT(t),n=new Bf,i=[],r=[],o=new Tf(0,0,1),a=new Tf(0,1,0);for(let l=0;l<e.length;l++){const t=e[l];t.parent&&t.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}n.setAttribute("position",new Df(i,3)),n.setAttribute("color",new Df(r,3));const s=new Jb({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,s),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,i=n.getAttribute("position");yT.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<e.length;r++){const t=e[r];t.parent&&t.parent.isBone&&(xT.multiplyMatrices(yT,t.matrixWorld),vT.setFromMatrixPosition(xT),i.setXYZ(o,vT.x,vT.y,vT.z),xT.multiplyMatrices(yT,t.parent.matrixWorld),vT.setFromMatrixPosition(xT),i.setXYZ(o+1,vT.x,vT.y,vT.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}function bT(t){const e=[];t&&t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,bT(t.children[n]));return e}class wT extends aw{constructor(t=10,e=10,n=4473924,i=8947848){n=new Tf(n),i=new Tf(i);const r=e/2,o=t/e,a=t/2,s=[],l=[];for(let h=0,d=0,p=-a;h<=e;h++,p+=o){s.push(-a,0,p,a,0,p),s.push(p,0,-a,p,0,a);const t=h===r?n:i;t.toArray(l,d),d+=3,t.toArray(l,d),d+=3,t.toArray(l,d),d+=3,t.toArray(l,d),d+=3}const c=new Bf;c.setAttribute("position",new Df(s,3)),c.setAttribute("color",new Df(l,3));const u=new Jb({vertexColors:!0,toneMapped:!1});super(c,u),this.type="GridHelper"}}const MT=new Float32Array(1);new Int32Array(MT.buffer);yw.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(yw.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Xw.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)},wT.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},_T.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},cS.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),kS.extractUrlBase(t)},cS.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},pT.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},pT.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},pT.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},pT.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},op.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},op.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},op.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},op.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},op.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},Sp.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Am.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},gT.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Gd.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Gd.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Gd.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Gd.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Gd.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Gd.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Dp.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},Dp.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Dp.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new np).setFromMatrixColumn(this,3)},Dp.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},Dp.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Dp.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Dp.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Dp.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Dp.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},Dp.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Dp.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Dp.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Dp.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Dp.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Dp.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Dp.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Dp.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Dp.prototype.makeFrustum=function(t,e,n,i,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,i,n,r,o)},Dp.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Tm.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},ep.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},ep.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Np.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Np.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},Np.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},gf.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},gf.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},gf.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},gf.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},gf.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},gf.barycoordFromPoint=function(t,e,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),gf.getBarycoord(t,e,n,i,r)},gf.normal=function(t,e,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),gf.getNormal(t,e,n,i)},Yw.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},Yw.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new RM(this,t)},Yw.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new DM(this,t)},Vd.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Vd.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},Vd.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},np.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},np.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},np.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},np.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},np.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},np.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},np.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},np.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},np.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Jd.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Jd.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},of.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},of.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},of.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},of.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},of.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(of.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),om.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(om.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),nd},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),zb.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},gm.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(mS.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Lf.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===fd},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(fd)}}}),Lf.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?fd:pd),this},Lf.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Lf.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Bf.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},Bf.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Lf(arguments[1],arguments[2])))},Bf.prototype.addDrawCall=function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},Bf.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Bf.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Bf.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},Bf.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(Bf.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),mb.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?fd:pd),this},mb.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},RM.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},RM.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},RM.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},fb.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},lT.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(xf.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Tf}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===Nc}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(fm.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),ub.prototype.clearTarget=function(t,e,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,i)},ub.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},ub.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ub.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ub.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ub.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ub.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ub.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ub.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ub.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ub.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ub.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ub.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ub.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ub.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},ub.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ub.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ub.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ub.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ub.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ub.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ub.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ub.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ub.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ub.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ub.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?ad:od}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(K_.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Kd.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),WS.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this,n=new zS;return n.load(t,(function(t){e.setBuffer(t)})),this},jS.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ym.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},ym.prototype.clear=function(t,e,n,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,i)},Xd.crossOrigin=void 0,Xd.loadTexture=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new fS;r.setCrossOrigin(this.crossOrigin);const o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},Xd.loadTextureCube=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new pS;r.setCrossOrigin(this.crossOrigin);const o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},Xd.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Xd.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:_c}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=_c);class ST extends cS{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(t){return new LT(t)})),this.register((function(t){return new IT(t)})),this.register((function(t){return new OT(t)})),this.register((function(t){return new RT(t)})),this.register((function(t){return new PT(t)})),this.register((function(t){return new NT(t)})),this.register((function(t){return new DT(t)})),this.register((function(t){return new kT(t)})),this.register((function(t){return new CT(t)})),this.register((function(t){return new FT(t)}))}load(t,e,n,i){const r=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:kS.extractUrlBase(t),this.manager.itemStart(t);const a=function(e){i?i(e):console.error(e),r.manager.itemError(t),r.manager.itemEnd(t)},s=new hS(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{r.parse(n,o,(function(n){e(n),r.manager.itemEnd(t)}),a)}catch(i){a(i)}}),n,a)}setDRACOLoader(t){return this.dracoLoader=t,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this}unregister(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,e,n,i){let r;const o={},a={};if("string"===typeof t)r=t;else{const e=kS.decodeText(new Uint8Array(t,0,4));if(e===UT){try{o[ET.KHR_BINARY_GLTF]=new BT(t)}catch(c){return void(i&&i(c))}r=o[ET.KHR_BINARY_GLTF].content}else r=kS.decodeText(new Uint8Array(t))}const s=JSON.parse(r);if(void 0===s.asset||s.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new pE(s,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const t=this.pluginCallbacks[u](l);a[t.name]=t,o[t.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const t=s.extensionsUsed[u],e=s.extensionsRequired||[];switch(t){case ET.KHR_MATERIALS_UNLIT:o[t]=new AT;break;case ET.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[t]=new jT;break;case ET.KHR_DRACO_MESH_COMPRESSION:o[t]=new VT(s,this.dracoLoader);break;case ET.KHR_TEXTURE_TRANSFORM:o[t]=new GT;break;case ET.KHR_MESH_QUANTIZATION:o[t]=new qT;break;default:e.indexOf(t)>=0&&void 0===a[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(n,i)}parseAsync(t,e){const n=this;return new Promise((function(i,r){n.parse(t,e,i,r)}))}}function TT(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const ET={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class CT{constructor(t){this.parser=t,this.name=ET.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,e=this.parser.json.nodes||[];for(let n=0,i=e.length;n<i;n++){const i=e[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&t._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(t){const e=this.parser,n="light:"+t;let i=e.cache.get(n);if(i)return i;const r=e.json,o=r.extensions&&r.extensions[this.name]||{},a=o.lights||[],s=a[t];let l;const c=new Tf(16777215);void 0!==s.color&&c.fromArray(s.color);const u=void 0!==s.range?s.range:0;switch(s.type){case"directional":l=new LS(c),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new CS(c),l.distance=u;break;case"spot":l=new wS(c),l.distance=u,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,l.angle=s.spot.outerConeAngle,l.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return l.position.set(0,0,0),l.decay=2,void 0!==s.intensity&&(l.intensity=s.intensity),l.name=e.createUniqueName(s.name||"light_"+t),i=Promise.resolve(l),e.cache.add(n,i),i}createNodeAttachment(t){const e=this,n=this.parser,i=n.json,r=i.nodes[t],o=r.extensions&&r.extensions[this.name]||{},a=o.light;return void 0===a?null:this._loadLight(a).then((function(t){return n._getNodeRef(e.cache,a,t)}))}}class AT{constructor(){this.name=ET.KHR_MATERIALS_UNLIT}getMaterialType(){return Ef}extendParams(t,e,n){const i=[];t.color=new Tf(1,1,1),t.opacity=1;const r=e.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const e=r.baseColorFactor;t.color.fromArray(e),t.opacity=e[3]}void 0!==r.baseColorTexture&&i.push(n.assignTexture(t,"map",r.baseColorTexture))}return Promise.all(i)}}class LT{constructor(t){this.parser=t,this.name=ET.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?FM:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];if(void 0!==o.clearcoatFactor&&(e.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&r.push(n.assignTexture(e,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(e.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&r.push(n.assignTexture(e,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(r.push(n.assignTexture(e,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const t=o.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new Vd(t,t)}return Promise.all(r)}}class RT{constructor(t){this.parser=t,this.name=ET.KHR_MATERIALS_SHEEN}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?FM:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[];e.sheenColor=new Tf(0,0,0),e.sheenRoughness=0,e.sheen=1;const o=i.extensions[this.name];return void 0!==o.sheenColorFactor&&e.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(e.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&r.push(n.assignTexture(e,"sheenColorMap",o.sheenColorTexture)),void 0!==o.sheenRoughnessTexture&&r.push(n.assignTexture(e,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}}class PT{constructor(t){this.parser=t,this.name=ET.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?FM:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];return void 0!==o.transmissionFactor&&(e.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&r.push(n.assignTexture(e,"transmissionMap",o.transmissionTexture)),Promise.all(r)}}class NT{constructor(t){this.parser=t,this.name=ET.KHR_MATERIALS_VOLUME}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?FM:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];e.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&r.push(n.assignTexture(e,"thicknessMap",o.thicknessTexture)),e.attenuationDistance=o.attenuationDistance||0;const a=o.attenuationColor||[1,1,1];return e.attenuationColor=new Tf(a[0],a[1],a[2]),Promise.all(r)}}class DT{constructor(t){this.parser=t,this.name=ET.KHR_MATERIALS_IOR}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?FM:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name];return e.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class kT{constructor(t){this.parser=t,this.name=ET.KHR_MATERIALS_SPECULAR}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?FM:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];e.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&r.push(n.assignTexture(e,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return e.specularColor=new Tf(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&r.push(n.assignTexture(e,"specularColorMap",o.specularColorTexture).then((function(t){t.encoding=ad}))),Promise.all(r)}}class IT{constructor(t){this.parser=t,this.name=ET.KHR_TEXTURE_BASISU}loadTexture(t){const e=this.parser,n=e.json,i=n.textures[t];if(!i.extensions||!i.extensions[this.name])return null;const r=i.extensions[this.name],o=n.images[r.source],a=e.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,o,a)}}class OT{constructor(t){this.parser=t,this.name=ET.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(t){const e=this.name,n=this.parser,i=n.json,r=i.textures[t];if(!r.extensions||!r.extensions[e])return null;const o=r.extensions[e],a=i.images[o.source];let s=n.textureLoader;if(a.uri){const t=n.options.manager.getHandler(a.uri);null!==t&&(s=t)}return this.detectSupport().then((function(r){if(r)return n.loadTextureImage(t,a,s);if(i.extensionsRequired&&i.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(t){const e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported}}class FT{constructor(t){this.name=ET.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){const t=n.extensions[this.name],i=this.parser.getDependency("buffer",t.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,r.ready]).then((function(e){const n=t.byteOffset||0,i=t.byteLength||0,o=t.count,a=t.byteStride,s=new ArrayBuffer(o*a),l=new Uint8Array(e[0],n,i);return r.decodeGltfBuffer(new Uint8Array(s),o,a,l,t.mode,t.filter),s}))}return null}}const UT="glTF",zT=12,HT={JSON:1313821514,BIN:5130562};class BT{constructor(t){this.name=ET.KHR_BINARY_GLTF,this.content=null,this.body=null;const e=new DataView(t,0,zT);if(this.header={magic:kS.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==UT)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-zT,i=new DataView(t,zT);let r=0;while(r<n){const e=i.getUint32(r,!0);r+=4;const n=i.getUint32(r,!0);if(r+=4,n===HT.JSON){const n=new Uint8Array(t,zT+r,e);this.content=kS.decodeText(n)}else if(n===HT.BIN){const n=zT+r;this.body=t.slice(n,n+e)}r+=e}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class VT{constructor(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ET.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(t,e){const n=this.json,i=this.dracoLoader,r=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,a={},s={},l={};for(const c in o){const t=eE[c]||c.toLowerCase();a[t]=o[c]}for(const c in t.attributes){const e=eE[c]||c.toLowerCase();if(void 0!==o[c]){const i=n.accessors[t.attributes[c]],r=JT[i.componentType];l[e]=r,s[e]=!0===i.normalized}}return e.getDependency("bufferView",r).then((function(t){return new Promise((function(e){i.decodeDracoFile(t,(function(t){for(const e in t.attributes){const n=t.attributes[e],i=s[e];void 0!==i&&(n.normalized=i)}e(t)}),a,l)}))}))}}class GT{constructor(){this.name=ET.KHR_TEXTURE_TRANSFORM}extendTexture(t,e){return void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===e.offset&&void 0===e.rotation&&void 0===e.scale||(t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),t.needsUpdate=!0),t}}class WT extends OM{constructor(t){super(),this.isGLTFSpecularGlossinessMaterial=!0;const e=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),r=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new Tf).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(t){for(const e in a)t.uniforms[e]=a[e];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",e).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",r).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(t){a.specular.value=t}},specularMap:{get:function(){return a.specularMap.value},set:function(t){a.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(t){a.glossiness.value=t}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(t){a.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}copy(t){return super.copy(t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class jT{constructor(){this.name=ET.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return WT}extendParams(t,e,n){const i=e.extensions[this.name];t.color=new Tf(1,1,1),t.opacity=1;const r=[];if(Array.isArray(i.diffuseFactor)){const e=i.diffuseFactor;t.color.fromArray(e),t.opacity=e[3]}if(void 0!==i.diffuseTexture&&r.push(n.assignTexture(t,"map",i.diffuseTexture)),t.emissive=new Tf(0,0,0),t.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,t.specular=new Tf(1,1,1),Array.isArray(i.specularFactor)&&t.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){const e=i.specularGlossinessTexture;r.push(n.assignTexture(t,"glossinessMap",e)),r.push(n.assignTexture(t,"specularMap",e))}return Promise.all(r)}createMaterial(t){const e=new WT(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=cd,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}class qT{constructor(){this.name=ET.KHR_MESH_QUANTIZATION}}class XT extends jM{constructor(t,e,n,i){super(t,e,n,i)}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i*3+i;for(let o=0;o!==i;o++)e[o]=n[r+o];return e}}XT.prototype.beforeStart_=XT.prototype.copySampleValue_,XT.prototype.afterEnd_=XT.prototype.copySampleValue_,XT.prototype.interpolate_=function(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,l=3*a,c=i-e,u=(n-e)/c,h=u*u,d=h*u,p=t*l,f=p-l,m=-2*d+3*h,g=d-h,v=1-m,x=g-h+u;for(let y=0;y!==a;y++){const t=o[f+y+a],e=o[f+y+s]*c,n=o[p+y+a],i=o[p+y]*c;r[y]=v*t+x*e+m*n+g*i}return r};const YT=new ep;class $T extends XT{interpolate_(t,e,n,i){const r=super.interpolate_(t,e,n,i);return YT.fromArray(r).normalize().toArray(r),r}}const ZT={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},JT={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},KT={9728:Au,9729:Pu,9984:Lu,9985:Nu,9986:Ru,9987:Du},QT={33071:Eu,33648:Cu,10497:Tu},tE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},eE={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},nE={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},iE={CUBICSPLINE:void 0,LINEAR:$h,STEP:Yh},rE={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function oE(t){return void 0===t["DefaultMaterial"]&&(t["DefaultMaterial"]=new OM({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Lc})),t["DefaultMaterial"]}function aE(t,e,n){for(const i in n.extensions)void 0===t[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=n.extensions[i])}function sE(t,e){void 0!==e.extras&&("object"===typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function lE(t,e,n){let i=!1,r=!1;for(let s=0,l=e.length;s<l;s++){const t=e[s];if(void 0!==t.POSITION&&(i=!0),void 0!==t.NORMAL&&(r=!0),i&&r)break}if(!i&&!r)return Promise.resolve(t);const o=[],a=[];for(let s=0,l=e.length;s<l;s++){const l=e[s];if(i){const e=void 0!==l.POSITION?n.getDependency("accessor",l.POSITION):t.attributes.position;o.push(e)}if(r){const e=void 0!==l.NORMAL?n.getDependency("accessor",l.NORMAL):t.attributes.normal;a.push(e)}}return Promise.all([Promise.all(o),Promise.all(a)]).then((function(e){const n=e[0],o=e[1];return i&&(t.morphAttributes.position=n),r&&(t.morphAttributes.normal=o),t.morphTargetsRelative=!0,t}))}function cE(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(let n=0,i=e.weights.length;n<i;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let e=0,i=n.length;e<i;e++)t.morphTargetDictionary[n[e]]=e}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function uE(t){const e=t.extensions&&t.extensions[ET.KHR_DRACO_MESH_COMPRESSION];let n;return n=e?"draco:"+e.bufferView+":"+e.indices+":"+hE(e.attributes):t.indices+":"+hE(t.attributes)+":"+t.mode,n}function hE(t){let e="";const n=Object.keys(t).sort();for(let i=0,r=n.length;i<r;i++)e+=n[i]+":"+t[n[i]]+";";return e}function dE(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class pE{constructor(t={},e={}){this.json=t,this.extensions={},this.plugins={},this.options=e,this.cache=new TT,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!==typeof createImageBitmap&&!1===/Firefox|Safari/.test(navigator.userAgent)?this.textureLoader=new OS(this.options.manager):this.textureLoader=new fS(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new hS(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,e){const n=this,i=this.json,r=this.extensions;this.cache.removeAll(),this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all(this._invokeAll((function(t){return t.beforeRoot&&t.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(e){const o={scene:e[0][i.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:i.asset,parser:n,userData:{}};aE(r,o,i),sE(o,i),Promise.all(n._invokeAll((function(t){return t.afterRoot&&t.afterRoot(o)}))).then((function(){t(o)}))})).catch(e)}_markDefs(){const t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[];for(let i=0,r=e.length;i<r;i++){const n=e[i].joints;for(let e=0,i=n.length;e<i;e++)t[n[e]].isBone=!0}for(let i=0,r=t.length;i<r;i++){const e=t[i];void 0!==e.mesh&&(this._addNodeRef(this.meshCache,e.mesh),void 0!==e.skin&&(n[e.mesh].isSkinnedMesh=!0)),void 0!==e.camera&&this._addNodeRef(this.cameraCache,e.camera)}}_addNodeRef(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)}_getNodeRef(t,e,n){if(t.refs[e]<=1)return n;const i=n.clone(),r=(t,e)=>{const n=this.associations.get(t);null!=n&&this.associations.set(e,n);for(const[i,o]of t.children.entries())r(o,e.children[i])};return r(n,i),i.name+="_instance_"+t.uses[e]++,i}_invokeOne(t){const e=Object.values(this.plugins);e.push(this);for(let n=0;n<e.length;n++){const i=t(e[n]);if(i)return i}return null}_invokeAll(t){const e=Object.values(this.plugins);e.unshift(this);const n=[];for(let i=0;i<e.length;i++){const r=t(e[i]);r&&n.push(r)}return n}getDependency(t,e){const n=t+":"+e;let i=this.cache.get(n);if(!i){switch(t){case"scene":i=this.loadScene(e);break;case"node":i=this.loadNode(e);break;case"mesh":i=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(e)}));break;case"accessor":i=this.loadAccessor(e);break;case"bufferView":i=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(e)}));break;case"buffer":i=this.loadBuffer(e);break;case"material":i=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(e)}));break;case"texture":i=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(e)}));break;case"skin":i=this.loadSkin(e);break;case"animation":i=this.loadAnimation(e);break;case"camera":i=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,i)}return i}getDependencies(t){let e=this.cache.get(t);if(!e){const n=this,i=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(i.map((function(e,i){return n.getDependency(t,i)}))),this.cache.add(t,e)}return e}loadBuffer(t){const e=this.json.buffers[t],n=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[ET.KHR_BINARY_GLTF].body);const i=this.options;return new Promise((function(t,r){n.load(kS.resolveURL(e.uri,i.path),t,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))}loadBufferView(t){const e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){const n=e.byteLength||0,i=e.byteOffset||0;return t.slice(i,i+n)}))}loadAccessor(t){const e=this,n=this.json,i=this.json.accessors[t];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);const r=[];return void 0!==i.bufferView?r.push(this.getDependency("bufferView",i.bufferView)):r.push(null),void 0!==i.sparse&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then((function(t){const r=t[0],o=tE[i.type],a=JT[i.componentType],s=a.BYTES_PER_ELEMENT,l=s*o,c=i.byteOffset||0,u=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,h=!0===i.normalized;let d,p;if(u&&u!==l){const t=Math.floor(c/u),n="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+t+":"+i.count;let l=e.cache.get(n);l||(d=new a(r,t*u,i.count*u/s),l=new mb(d,u/s),e.cache.add(n,l)),p=new vb(l,o,c%u/s,h)}else d=null===r?new a(i.count*o):new a(r,c,i.count*o),p=new Lf(d,o,h);if(void 0!==i.sparse){const e=tE.SCALAR,n=JT[i.sparse.indices.componentType],s=i.sparse.indices.byteOffset||0,l=i.sparse.values.byteOffset||0,c=new n(t[1],s,i.sparse.count*e),u=new a(t[2],l,i.sparse.count*o);null!==r&&(p=new Lf(p.array.slice(),p.itemSize,p.normalized));for(let t=0,i=c.length;t<i;t++){const e=c[t];if(p.setX(e,u[t*o]),o>=2&&p.setY(e,u[t*o+1]),o>=3&&p.setZ(e,u[t*o+2]),o>=4&&p.setW(e,u[t*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p}))}loadTexture(t){const e=this.json,n=this.options,i=e.textures[t],r=e.images[i.source];let o=this.textureLoader;if(r.uri){const t=n.manager.getHandler(r.uri);null!==t&&(o=t)}return this.loadTextureImage(t,r,o)}loadTextureImage(t,e,n){const i=this,r=this.json,o=this.options,a=r.textures[t],s=(e.uri||e.bufferView)+":"+a.sampler;if(this.textureCache[s])return this.textureCache[s];const l=self.URL||self.webkitURL;let c=e.uri||"",u=!1;if(void 0!==e.bufferView)c=i.getDependency("bufferView",e.bufferView).then((function(t){u=!0;const n=new Blob([t],{type:e.mimeType});return c=l.createObjectURL(n),c}));else if(void 0===e.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const h=Promise.resolve(c).then((function(t){return new Promise((function(e,i){let r=e;!0===n.isImageBitmapLoader&&(r=function(t){const n=new $d(t);n.needsUpdate=!0,e(n)}),n.load(kS.resolveURL(t,o.path),r,void 0,i)}))})).then((function(e){!0===u&&l.revokeObjectURL(c),e.flipY=!1,a.name&&(e.name=a.name);const n=r.samplers||{},o=n[a.sampler]||{};return e.magFilter=KT[o.magFilter]||Pu,e.minFilter=KT[o.minFilter]||Du,e.wrapS=QT[o.wrapS]||Tu,e.wrapT=QT[o.wrapT]||Tu,i.associations.set(e,{textures:t}),e})).catch((function(){return console.error("THREE.GLTFLoader: Couldn't load texture",c),null}));return this.textureCache[s]=h,h}assignTexture(t,e,n){const i=this;return this.getDependency("texture",n.index).then((function(r){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===e&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+e+" not yet supported."),i.extensions[ET.KHR_TEXTURE_TRANSFORM]){const t=void 0!==n.extensions?n.extensions[ET.KHR_TEXTURE_TRANSFORM]:void 0;if(t){const e=i.associations.get(r);r=i.extensions[ET.KHR_TEXTURE_TRANSFORM].extendTexture(r,t),i.associations.set(r,e)}}return t[e]=r,r}))}assignFinalMaterial(t){const e=t.geometry;let n=t.material;const i=void 0===e.attributes.tangent,r=void 0!==e.attributes.color,o=void 0===e.attributes.normal;if(t.isPoints){const t="PointsMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new lw,xf.prototype.copy.call(e,n),e.color.copy(n.color),e.map=n.map,e.sizeAttenuation=!1,this.cache.add(t,e)),n=e}else if(t.isLine){const t="LineBasicMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new Jb,xf.prototype.copy.call(e,n),e.color.copy(n.color),this.cache.add(t,e)),n=e}if(i||r||o){let t="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(t+="specular-glossiness:"),i&&(t+="derivative-tangents:"),r&&(t+="vertex-colors:"),o&&(t+="flat-shading:");let e=this.cache.get(t);e||(e=n.clone(),r&&(e.vertexColors=!0),o&&(e.flatShading=!0),i&&(e.normalScale&&(e.normalScale.y*=-1),e.clearcoatNormalScale&&(e.clearcoatNormalScale.y*=-1)),this.cache.add(t,e),this.associations.set(e,this.associations.get(n))),n=e}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=n}getMaterialType(){return OM}loadMaterial(t){const e=this,n=this.json,i=this.extensions,r=n.materials[t];let o;const a={},s=r.extensions||{},l=[];if(s[ET.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const t=i[ET.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=t.getMaterialType(),l.push(t.extendParams(a,r,e))}else if(s[ET.KHR_MATERIALS_UNLIT]){const t=i[ET.KHR_MATERIALS_UNLIT];o=t.getMaterialType(),l.push(t.extendParams(a,r,e))}else{const n=r.pbrMetallicRoughness||{};if(a.color=new Tf(1,1,1),a.opacity=1,Array.isArray(n.baseColorFactor)){const t=n.baseColorFactor;a.color.fromArray(t),a.opacity=t[3]}void 0!==n.baseColorTexture&&l.push(e.assignTexture(a,"map",n.baseColorTexture)),a.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,a.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(l.push(e.assignTexture(a,"metalnessMap",n.metallicRoughnessTexture)),l.push(e.assignTexture(a,"roughnessMap",n.metallicRoughnessTexture))),o=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),l.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,a)}))))}!0===r.doubleSided&&(a.side=Pc);const c=r.alphaMode||rE.OPAQUE;if(c===rE.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.format=Xu,a.transparent=!1,c===rE.MASK&&(a.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&o!==Ef&&(l.push(e.assignTexture(a,"normalMap",r.normalTexture)),a.normalScale=new Vd(1,1),void 0!==r.normalTexture.scale)){const t=r.normalTexture.scale;a.normalScale.set(t,t)}return void 0!==r.occlusionTexture&&o!==Ef&&(l.push(e.assignTexture(a,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(a.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&o!==Ef&&(a.emissive=(new Tf).fromArray(r.emissiveFactor)),void 0!==r.emissiveTexture&&o!==Ef&&l.push(e.assignTexture(a,"emissiveMap",r.emissiveTexture)),Promise.all(l).then((function(){let n;return n=o===WT?i[ET.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new o(a),r.name&&(n.name=r.name),n.map&&(n.map.encoding=ad),n.emissiveMap&&(n.emissiveMap.encoding=ad),sE(n,r),e.associations.set(n,{materials:t}),r.extensions&&aE(i,n,r),n}))}createUniqueName(t){const e=rT.sanitizeNodeName(t||"");let n=e;for(let i=1;this.nodeNamesUsed[n];++i)n=e+"_"+i;return this.nodeNamesUsed[n]=!0,n}loadGeometries(t){const e=this,n=this.extensions,i=this.primitiveCache;function r(t){return n[ET.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(n){return gE(n,t,e)}))}const o=[];for(let a=0,s=t.length;a<s;a++){const n=t[a],s=uE(n),l=i[s];if(l)o.push(l.promise);else{let t;t=n.extensions&&n.extensions[ET.KHR_DRACO_MESH_COMPRESSION]?r(n):gE(new Bf,n,e),i[s]={primitive:n,promise:t},o.push(t)}}return Promise.all(o)}loadMesh(t){const e=this,n=this.json,i=this.extensions,r=n.meshes[t],o=r.primitives,a=[];for(let s=0,l=o.length;s<l;s++){const t=void 0===o[s].material?oE(this.cache):this.getDependency("material",o[s].material);a.push(t)}return a.push(e.loadGeometries(o)),Promise.all(a).then((function(n){const a=n.slice(0,n.length-1),s=n[n.length-1],l=[];for(let u=0,h=s.length;u<h;u++){const n=s[u],c=o[u];let h;const d=a[u];if(c.mode===ZT.TRIANGLES||c.mode===ZT.TRIANGLE_STRIP||c.mode===ZT.TRIANGLE_FAN||void 0===c.mode)h=!0===r.isSkinnedMesh?new zb(n,d):new om(n,d),!0!==h.isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),c.mode===ZT.TRIANGLE_STRIP?h.geometry=vE(h.geometry,id):c.mode===ZT.TRIANGLE_FAN&&(h.geometry=vE(h.geometry,rd));else if(c.mode===ZT.LINES)h=new aw(n,d);else if(c.mode===ZT.LINE_STRIP)h=new iw(n,d);else if(c.mode===ZT.LINE_LOOP)h=new sw(n,d);else{if(c.mode!==ZT.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);h=new pw(n,d)}Object.keys(h.geometry.morphAttributes).length>0&&cE(h,r),h.name=e.createUniqueName(r.name||"mesh_"+t),sE(h,r),c.extensions&&aE(i,h,c),e.assignFinalMaterial(h),l.push(h)}for(let i=0,r=l.length;i<r;i++)e.associations.set(l[i],{meshes:t,primitives:i});if(1===l.length)return l[0];const c=new ib;e.associations.set(c,{meshes:t});for(let t=0,e=l.length;t<e;t++)c.add(l[t]);return c}))}loadCamera(t){let e;const n=this.json.cameras[t],i=n[n.type];if(i)return"perspective"===n.type?e=new gm(Bd.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(e=new px(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),sE(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(t){const e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then((function(t){return n.inverseBindMatrices=t,n}))}loadAnimation(t){const e=this.json,n=e.animations[t],i=[],r=[],o=[],a=[],s=[];for(let l=0,c=n.channels.length;l<c;l++){const t=n.channels[l],e=n.samplers[t.sampler],c=t.target,u=void 0!==c.node?c.node:c.id,h=void 0!==n.parameters?n.parameters[e.input]:e.input,d=void 0!==n.parameters?n.parameters[e.output]:e.output;i.push(this.getDependency("node",u)),r.push(this.getDependency("accessor",h)),o.push(this.getDependency("accessor",d)),a.push(e),s.push(c)}return Promise.all([Promise.all(i),Promise.all(r),Promise.all(o),Promise.all(a),Promise.all(s)]).then((function(e){const i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=[];for(let t=0,n=i.length;t<n;t++){const e=i[t],n=r[t],c=o[t],u=a[t],h=s[t];if(void 0===e)continue;let d;switch(e.updateMatrix(),e.matrixAutoUpdate=!0,nE[h.path]){case nE.weights:d=KM;break;case nE.rotation:d=tS;break;case nE.position:case nE.scale:default:d=nS;break}const p=e.name?e.name:e.uuid,f=void 0!==u.interpolation?iE[u.interpolation]:$h,m=[];nE[h.path]===nE.weights?e.traverse((function(t){t.morphTargetInfluences&&m.push(t.name?t.name:t.uuid)})):m.push(p);let g=c.array;if(c.normalized){const t=dE(g.constructor),e=new Float32Array(g.length);for(let n=0,i=g.length;n<i;n++)e[n]=g[n]*t;g=e}for(let t=0,i=m.length;t<i;t++){const e=new d(m[t]+"."+nE[h.path],n.array,g,f);"CUBICSPLINE"===u.interpolation&&(e.createInterpolant=function(t){const e=this instanceof tS?$T:XT;return new e(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(e)}}const c=n.name?n.name:"animation_"+t;return new iS(c,void 0,l)}))}createNodeMesh(t){const e=this.json,n=this,i=e.nodes[t];return void 0===i.mesh?null:n.getDependency("mesh",i.mesh).then((function(t){const e=n._getNodeRef(n.meshCache,i.mesh,t);return void 0!==i.weights&&e.traverse((function(t){if(t.isMesh)for(let e=0,n=i.weights.length;e<n;e++)t.morphTargetInfluences[e]=i.weights[e]})),e}))}loadNode(t){const e=this.json,n=this.extensions,i=this,r=e.nodes[t],o=r.name?i.createUniqueName(r.name):"";return function(){const e=[],n=i._invokeOne((function(e){return e.createNodeMesh&&e.createNodeMesh(t)}));return n&&e.push(n),void 0!==r.camera&&e.push(i.getDependency("camera",r.camera).then((function(t){return i._getNodeRef(i.cameraCache,r.camera,t)}))),i._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(t){e.push(t)})),Promise.all(e)}().then((function(e){let a;if(a=!0===r.isBone?new Hb:e.length>1?new ib:1===e.length?e[0]:new of,a!==e[0])for(let t=0,n=e.length;t<n;t++)a.add(e[t]);if(r.name&&(a.userData.name=r.name,a.name=o),sE(a,r),r.extensions&&aE(n,a,r),void 0!==r.matrix){const t=new Dp;t.fromArray(r.matrix),a.applyMatrix4(t)}else void 0!==r.translation&&a.position.fromArray(r.translation),void 0!==r.rotation&&a.quaternion.fromArray(r.rotation),void 0!==r.scale&&a.scale.fromArray(r.scale);return i.associations.has(a)||i.associations.set(a,{}),i.associations.get(a).nodes=t,a}))}loadScene(t){const e=this.json,n=this.extensions,i=this.json.scenes[t],r=this,o=new ib;i.name&&(o.name=r.createUniqueName(i.name)),sE(o,i),i.extensions&&aE(n,o,i);const a=i.nodes||[],s=[];for(let l=0,c=a.length;l<c;l++)s.push(fE(a[l],o,e,r));return Promise.all(s).then((function(){const t=t=>{const e=new Map;for(const[n,i]of r.associations)(n instanceof xf||n instanceof $d)&&e.set(n,i);return t.traverse(t=>{const n=r.associations.get(t);null!=n&&e.set(t,n)}),e};return r.associations=t(o),o}))}}function fE(t,e,n,i){const r=n.nodes[t];return i.getDependency("node",t).then((function(t){if(void 0===r.skin)return t;let e;return i.getDependency("skin",r.skin).then((function(t){e=t;const n=[];for(let r=0,o=e.joints.length;r<o;r++)n.push(i.getDependency("node",e.joints[r]));return Promise.all(n)})).then((function(n){return t.traverse((function(t){if(!t.isMesh)return;const i=[],r=[];for(let o=0,a=n.length;o<a;o++){const t=n[o];if(t){i.push(t);const n=new Dp;void 0!==e.inverseBindMatrices&&n.fromArray(e.inverseBindMatrices.array,16*o),r.push(n)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[o])}t.bind(new Wb(i,r),t.matrixWorld)})),t}))})).then((function(t){e.add(t);const o=[];if(r.children){const e=r.children;for(let r=0,a=e.length;r<a;r++){const a=e[r];o.push(fE(a,t,n,i))}}return Promise.all(o)}))}function mE(t,e,n){const i=e.attributes,r=new op;if(void 0===i.POSITION)return;{const t=n.json.accessors[i.POSITION],e=t.min,o=t.max;if(void 0===e||void 0===o)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new np(e[0],e[1],e[2]),new np(o[0],o[1],o[2])),t.normalized){const e=dE(JT[t.componentType]);r.min.multiplyScalar(e),r.max.multiplyScalar(e)}}const o=e.targets;if(void 0!==o){const t=new np,e=new np;for(let i=0,r=o.length;i<r;i++){const r=o[i];if(void 0!==r.POSITION){const i=n.json.accessors[r.POSITION],o=i.min,a=i.max;if(void 0!==o&&void 0!==a){if(e.setX(Math.max(Math.abs(o[0]),Math.abs(a[0]))),e.setY(Math.max(Math.abs(o[1]),Math.abs(a[1]))),e.setZ(Math.max(Math.abs(o[2]),Math.abs(a[2]))),i.normalized){const t=dE(JT[i.componentType]);e.multiplyScalar(t)}t.max(e)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(t)}t.boundingBox=r;const a=new Sp;r.getCenter(a.center),a.radius=r.min.distanceTo(r.max)/2,t.boundingSphere=a}function gE(t,e,n){const i=e.attributes,r=[];function o(e,i){return n.getDependency("accessor",e).then((function(e){t.setAttribute(i,e)}))}for(const a in i){const e=eE[a]||a.toLowerCase();e in t.attributes||r.push(o(i[a],e))}if(void 0!==e.indices&&!t.index){const i=n.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));r.push(i)}return sE(t,e),mE(t,e,n),Promise.all(r).then((function(){return void 0!==e.targets?lE(t,e.targets,n):t}))}function vE(t,e){let n=t.getIndex();if(null===n){const e=[],i=t.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(let t=0;t<i.count;t++)e.push(t);t.setIndex(e),n=t.getIndex()}const i=n.count-2,r=[];if(e===rd)for(let a=1;a<=i;a++)r.push(n.getX(0)),r.push(n.getX(a)),r.push(n.getX(a+1));else for(let a=0;a<i;a++)a%2===0?(r.push(n.getX(a)),r.push(n.getX(a+1)),r.push(n.getX(a+2))):(r.push(n.getX(a+2)),r.push(n.getX(a+1)),r.push(n.getX(a)));r.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=t.clone();return o.setIndex(r),o}const xE={type:"change"},yE={type:"start"},_E={type:"end"};class bE extends gd{constructor(t,e){super(),void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new np,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:bc.ROTATE,MIDDLE:bc.DOLLY,RIGHT:bc.PAN},this.touches={ONE:wc.ROTATE,TWO:wc.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",nt),this._domElementKeyEvents=t},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(xE),n.update(),r=i.NONE},this.update=function(){const e=new np,h=(new ep).setFromUnitVectors(t.up,new np(0,1,0)),d=h.clone().invert(),p=new np,f=new ep,m=2*Math.PI;return function(){const t=n.object.position;e.copy(t).sub(n.target),e.applyQuaternion(h),a.setFromVector3(e),n.autoRotate&&r===i.NONE&&S(w()),n.enableDamping?(a.theta+=s.theta*n.dampingFactor,a.phi+=s.phi*n.dampingFactor):(a.theta+=s.theta,a.phi+=s.phi);let g=n.minAzimuthAngle,v=n.maxAzimuthAngle;return isFinite(g)&&isFinite(v)&&(g<-Math.PI?g+=m:g>Math.PI&&(g-=m),v<-Math.PI?v+=m:v>Math.PI&&(v-=m),a.theta=g<=v?Math.max(g,Math.min(v,a.theta)):a.theta>(g+v)/2?Math.max(g,a.theta):Math.min(v,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=l,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),!0===n.enableDamping?n.target.addScaledVector(c,n.dampingFactor):n.target.add(c),e.setFromSpherical(a),e.applyQuaternion(d),t.copy(n.target).add(e),n.object.lookAt(n.target),!0===n.enableDamping?(s.theta*=1-n.dampingFactor,s.phi*=1-n.dampingFactor,c.multiplyScalar(1-n.dampingFactor)):(s.set(0,0,0),c.set(0,0,0)),l=1,!!(u||p.distanceToSquared(n.object.position)>o||8*(1-f.dot(n.object.quaternion))>o)&&(n.dispatchEvent(xE),p.copy(n.object.position),f.copy(n.object.quaternion),u=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ot),n.domElement.removeEventListener("pointerdown",$),n.domElement.removeEventListener("pointercancel",K),n.domElement.removeEventListener("wheel",et),n.domElement.removeEventListener("pointermove",Z),n.domElement.removeEventListener("pointerup",J),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",nt)};const n=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let r=i.NONE;const o=1e-6,a=new hT,s=new hT;let l=1;const c=new np;let u=!1;const h=new Vd,d=new Vd,p=new Vd,f=new Vd,m=new Vd,g=new Vd,v=new Vd,x=new Vd,y=new Vd,_=[],b={};function w(){return 2*Math.PI/60/60*n.autoRotateSpeed}function M(){return Math.pow(.95,n.zoomSpeed)}function S(t){s.theta-=t}function T(t){s.phi-=t}const E=function(){const t=new np;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),c.add(t)}}(),C=function(){const t=new np;return function(e,i){!0===n.screenSpacePanning?t.setFromMatrixColumn(i,1):(t.setFromMatrixColumn(i,0),t.crossVectors(n.object.up,t)),t.multiplyScalar(e),c.add(t)}}(),A=function(){const t=new np;return function(e,i){const r=n.domElement;if(n.object.isPerspectiveCamera){const o=n.object.position;t.copy(o).sub(n.target);let a=t.length();a*=Math.tan(n.object.fov/2*Math.PI/180),E(2*e*a/r.clientHeight,n.object.matrix),C(2*i*a/r.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(E(e*(n.object.right-n.object.left)/n.object.zoom/r.clientWidth,n.object.matrix),C(i*(n.object.top-n.object.bottom)/n.object.zoom/r.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function L(t){n.object.isPerspectiveCamera?l/=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*t)),n.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function R(t){n.object.isPerspectiveCamera?l*=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/t)),n.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function P(t){h.set(t.clientX,t.clientY)}function N(t){v.set(t.clientX,t.clientY)}function D(t){f.set(t.clientX,t.clientY)}function k(t){d.set(t.clientX,t.clientY),p.subVectors(d,h).multiplyScalar(n.rotateSpeed);const e=n.domElement;S(2*Math.PI*p.x/e.clientHeight),T(2*Math.PI*p.y/e.clientHeight),h.copy(d),n.update()}function I(t){x.set(t.clientX,t.clientY),y.subVectors(x,v),y.y>0?L(M()):y.y<0&&R(M()),v.copy(x),n.update()}function O(t){m.set(t.clientX,t.clientY),g.subVectors(m,f).multiplyScalar(n.panSpeed),A(g.x,g.y),f.copy(m),n.update()}function F(t){t.deltaY<0?R(M()):t.deltaY>0&&L(M()),n.update()}function U(t){let e=!1;switch(t.code){case n.keys.UP:A(0,n.keyPanSpeed),e=!0;break;case n.keys.BOTTOM:A(0,-n.keyPanSpeed),e=!0;break;case n.keys.LEFT:A(n.keyPanSpeed,0),e=!0;break;case n.keys.RIGHT:A(-n.keyPanSpeed,0),e=!0;break}e&&(t.preventDefault(),n.update())}function z(){if(1===_.length)h.set(_[0].pageX,_[0].pageY);else{const t=.5*(_[0].pageX+_[1].pageX),e=.5*(_[0].pageY+_[1].pageY);h.set(t,e)}}function H(){if(1===_.length)f.set(_[0].pageX,_[0].pageY);else{const t=.5*(_[0].pageX+_[1].pageX),e=.5*(_[0].pageY+_[1].pageY);f.set(t,e)}}function B(){const t=_[0].pageX-_[1].pageX,e=_[0].pageY-_[1].pageY,n=Math.sqrt(t*t+e*e);v.set(0,n)}function V(){n.enableZoom&&B(),n.enablePan&&H()}function G(){n.enableZoom&&B(),n.enableRotate&&z()}function W(t){if(1==_.length)d.set(t.pageX,t.pageY);else{const e=ct(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);d.set(n,i)}p.subVectors(d,h).multiplyScalar(n.rotateSpeed);const e=n.domElement;S(2*Math.PI*p.x/e.clientHeight),T(2*Math.PI*p.y/e.clientHeight),h.copy(d)}function j(t){if(1===_.length)m.set(t.pageX,t.pageY);else{const e=ct(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);m.set(n,i)}g.subVectors(m,f).multiplyScalar(n.panSpeed),A(g.x,g.y),f.copy(m)}function q(t){const e=ct(t),i=t.pageX-e.x,r=t.pageY-e.y,o=Math.sqrt(i*i+r*r);x.set(0,o),y.set(0,Math.pow(x.y/v.y,n.zoomSpeed)),L(y.y),v.copy(x)}function X(t){n.enableZoom&&q(t),n.enablePan&&j(t)}function Y(t){n.enableZoom&&q(t),n.enableRotate&&W(t)}function $(t){!1!==n.enabled&&(0===_.length&&(n.domElement.setPointerCapture(t.pointerId),n.domElement.addEventListener("pointermove",Z),n.domElement.addEventListener("pointerup",J)),at(t),"touch"===t.pointerType?it(t):Q(t))}function Z(t){!1!==n.enabled&&("touch"===t.pointerType?rt(t):tt(t))}function J(t){st(t),0===_.length&&(n.domElement.releasePointerCapture(t.pointerId),n.domElement.removeEventListener("pointermove",Z),n.domElement.removeEventListener("pointerup",J)),n.dispatchEvent(_E),r=i.NONE}function K(t){st(t)}function Q(t){let e;switch(t.button){case 0:e=n.mouseButtons.LEFT;break;case 1:e=n.mouseButtons.MIDDLE;break;case 2:e=n.mouseButtons.RIGHT;break;default:e=-1}switch(e){case bc.DOLLY:if(!1===n.enableZoom)return;N(t),r=i.DOLLY;break;case bc.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enablePan)return;D(t),r=i.PAN}else{if(!1===n.enableRotate)return;P(t),r=i.ROTATE}break;case bc.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enableRotate)return;P(t),r=i.ROTATE}else{if(!1===n.enablePan)return;D(t),r=i.PAN}break;default:r=i.NONE}r!==i.NONE&&n.dispatchEvent(yE)}function tt(t){if(!1!==n.enabled)switch(r){case i.ROTATE:if(!1===n.enableRotate)return;k(t);break;case i.DOLLY:if(!1===n.enableZoom)return;I(t);break;case i.PAN:if(!1===n.enablePan)return;O(t);break}}function et(t){!1!==n.enabled&&!1!==n.enableZoom&&r===i.NONE&&(t.preventDefault(),n.dispatchEvent(yE),F(t),n.dispatchEvent(_E))}function nt(t){!1!==n.enabled&&!1!==n.enablePan&&U(t)}function it(t){switch(lt(t),_.length){case 1:switch(n.touches.ONE){case wc.ROTATE:if(!1===n.enableRotate)return;z(),r=i.TOUCH_ROTATE;break;case wc.PAN:if(!1===n.enablePan)return;H(),r=i.TOUCH_PAN;break;default:r=i.NONE}break;case 2:switch(n.touches.TWO){case wc.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;V(),r=i.TOUCH_DOLLY_PAN;break;case wc.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;G(),r=i.TOUCH_DOLLY_ROTATE;break;default:r=i.NONE}break;default:r=i.NONE}r!==i.NONE&&n.dispatchEvent(yE)}function rt(t){switch(lt(t),r){case i.TOUCH_ROTATE:if(!1===n.enableRotate)return;W(t),n.update();break;case i.TOUCH_PAN:if(!1===n.enablePan)return;j(t),n.update();break;case i.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;X(t),n.update();break;case i.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;Y(t),n.update();break;default:r=i.NONE}}function ot(t){!1!==n.enabled&&t.preventDefault()}function at(t){_.push(t)}function st(t){delete b[t.pointerId];for(let e=0;e<_.length;e++)if(_[e].pointerId==t.pointerId)return void _.splice(e,1)}function lt(t){let e=b[t.pointerId];void 0===e&&(e=new Vd,b[t.pointerId]=e),e.set(t.pageX,t.pageY)}function ct(t){const e=t.pointerId===_[0].pointerId?_[1]:_[0];return b[e.pointerId]}n.domElement.addEventListener("contextmenu",ot),n.domElement.addEventListener("pointerdown",$),n.domElement.addEventListener("pointercancel",K),n.domElement.addEventListener("wheel",et,{passive:!1}),this.update()}}var wE=n("b76a"),ME=n.n(wE);function SE(t){var e=";base64,";if(-1==t.indexOf(e)){var n=t.split(","),i=n[0].split(":")[1],r=decodeURIComponent(n[1]);return{blob:new Blob([r],{type:i}),contentType:i}}for(var o=t.split(e),a=o[0].split(":")[1],s=window.atob(o[1]),l=s.length,c=new Uint8Array(l),u=0;u<l;++u)c[u]=s.charCodeAt(u);return{blob:new Blob([c],{type:a}),contentType:a}}var TE={components:{Header:s["a"],Flowchart:dc,Publish:yc,draggable:ME.a},data:function(){return{currentLang:0,serial:0,publishDescription:"",modalType:{publish:!1},nodes:[],connections:[],validationType:0,validationTypeList:[],recordTypeList:[{value:2,text:"WF.RECORD_TYPE_VIDEO"},{value:1,text:"WF.RECORD_TYPE_IMAGE"}],templateList:[{type:0,name:"text",text:"WF.TEXT"},{type:1,name:"image",text:"WF.IMAGE"},{type:2,name:"video",text:"WF.VIDEO"},{type:3,name:"text+image",text:"WF.TEXT_IMAGE"},{type:4,name:"text+video",text:"WF.TEXT_VIDEO"},{type:5,name:"model",text:"WF.MODEL"},{type:6,name:"text+model",text:"WF.TEXT_MODEL"}],connectionForm:{target:null,operation:null},isSidebarMinified:!1,isMenuMinified:!1,isContentMinified:!1,isPreviewerMinified:!1,selectedNode:null,photos:[],queryTitle:null,selectedData:null,isEditing:!1,steps:[],errorList:[],renderer:null,scene:null,camera:null,controls:null,directLight:null,ambientLught:null,clock:null,mesh:null,model:null,mixer:null,gridSize:40,divisions:8,progress:0,filePath:null,changeFlag:!1,isStaticModel:!1}},created:function(){var t=this;window.onunload=function(){window.onbeforeunload=null},window.onbeforeunload=function(e){if(t.changeFlag)return t.$t("WF.LEAVE_ALERT")},document.addEventListener("input",(function(e){t.changeFlag=!0}))},beforeRouteLeave:function(t,e,n){var i=this;this.changeFlag?this.$confirm(this.$t("WF.LEAVE_CONFIRM"),this.$t("WF.LEAVE_ALERT"),(function(){window.onbeforeunload=null,i.clearScene(),n()}),(function(){n(!1)})):(window.onbeforeunload=null,this.clearScene(),n())},mounted:function(){var t=this.$route.params.uuid,e=this.$route.params.version;t?this.getDetail(t,e):this.$router.push({name:"WorkflowManagement"}),this.getCurrentLang(),this.GetStepTextCollection()},methods:{createNode:function(t){if(this.$refs.chart.internalNodes.length>=101)return this.$alert(this.$t("WF.STEP_ALERT"));this.changeFlag=!0,this.$refs.chart.add({type:t})},GetStepTextCollection:function(){var t=this;this.apiGet("workflow/get_step_text_collection").then((function(e){var n=e.data;t.validationTypeList=[{text:t.$t("WF.PLEASE_SELECT_TEXT_COLLECTION")}].concat(Object(a["a"])(n.map((function(t){return{text:"".concat(t.pass_text," / ").concat(t.fail_text),pass_text:t.pass_text,fail_text:t.fail_text}}))))}))},getDetail:function(t,e){var n=this,i={uuid:t,version:e};this.apiGet("workflow/detail",i).then((function(t){var e=t.data;n.queryTitle=e.name,n.steps=e.steps,n.$nextTick((function(){n.changeFlag=!1}))}))},getCurrentLang:function(){this.currentLang=this.$cookies.get("language")},setImgSrc:function(t){return n("f57b")("./".concat(this.templateList[t].name,".svg"))},leave:function(){this.$router.push({name:"WorkflowManagement"})},save:function(){var t=this,e=this.$refs.chart.internalNodes.map((function(t){return t.toStep()})),n={uuid:this.$route.params.uuid,steps:e};this.apiPost("workflow/save",n).then((function(e){e.data;t.changeFlag=!1,t.$emit("ok")}))},showPublish:function(){if(!this.$refs.chart.checkConnection())return this.$alert(this.$t("WF.ERR_OTHER"));var t,e=this.$refs.chart.internalNodes.filter((function(t){return null!=t.serial})).sort((function(t,e){return t.serial-e.serial})),n=Object(o["a"])(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;1!=i.type&&3!=i.type||this.onValueCheck("pic",i),2!=i.type&&4!=i.type||this.onValueCheck("vid",i),this.onValueCheck("title",i),0!=i.type&&3!=i.type&&4!=i.type&&6!=i.type||this.onValueCheck("text",i),5!=i.type&&6!=i.type||this.onValueCheck("model",i),5!=i.type&&6!=i.type||this.onValueCheck("modelSnapshot",i),i.recordCheck&&this.onValueCheck("recordDesc",i),i.isCheck&&(this.onValueCheck("pass_text",i),this.onValueCheck("fail_text",i))}}catch(r){n.e(r)}finally{n.f()}this.errorList.length>0?this.isEditing=!0:this.showModal("publish")},doPublish:function(t){var e=this,n=this.$refs.chart.internalNodes.filter((function(t){return null!=t.serial})).sort((function(t,e){return t.serial-e.serial})).map((function(t){return t.toStep()})),i={uuid:this.$route.params.uuid,description:t,steps:n};this.apiPost("workflow/publish",i).then((function(t){t.data;e.changeFlag=!1,e.$emit("ok"),e.$router.push({name:"WorkflowManagement"})}))},handleNodeChange:function(){this.changeFlag=!0,this.updateErrorList()},handleConnectionChange:function(){this.changeFlag=!0,this.updateErrorList()},handleSelect:function(t){var e=this;t&&t.length>0?this.selectedNode!==t[0]&&(this.clearScene(),this.$nextTick((function(){e.selectedNode=t[0];var n=e.selectedNode.type;5!=n&&6!=n||(e.progress=-1,e.selectedNode.modelPath&&e.initModel());var i=e.validationTypeList.findIndex((function(t){return t.pass_text==e.selectedNode.pass_text&&t.fail_text==e.selectedNode.fail_text}));console.log(e.selectedNode,e.validationTypeList),e.validationType=-1!=i?i:0}))):(this.clearScene(),this.selectedNode=null)},clearScene:function(){if(this.scene)while(this.scene.children.length>0)this.scene.remove(this.scene.children[0]);this.progress=-1},renderChart:function(t,e,i){var r;e.width=e.width||120,e.height=e.height||80;var o="0",a="2px";-1==e.type?r="#367057":i?(r="#e27e1a",o="10,5",a="3px"):r="#2173c9",-1==e.type?(t.append("rect").style("width",e.width+"px").style("height",Jl(e.height)-20+"px").attr("x",e.x+5).attr("y",e.y+5).attr("rx",30).style("opacity","0.7").style("stroke-width","2px").style("fill","#7b7b7b"),t.append("rect").attr("x",e.x).attr("y",e.y).attr("rx",30).style("width",e.width+"px").style("height",Jl(e.height)-20+"px").style("opacity","0.9").style("stroke-width","2px").classed(e.type,!0).style("fill","#3fb182").attr("stroke",r)):(t.append("rect").style("width",e.width+"px").style("height","100px").attr("x",e.x+5).attr("y",e.y+5).attr("rx",8).style("opacity","0.7").style("stroke-width","2px").style("fill","#7b7b7b"),t.append("rect").attr("x",e.x).attr("y",e.y+20).attr("rx",8).style("width",e.width+"px").style("height","80px").style("opacity","0.9").style("stroke-width",a).style("fill","#2173c9").attr("stroke",r).style("stroke-dasharray",o));var s,l,c,u,h=e.title;-1==e.type?(s=e.x+12,l=e.y+18,c="bold",u="18px"):(s=e.x+10,l=e.y+37,c="normal",u="14px"),t.append("foreignObject").attr("x",s).attr("y",l).style("width",e.width-20+"px").style("height",e.height+"px").attr("text-anchor","middle").append("xhtml:p").style("font-size",u).style("font-weight",c).style("text-align","center").style("color","#fff").style("border",r).style("word-break","break-word").style("text-overflow","ellipsis").style("-webkit-line-clamp","3").style("-webkit-box-orient","vertical").style("display","-webkit-box").style("overflow","hidden").attr("title",h).text((function(){return h})),-1!=e.type&&(t.append("rect").attr("x",e.x).attr("y",e.y).style("height","31px").style("width",e.width+"px").attr("rx",8).style("stroke-width",a).style("fill","#fff").attr("stroke",r).style("stroke-dasharray",o),t.append("rect").attr("x",e.x+2).attr("y",e.y+2).style("height","31px").style("width",e.width-4+"px").attr("rx",8).style("stroke-width","2px").style("fill","#fff").attr("stroke","#fff"),t.append("image").attr("href",n("0625")("./".concat(this.templateList[e.type].name,"-alt.svg"))).attr("x",e.x+45).attr("y",e.y+2).style("height","30px").style("width","30px")),(e.error.title||e.error.pic||e.error.vid||e.error.text||e.error.recordDesc)&&-1!=e.type&&(t.append("rect").style("width","24px").style("height","24px").attr("x",e.x+100).attr("y",e.y-5).attr("rx",12).style("opacity","1").style("fill","#d44e4e"),t.append("text").attr("x",e.x+110).attr("y",e.y+12).attr("fill","#fff").attr("font-weight","bold").text((function(){return"!"})))},toggleSidebar:function(){var t=this;this.isSidebarMinified?(this.isSidebarMinified=!1,setTimeout((function(){t.isContentMinified=!1,t.isMenuMinified=!1}),500)):(this.isSidebarMinified=!0,this.isContentMinified=!0,setTimeout((function(){t.isMenuMinified=!0}),300))},showEditTips:function(){this.isSidebarMinified=!1,this.isMenuMinified=!1,this.isContentMinified=!1,this.isEditing=!0},togglePreviewMinified:function(t){this.isPreviewerMinified=t,console.log(!t,this.selectedNode,this.selectedNode.modelPath),!t&&this.selectedNode&&this.selectedNode.modelPath&&this.initModel()},onValueCheck:function(t,e){if(e||(e=this.selectedNode),e&&t){var n=e[t];console.log("onValueCheck ".concat(t," ").concat(e.id,", ").concat(n)),e.error[t]=!n,e.__ob__.dep.notify(),this.updateErrorList()}},onChangeRecordCheck:function(){this.selectedNode.recordCheck=!this.selectedNode.recordCheck,this.selectedNode.recordCheck||(delete this.selectedNode.error.recordDesc,this.updateErrorList())},onChangeAnimationEnable:function(){this.selectedNode.animationEnable=!this.selectedNode.animationEnable},onChangeFileUpload:function(t){var e=this,n=this.selectedNode,i="vid"==t,r="pic"==t,o="model"==t,a=new Array(".jpg",".jpeg",".png");i&&(a=new Array(".mp4")),o&&(a=new Array(".glb"));var s=this.$refs.file.files[0];if(!s)return n[t]=null,n[t+"Path"]=null,n[t+"Name"]=null,n[t+"Size"]=null,n.error[t]=!0,void this.updateErrorList();var l=s.name;if(console.log(s),l=l.substring(l.lastIndexOf(".")),a.indexOf(l)<0){if(r)return this.$alert(this.$t("WF.IMAGE_ERR"));if(i)return this.$alert(this.$t("WF.VIDEO_ERR"));if(o)return this.$alert(this.$t("WF.MODEL_ERR"))}else{if(r&&s.size>26214400)return this.$alert(this.$t("WF.SIZE_ERR")+"25M");if(i&&s.size>157286400)return alert(this.$t("WF.SIZE_ERR")+"150M");if(o&&s.size>10485760)return this.$alert(this.$t("WF.SIZE_ERR")+"10M")}var c=new FormData;c.append("file",s),c.append("uuid",this.$route.params.uuid),this.apiPost("workflow/upload_step_file",c).then((function(i){var r=i.data;n[t]=r.file_uuid,n[t+"Path"]="https://".concat("ar-workguide-dev.fiimart.com:3001","/uuid?uuid=").concat(r.file_path),n[t+"Name"]=r.file_name,n[t+"Size"]=r.file_size,n.error[t]=!1,n.__ob__.dep.notify(),e.updateErrorList(),e.$nextTick((function(){e.initModel()}))})).catch((function(t){var e=t.message;console.log("upload_step_file error with ".concat(e))}))},onErrorClick:function(t){t.node&&this.$refs.chart.selectNode(t.node)},deleteFile:function(t){var e=this.selectedNode;e&&(e[t]=null,e[t+"Path"]=null,e[t+"Name"]=null,e[t+"Size"]=null,e.error[t]=!0,"model"==t&&(e.modelSnapshot=null,e.modelSnapshotPath=null,e.animationEnable=!0,e.animationControlList=[{start:0,end:0}],this.clearScene()),this.updateErrorList())},showModal:function(t,e){e&&(this.selectedData=e),this.modalType[t]=!0},closeModal:function(t){this.modalType[t]=!1,this.selectedData=null},chooseFiles:function(){this.$refs.file.click()},updateErrorList:function(){var t=[];if(!this.$refs.chart||!this.$refs.chart.internalNodes)return[];var e=this.$refs.chart.internalNodes.find((function(t){return 0===t.serial}));if(!e)return[];while(e.to){if(e=e.to,-1===e.serial)break;var n=this.$t("WF.STEP")+" "+e.serial;e.error.title&&t.push({node:e,title:n,msg:this.$t("WF.ERR_TITLE")}),e.error.pic&&t.push({node:e,title:n,msg:this.$t("WF.ERR_IMAGE")}),e.error.vid&&t.push({node:e,title:n,msg:this.$t("WF.ERR_VIDEO")}),e.error.text&&t.push({node:e,title:n,msg:this.$t("WF.ERR_STEP_DESC")}),e.error.recordDesc&&t.push({node:e,title:n,msg:this.$t("WF.ERR_RECORD_DESC")}),e.error.model&&t.push({node:e,title:n,msg:this.$t("WF.ERR_MODEL")}),e.error.modelSnapshot&&t.push({node:e,title:n,msg:this.$t("WF.ERR_MODEL_SNAPSHOT")}),(e.error.pass_text||e.error.fail_text)&&t.push({node:e,title:n,msg:this.$t("WF.ERR_VALIDATION_TEXT")})}if(0===e.serial)t.push({node:e,title:null,msg:this.$t("WF.ERR_START")});else if(-1!==e.serial){var i=this.$refs.chart.internalNodes.find((function(t){return-1===t.serial}));i.from?t.push({node:e,title:null,msg:this.$t("WF.ERR_OTHER")}):t.push({node:e,title:null,msg:this.$t("WF.ERR_END")})}this.errorList=t},initModel:function(){var t=this;console.log("initModel"),this.$nextTick((function(){if(t.$refs.modelCanvas){t.renderer=new ub({antialias:!0,alpha:!0,autoClear:!0,physicallyCorrectLights:!0,preserveDrawingBuffer:!0}),t.renderer.setSize(520,320),t.renderer.setClearColor(15658734,1),t.$refs.modelCanvas.innerHTML="",t.$refs.modelCanvas.appendChild(t.renderer.domElement),t.scene=new fb;var e=4473924,n=4473924,i=new wT(t.gridSize,t.divisions,e,n);t.scene.add(i);var r=new Pm(40,.15),o=new Pm(.15,40),a=new Ef({color:12526114,side:Pc}),s=new Ef({color:2264151,side:Pc}),l=new om(r,a),c=new om(o,s);l.position.set(0,.012,0),l.rotation.set(1.57,0,0),c.position.set(0,.01,0),c.rotation.set(1.57,0,0),t.scene.add(l,c),t.loadGLTF(),t.camera=new gm(75,window.innerWidth/window.innerHeight,.1,1e3),t.camera.position.x=15,t.camera.position.y=15,t.camera.position.z=15,t.controls=new bE(t.camera,t.renderer.domElement),t.controls.minZoom=1,t.controls.maxZoom=1.5,t.dLight=new LS("#fff",1),t.dLight.position.set(0,0,100).normalize(),t.dLight.castShadow=!0,t.scene.add(t.dLight),t.aLight=new RS("#ccc"),t.scene.add(t.aLight),t.clock=new VS,t.render()}}))},animate:function(){this.id=requestAnimationFrame(this.animate),this.renderer.render(this.scene,this.camera)},stopAnimation:function(){console.log("STOP"),this.mixer.stopAllAction()},setAnimationTime:function(t,e){var n=this;this.stopAnimation(),console.log("開始秒數: "+t),console.log("幾秒後結束: "+e);var i=this.model.animations;i.forEach((function(i){var r=n.mixer.clipAction(i);r.clampWhenFinished=!0,r.setLoop(jh),r.play(),setTimeout((function(){r.paused=!0}),1e3*(e-t))})),this.mixer.setTime(t),this.animate(),this.render()},deleteAnimationTime:function(t){var e=this.selectedNode;e.animationControlList<=1||e&&e.animationControlList&&e.animationControlList.splice(t,1)},addAnimationControl:function(){var t=this.selectedNode;t&&t.animationControlList&&t.animationControlList.push({start:0,end:0})},updateAnimationControlList:function(){for(var t=0;t<this.selectedNode.animationControlList.length;t++)this.selectedNode.animationControlList[t].id=t},durationLimit:function(t,e){this.updateAnimationControlList(),t[e]>this.model.animations[0].duration&&(alert("不可超過動畫總秒數"),this.selectedNode.animationControlList[t.id][e]=this.model.animations[0].duration)},captureModelSnapshot:function(){var t=this;try{var e=this.renderer.domElement.toDataURL(),n=new FormData,i=SE(e);n.append("file",i.blob,"snapshot.png"),n.append("uuid",this.$route.params.uuid),this.apiPost("workflow/upload_step_file",n).then((function(e){var n=e.data,i=t.selectedNode;i&&(i.modelSnapshot=n.file_uuid,i.modelSnapshotPath="https://".concat("ar-workguide-dev.fiimart.com:3001","/uuid?uuid=").concat(n.file_path),i.error["modelSnapshot"]=!1,i.__ob__.dep.notify(),t.updateErrorList())})).catch((function(t){var e=t.message;console.log("upload_step_file error with ".concat(e))}))}catch(r){console.log(r)}},dragColumn:function(t){console.log({evt:t}),console.log(this.selectedNode.animationControlList)},deleteModelSnapshot:function(){var t=this.selectedNode;t&&(t.modelSnapshot=null,t.error["modelSnapshot"]=!0,t.__ob__.dep.notify(),this.updateErrorList())},render:function(){if(this.model){requestAnimationFrame(this.render);var t=this.clock.getDelta();this.mixer&&this.mixer.update(t),this.renderer.render(this.scene,this.camera)}},loadGLTF:function(){var t=this;this.isStaticModel=!1,this.selectedNode.animationEnable=!0,this.progress=0;var e=this.selectedNode;console.log("loadGLTF",e.modelPath),this.loader=new ST,this.loader.load(e.modelPath,(function(e){t.model=e,console.log(t.model.animations[0]),t.model.animations.length||(t.isStaticModel=!0,t.selectedNode.animationEnable=!1),t.mesh=t.model.scene,t.model.scene.scale.setScalar(5),t.mixer=new sT(t.mesh),t.render(),t.scene.add(t.mesh)}),(function(e){t.progress=(e.loaded/e.total*100).toFixed(0)}),(function(t){console.error("An error happened",t)}))},updateGrid:function(t){var e,n=Object(o["a"])(this.scene.children);try{for(n.s();!(e=n.n()).done;){var i=e.value;if("GridHelper"==i.type){var r=this.scene.children.indexOf(i);-1!==r&&this.scene.children.splice(r,1)}}}catch(g){n.e(g)}finally{n.f()}for(var a=0;a<this.scene.children.length;a++)"Mesh"==this.scene.children[a].type&&this.scene.children.splice(a,2);1==t&&(this.gridSize=40,this.divisions=8);var s=4473924,l=4473924,c=new wT(this.gridSize,this.divisions,s,l);this.scene.add(c);var u=new Pm(this.gridSize,.15),h=new Pm(.15,this.gridSize),d=new Ef({color:12526114,side:Pc}),p=new Ef({color:2264151,side:Pc}),f=new om(u,d),m=new om(h,p);f.position.set(0,.012,0),f.rotation.set(1.57,0,0),m.position.set(0,.01,0),m.rotation.set(1.57,0,0),this.scene.add(f,m)},resetCamera:function(){this.camera.position.x=15,this.camera.position.y=15,this.camera.position.z=15,this.render(),this.animate()},resetGrid:function(){this.camera.position.x=15,this.camera.position.y=15,this.camera.position.z=15,this.render(),this.animate()},setCustomizedValidation:function(){this.selectedNode.pass_text=this.validationTypeList[this.validationType].pass_text,this.selectedNode.fail_text=this.validationTypeList[this.validationType].fail_text,this.selectedNode.__ob__.dep.notify(),this.onValueCheck("pass_text")},resizeCanvas:function(){}}},EE=TE,CE=(n("3328"),Object(uc["a"])(EE,i,r,!1,null,"0f96279e",null));e["default"]=CE.exports},"0922":function(t,e,n){t.exports=n.p+"img/task-c.bc1d15c5.svg"},"09e7":function(t,e,n){t.exports=n.p+"img/ar-b.f4e0fe77.svg"},"0ace":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".blue[data-v-998e2808]{color:#2173c9}.blueHover[data-v-998e2808]{color:#185597}.darkBlue[data-v-998e2808]{color:#0a519c}.grey[data-v-998e2808]{color:#7b7b7b}.greyHover[data-v-998e2808]{color:#606060}.lightgrey[data-v-998e2808]{color:#d7d7d7}.green[data-v-998e2808]{color:#3fb182}.greenHover[data-v-998e2808]{color:#37926c}.red[data-v-998e2808]{color:#d44e4e}.redHover[data-v-998e2808]{color:#b44b4b}.placeholder[data-v-998e2808]{color:#aeaeae}.placeholderHover[data-v-998e2808]{color:#7b7b7b}.white[data-v-998e2808]{color:#fff}.custom-pagination[data-v-998e2808]{width:calc(100% - 60px)}.custom-pagination[data-v-998e2808] .pagination{float:right}.custom-pagination[data-v-998e2808] .VuePagination__pagination-item-next-chunk .page-link,.custom-pagination[data-v-998e2808] .VuePagination__pagination-item-prev-chunk .page-link{padding:7px}.custom-pagination[data-v-998e2808] .page-link{width:38px;height:38px;border-radius:19px;margin:0 2px;text-align:center;color:#2173c9;cursor:pointer}.custom-pagination[data-v-998e2808] .page-link.active{color:#fff;background-color:#2173c9;border-color:#2173c9}.chart .zoom-ratio[data-v-998e2808]{position:absolute;top:80px;right:45px;font-family:consolas}",""]),t.exports=e},"11de":function(t,e,n){t.exports=n.p+"img/fii-vision-logo-b.d70b533e.svg"},"138c":function(t,e,n){t.exports=n.p+"img/text.468d86f6.svg"},1422:function(t,e,n){var i=n("2709");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("499e").default;r("19155328",i,!0,{sourceMap:!1,shadowMode:!1})},"1a26":function(t,e,n){t.exports=n.p+"img/fii-vision-logo-c.5dd316ba.svg"},"1a8b":function(t,e,n){t.exports=n.p+"img/account-bg.2818368a.svg"},"1f0c":function(t,e,n){var i=n("82d7");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("499e").default;r("c6c67856",i,!0,{sourceMap:!1,shadowMode:!1})},"20a3":function(t,e,n){"use strict";n("74f9")},"23d1":function(t,e,n){"use strict";n("68fe")},"26b4":function(t,e,n){t.exports=n.p+"img/user_management_hover.bbae7239.svg"},"26c7":function(t,e,n){t.exports=n.p+"img/task_management_hover.41ddd409.svg"},2709:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".blue[data-v-5ca922c2]{color:#2173c9}.blueHover[data-v-5ca922c2]{color:#185597}.darkBlue[data-v-5ca922c2]{color:#0a519c}.grey[data-v-5ca922c2]{color:#7b7b7b}.greyHover[data-v-5ca922c2]{color:#606060}.lightgrey[data-v-5ca922c2]{color:#d7d7d7}.green[data-v-5ca922c2]{color:#3fb182}.greenHover[data-v-5ca922c2]{color:#37926c}.red[data-v-5ca922c2]{color:#d44e4e}.redHover[data-v-5ca922c2]{color:#b44b4b}.placeholder[data-v-5ca922c2]{color:#aeaeae}.placeholderHover[data-v-5ca922c2]{color:#7b7b7b}.white[data-v-5ca922c2]{color:#fff}.custom-pagination[data-v-5ca922c2]{width:calc(100% - 60px)}.custom-pagination[data-v-5ca922c2] .pagination{float:right}.custom-pagination[data-v-5ca922c2] .VuePagination__pagination-item-next-chunk .page-link,.custom-pagination[data-v-5ca922c2] .VuePagination__pagination-item-prev-chunk .page-link{padding:7px}.custom-pagination[data-v-5ca922c2] .page-link{width:38px;height:38px;border-radius:19px;margin:0 2px;text-align:center;color:#2173c9;cursor:pointer}.custom-pagination[data-v-5ca922c2] .page-link.active{color:#fff;background-color:#2173c9;border-color:#2173c9}.m-modal-title[data-v-5ca922c2]{margin-bottom:30px;padding-bottom:15px;font-size:22px;font-weight:700;border-bottom:2px solid #e7e7e9}.form-group[data-v-5ca922c2]{position:relative;margin:20px auto;width:100%}.form-group .m-label[data-v-5ca922c2]{position:absolute;font-weight:700;padding:0 5px;line-height:20px;top:-10px;left:10px;background-color:#fff;color:#2173c9}.form-group .m-text[data-v-5ca922c2]{width:100%;padding:12px;border:2px solid #e7e7e9;border-radius:10px;color:#d7d7d7}.form-group .form-control[data-v-5ca922c2]{border:2px solid #e7e7e9;border-radius:10px;transition:all .3s ease-in-out}.form-group .form-control[data-v-5ca922c2]:focus{border:2px solid #4b8bcf;box-shadow:none}.form-group .desc-count[data-v-5ca922c2]{width:100%;font-size:12px}.form-group .radio-group[data-v-5ca922c2]{margin:0 auto}.form-group .btn-cancel[data-v-5ca922c2],.form-group .btn-ok[data-v-5ca922c2]{width:47%;height:38px;padding:0 12px;border-radius:10px;box-shadow:0 3px 3px 0 rgba(0,0,0,.15)}@media (max-width:1200px){.form-group .btn-cancel[data-v-5ca922c2],.form-group .btn-ok[data-v-5ca922c2]{width:100%;margin:5px 0}}.form-group .btn-cancel[data-v-5ca922c2]{color:#2173c9;background-color:#fff;border:1px solid #2173c9}.form-group .btn-ok[data-v-5ca922c2]{margin-left:6%;color:#fff;background-color:#2173c9;border:1px solid #2173c9}@media (max-width:1200px){.form-group .btn-ok[data-v-5ca922c2]{margin-left:0}}",""]),t.exports=e},2864:function(t,e,n){t.exports=n.p+"img/workflow_management_hover.91c8752d.svg"},"28fe":function(t,e,n){t.exports=n.p+"img/enterprise-b.c5ec6e8c.svg"},3328:function(t,e,n){"use strict";n("1f0c")},"356e":function(t,e,n){t.exports=n.p+"img/maintenance.4130bd61.svg"},"35fe":function(t,e,n){t.exports=n.p+"img/next.df16435d.svg"},"369f":function(t,e,n){"use strict";n("3aa1")},"3aa1":function(t,e,n){var i=n("4f39");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("499e").default;r("306b4824",i,!0,{sourceMap:!1,shadowMode:!1})},4057:function(t,e,n){var i=n("23e7"),r=Math.hypot,o=Math.abs,a=Math.sqrt,s=!!r&&r(1/0,NaN)!==1/0;i({target:"Math",stat:!0,forced:s},{hypot:function(t,e){var n,i,r=0,s=0,l=arguments.length,c=0;while(s<l)n=o(arguments[s++]),c<n?(i=c/n,r=r*i*i+1,c=n):n>0?(i=n/c,r+=i*i):r+=n;return c===1/0?1/0:c*a(r)}})},"40b2":function(t,e,n){t.exports=n.p+"img/user_management.13e795f3.svg"},"40e9":function(t,e,n){t.exports=n.p+"img/text+image.b1e67898.svg"},4206:function(t,e,n){t.exports=n.p+"img/xxxx_management.e26d48a2.svg"},"49de":function(t,e,n){t.exports=n.p+"img/comments-hover.cb4dcc54.svg"},"4e0f":function(t,e,n){t.exports=n.p+"img/comments.8cf9e61a.svg"},"4e82":function(t,e,n){"use strict";var i=n("23e7"),r=n("e330"),o=n("59ed"),a=n("7b0b"),s=n("07fa"),l=n("577e"),c=n("d039"),u=n("addb"),h=n("a640"),d=n("04d1"),p=n("d998"),f=n("2d00"),m=n("512c"),g=[],v=r(g.sort),x=r(g.push),y=c((function(){g.sort(void 0)})),_=c((function(){g.sort(null)})),b=h("sort"),w=!c((function(){if(f)return f<70;if(!(d&&d>3)){if(p)return!0;if(m)return m<603;var t,e,n,i,r="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)g.push({k:e+i,v:n})}for(g.sort((function(t,e){return e.v-t.v})),i=0;i<g.length;i++)e=g[i].k.charAt(0),r.charAt(r.length-1)!==e&&(r+=e);return"DGBEFHACIJK"!==r}})),M=y||!_||!b||!w,S=function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:l(e)>l(n)?1:-1}};i({target:"Array",proto:!0,forced:M},{sort:function(t){void 0!==t&&o(t);var e=a(this);if(w)return void 0===t?v(e):v(e,t);var n,i,r=[],l=s(e);for(i=0;i<l;i++)i in e&&x(r,e[i]);u(r,S(t)),n=r.length,i=0;while(i<n)e[i]=r[i++];while(i<l)delete e[i++];return e}})},"4f39":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,"#svg{background-size:20px 20px,20px 20px,10px 10px,10px 10px;background-image:linear-gradient(90deg,#dfdfdf 1px,transparent 0),linear-gradient(180deg,#dfdfdf 1px,transparent 0),linear-gradient(90deg,#f1f1f1 1px,transparent 0),linear-gradient(180deg,#f1f1f1 1px,transparent 0);background-position:left -1px top -1px,left -1px top -1px,left -1px top -1px,left -1px top -1px;height:100%;width:100%}#chart{position:relative;width:800px;height:600px;border:1px solid #dfdfdf}#position{position:absolute;right:4px}.unselectable{moz-user-select:-moz-none;-moz-user-select:none;-o-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.connector{cursor:crosshair;opacity:0}.connector.active{opacity:1;fill:#fff;stroke:#bbb;stroke-width:1px}.connector:hover{stroke:red}#svg .selection{stroke:#add8e6;fill:#add8e6;fill-opacity:.8;display:none}#svg .selection.active{display:block}",""]),t.exports=e},"51c7":function(t,e,n){t.exports=n.p+"img/check.60e3edbe.svg"},"51ce":function(t,e,n){t.exports=n.p+"img/user-log-hover.e551dbb9.svg"},"53c4":function(t,e,n){t.exports=n.p+"img/stop-icon.7e154d6e.svg"},"53e2":function(t,e,n){var i=n("6d25");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("499e").default;r("6b53d3ae",i,!0,{sourceMap:!1,shadowMode:!1})},"5926f":function(t,e,n){t.exports=n.p+"img/video-alt.c8b3b4a9.svg"},6234:function(t,e,n){t.exports=n.p+"img/equipment_hover.80ce442e.svg"},"65a7":function(t,e,n){t.exports=n.p+"img/text-alt.827e60e5.svg"},"68c9":function(t,e,n){t.exports=n.p+"img/task-b.4271c150.svg"},"68fe":function(t,e,n){var i=n("8afa");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("499e").default;r("16cffe1c",i,!0,{sourceMap:!1,shadowMode:!1})},"69c7":function(t,e,n){t.exports=n.p+"img/model.c61ffcf4.svg"},"6af0":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("TemplateModal",{scopedSlots:t._u([{key:"default",fn:function(){return[n("div",{staticClass:"m-modal-title"},[t._v(t._s(t.$t("MODAL.LOGOUT.TITLE")))]),n("div",{staticClass:"form-group row"},[n("div",{staticClass:"desc text-right"},[t._v(t._s(t.$t("MODAL.LOGOUT.DESC")))])]),n("div",{staticClass:"form-group row"},[n("b-button",{staticClass:"btn-cancel float-left",on:{click:t.cancel}},[t._v(t._s(t.$t("GENERAL.CANCEL")))]),n("b-button",{staticClass:"btn-ok float-right",on:{click:function(e){return t.$logout()}}},[t._v(t._s(t.$t("GENERAL.CONFIRM")))])],1)]},proxy:!0}])})},r=[],o=n("1b36"),a={components:{TemplateModal:o["a"]},props:{selectedData:Object},data:function(){return{}},methods:{cancel:function(){this.$emit("cancel")}}},s=a,l=(n("76de"),n("2877")),c=Object(l["a"])(s,i,r,!1,null,"87538b36",null);e["a"]=c.exports},"6d25":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".blue[data-v-87538b36]{color:#2173c9}.blueHover[data-v-87538b36]{color:#185597}.darkBlue[data-v-87538b36]{color:#0a519c}.grey[data-v-87538b36]{color:#7b7b7b}.greyHover[data-v-87538b36]{color:#606060}.lightgrey[data-v-87538b36]{color:#d7d7d7}.green[data-v-87538b36]{color:#3fb182}.greenHover[data-v-87538b36]{color:#37926c}.red[data-v-87538b36]{color:#d44e4e}.redHover[data-v-87538b36]{color:#b44b4b}.placeholder[data-v-87538b36]{color:#aeaeae}.placeholderHover[data-v-87538b36]{color:#7b7b7b}.white[data-v-87538b36]{color:#fff}.custom-pagination[data-v-87538b36]{width:calc(100% - 60px)}.custom-pagination[data-v-87538b36] .pagination{float:right}.custom-pagination[data-v-87538b36] .VuePagination__pagination-item-next-chunk .page-link,.custom-pagination[data-v-87538b36] .VuePagination__pagination-item-prev-chunk .page-link{padding:7px}.custom-pagination[data-v-87538b36] .page-link{width:38px;height:38px;border-radius:19px;margin:0 2px;text-align:center;color:#2173c9;cursor:pointer}.custom-pagination[data-v-87538b36] .page-link.active{color:#fff;background-color:#2173c9;border-color:#2173c9}.m-modal-title[data-v-87538b36]{margin-bottom:30px;color:#212529;padding-bottom:15px;font-size:22px;font-weight:700;border-bottom:2px solid #e7e7e9}.form-group[data-v-87538b36]{position:relative;margin:20px auto;margin-bottom:30px;width:100%}.form-group[data-v-87538b36]:focus{border:2px solid #4b8bcf;box-shadow:none}.form-group .desc[data-v-87538b36]{font-size:16px;color:#7b7b7b}.form-group .m-text[data-v-87538b36]{color:#212529;width:100%;padding:12px;border:2px solid #e7e7e9;border-radius:10px;min-height:100px}.form-group .btn-cancel[data-v-87538b36],.form-group .btn-ok[data-v-87538b36]{width:47%;height:38px;padding:0 12px;border-radius:10px;box-shadow:0 3px 3px 0 rgba(0,0,0,.15)}@media (max-width:1200px){.form-group .btn-cancel[data-v-87538b36],.form-group .btn-ok[data-v-87538b36]{width:100%;margin:5px 0}}.form-group .btn-cancel[data-v-87538b36]{color:#2173c9;background-color:#fff;border:1px solid #2173c9}.form-group .btn-ok[data-v-87538b36]{margin-left:6%;color:#fff;background-color:#2173c9;border:1px solid #2173c9}@media (max-width:1200px){.form-group .btn-ok[data-v-87538b36]{margin-left:0}}",""]),t.exports=e},"6dcc":function(t,e,n){t.exports=n.p+"img/analysis.86e51ef7.svg"},"6ea7":function(t,e,n){t.exports=n.p+"img/list-alt.da02dba9.svg"},"6f49":function(t,e,n){t.exports=n.p+"img/equipment.1cb2f023.svg"},"6fbc":function(t,e,n){t.exports=n.p+"img/enterprise-hover.eb6908dd.svg"},"72af":function(t,e,n){t.exports=n.p+"img/stop-icon.7e154d6e.svg"},"74f9":function(t,e,n){var i=n("0ace");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("499e").default;r("59a00072",i,!0,{sourceMap:!1,shadowMode:!1})},"76de":function(t,e,n){"use strict";n("53e2")},"79e2":function(t,e,n){t.exports=n.p+"img/analysis-hover.5a77f513.svg"},"7abd":function(t,e,n){"use strict";n("1422")},"7dae":function(t,e,n){t.exports=n.p+"img/workflow_management.1b5d8a0b.svg"},"82d7":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".blue[data-v-0f96279e]{color:#2173c9}.blueHover[data-v-0f96279e]{color:#185597}.darkBlue[data-v-0f96279e]{color:#0a519c}.grey[data-v-0f96279e]{color:#7b7b7b}.greyHover[data-v-0f96279e]{color:#606060}.lightgrey[data-v-0f96279e]{color:#d7d7d7}.green[data-v-0f96279e]{color:#3fb182}.greenHover[data-v-0f96279e]{color:#37926c}.red[data-v-0f96279e]{color:#d44e4e}.redHover[data-v-0f96279e]{color:#b44b4b}.placeholder[data-v-0f96279e]{color:#aeaeae}.placeholderHover[data-v-0f96279e]{color:#7b7b7b}.white[data-v-0f96279e]{color:#fff}.custom-pagination[data-v-0f96279e]{width:calc(100% - 60px)}.custom-pagination[data-v-0f96279e] .pagination{float:right}.custom-pagination[data-v-0f96279e] .VuePagination__pagination-item-next-chunk .page-link,.custom-pagination[data-v-0f96279e] .VuePagination__pagination-item-prev-chunk .page-link{padding:7px}.custom-pagination[data-v-0f96279e] .page-link{width:38px;height:38px;border-radius:19px;margin:0 2px;text-align:center;color:#2173c9;cursor:pointer}.custom-pagination[data-v-0f96279e] .page-link.active{color:#fff;background-color:#2173c9;border-color:#2173c9}.workflow[data-v-0f96279e]{background-color:#fefefe;font-family:微軟正黑體}.workflow .workflow-container[data-v-0f96279e]{padding-top:62px;height:100vh}.workflow .workflow-container .col-1[data-v-0f96279e]{width:3.666667%;flex:0 0 3.666667%;max-width:3.666667%;background-color:#b3d5f4!important}.workflow .workflow-container .col-9[data-v-0f96279e]{width:79%;flex:0 0 79%;max-width:79%}.workflow .workflow-container .left-section[data-v-0f96279e]{background-color:#f9f9f9;box-shadow:inset 0 4px 16px rgba(17,17,26,.05),inset 0 8px 32px rgba(17,17,26,.05)}.workflow .workflow-container .left-section .menu[data-v-0f96279e]{margin:13px 10px 8px 10px;border-bottom:2px solid #7b7b7b;padding-bottom:2px}.workflow .workflow-container .left-section .menu .menu-icon[data-v-0f96279e]{width:14px;color:#2173c9}.workflow .workflow-container .left-section .minified img[data-v-0f96279e]{width:25px}.workflow .workflow-container .left-section .minified img[data-v-0f96279e]:hover{color:#2173c9}.workflow .workflow-container .left-section .edit-link[data-v-0f96279e]{position:relative;margin:13px 10px 8px 10px;border-top:2px solid #7b7b7b}.workflow .workflow-container .left-section .edit-link .edit-link-icon[data-v-0f96279e]{margin-top:25px;color:#2173c9;width:25px}.workflow .workflow-container .left-section .edit-link .tip-dot[data-v-0f96279e]{position:absolute;width:10px;height:10px;top:21px;right:0;border-radius:50%;background-color:#d44e4e}.workflow .workflow-container .left-section .template-component[data-v-0f96279e]{transition:all .2s ease}.workflow .workflow-container .left-section .template-component[data-v-0f96279e]:hover{transform:translateY(-5px)}.workflow .workflow-container .left-section .template-component .template-outline[data-v-0f96279e]{border-radius:8px;background-color:#fff;border:1px solid #fff;box-shadow:0 3px 5px rgba(0,0,0,.1)}.workflow .workflow-container .left-section .template-component .template-outline svg[data-v-0f96279e]{color:#7b7b7b}.workflow .workflow-container .left-section .template-component .template-img[data-v-0f96279e]{width:60px}@media (max-width:1200px){.workflow .workflow-container .left-section .template-component .template-img[data-v-0f96279e]{width:40px}}.workflow .workflow-container .left-section .template-component .template-title[data-v-0f96279e]{color:#7b7b7b;font-size:14px}.workflow .workflow-container .left-section .functions[data-v-0f96279e]{width:150px;cursor:pointer}.workflow .workflow-container .left-section .error-edit-section .error-sub-title[data-v-0f96279e]{font-size:14px}.workflow .workflow-container .left-section .error-edit-section .error-card[data-v-0f96279e]{background-color:#fff;border-radius:10px;height:56px;box-shadow:0 3px 5px rgba(0,0,0,.1)}.workflow .workflow-container .left-section .error-edit-section .error-card[data-v-0f96279e]:hover{transform:translate(-5px)}.workflow .workflow-container .left-section .error-edit-section .error-card .decor-line[data-v-0f96279e]{width:6px;height:100%;background-color:#d44e4e;border-top-left-radius:10px;border-bottom-left-radius:10px}.workflow .workflow-container .left-section .error-edit-section .error-card .error-card-title[data-v-0f96279e]{color:#d44e4e}.workflow .workflow-container .left-section .error-edit-section .error-card .error-card-msg[data-v-0f96279e]{font-size:14px}.workflow .workflow-container .left-section .error-edit-section .error-card .warning-bg[data-v-0f96279e]{background-color:#f7a63d}.workflow .workflow-container .left-section .error-edit-section .error-card .warning-msg[data-v-0f96279e]{color:#e09635}.workflow .workflow-container .middle-section[data-v-0f96279e]{z-index:9}.workflow .workflow-container .middle-section .flowchart-container[data-v-0f96279e]{height:calc(100vh - 150px);overflow:scroll}.workflow .workflow-container .middle-section .flowchart-container .previewer[data-v-0f96279e]{aspect-ratio:16/9;position:absolute;bottom:3vh;height:43vh;transition:all .2s ease-in-out}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-header[data-v-0f96279e]{height:15%;color:#fff;background-color:#9b9b9b;border-top-right-radius:8px}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-header .header-step[data-v-0f96279e]{margin-top:8px;width:110px;height:40px;font-size:24px;background-color:#5b5b5b;border-top-right-radius:20px;border-bottom-right-radius:20px}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-header .null[data-v-0f96279e]{width:100px;line-height:40px;font-size:14px;font-weight:700}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-header .header-title[data-v-0f96279e]{margin-top:8px;font-weight:700;max-width:520px}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-header .header-title .header-title-text[data-v-0f96279e]{overflow:hidden;font-size:24px;text-overflow:ellipsis;white-space:nowrap}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-header .minify-btn[data-v-0f96279e]{margin-top:8px;width:110px;height:40px;line-height:40px;font-size:18px;font-weight:700;background-color:#2173c9;border-top-left-radius:20px;border-bottom-left-radius:20px}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-header .en-fontsize[data-v-0f96279e]{width:100px;font-size:14px}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body[data-v-0f96279e]{padding-top:6px;height:70%;background-color:#9b9b9b}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner[data-v-0f96279e]{height:100%}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .text-only[data-v-0f96279e]{font-size:24px;font-weight:700;color:#fff;word-break:break-all}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .previewer-desc[data-v-0f96279e]{padding:0 12px;width:33%;font-size:18px;font-weight:700;color:#fff;word-break:break-all;overflow:hidden}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .previewer-desc strong[data-v-0f96279e]{white-space:pre-wrap}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .previewer-content[data-v-0f96279e]{margin-right:12px;width:calc(67% - 12px);height:100%;overflow:hidden;background-color:#eee}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .previewer-content .img[data-v-0f96279e]{height:100%}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .previewer-content .vid[data-v-0f96279e]{height:inherit}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .previewer-content .empty-text[data-v-0f96279e]{margin-top:100px;font-size:30px}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .previewer-content .progress-section[data-v-0f96279e]{height:100px;width:80%}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .previewer-content .progress-section .progress-text[data-v-0f96279e]{margin-top:100px;font-size:30px}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-body .previewer-body-inner .full-w[data-v-0f96279e]{width:70%;margin:0 15%}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-footer[data-v-0f96279e]{height:15%;line-height:15%;color:#fff;font-weight:700;background-color:#9b9b9b;border-top-right-radius:0;transition:all .2s ease-in-out}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-footer .expand-btn[data-v-0f96279e]{width:100px;height:40px;line-height:40px}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-footer .glasses-btn-group[data-v-0f96279e]{padding:10px}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-footer .glasses-btn-group .btn[data-v-0f96279e]{font-weight:700;min-width:90px;height:30px;line-height:28px;border-radius:15px;cursor:default}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-footer .glasses-btn-group .dark[data-v-0f96279e]{color:#fff;background-color:#5b5b5b;border:2px solid #9b9b9b}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-footer .glasses-btn-group .light[data-v-0f96279e]{background-color:#fff;border:2px solid #9b9b9b}.workflow .workflow-container .middle-section .flowchart-container .previewer .previewer-footer .glasses-btn-group .active[data-v-0f96279e]{color:#2173c9;background-color:#fff;border:2px solid #2173c9}.workflow .workflow-container .middle-section .flowchart-container .previewer .minified-footer[data-v-0f96279e]{height:100%;line-height:100%;background-color:#2173c9;border-top-right-radius:8px}.workflow .workflow-container .middle-section .flowchart-container .minified-previewer[data-v-0f96279e]{height:40px;border:none;transition:all .2s ease-in-out}.workflow .workflow-container .middle-section .flowchart-container .toggle-sidebar[data-v-0f96279e]{position:absolute;background-color:#f2f2f2;top:45%;left:-10px;width:25px;height:40px;border-bottom-right-radius:5px;border-top-right-radius:5px;padding-top:8px}.workflow .workflow-container .middle-section .flowchart-container .toggle-sidebar svg[data-v-0f96279e]{color:#7b7b7b;width:20px;height:24px;transition:all 1s ease-in-out}.workflow .workflow-container .middle-section .flowchart-container .toggle-sidebar .arrow-right[data-v-0f96279e]{color:#fff;transition:all 1s ease-in-out}.workflow .workflow-container .middle-section .flowchart-container .minified-sidebar[data-v-0f96279e]{background-color:#b1d0ef}.workflow .workflow-container .right-section[data-v-0f96279e]{background-color:#f9f9f9;box-shadow:inset 0 4px 16px rgba(17,17,26,.05),inset 0 8px 32px rgba(17,17,26,.05);z-index:999}.workflow .workflow-container .right-section .edit-section[data-v-0f96279e]{height:calc(100vh - 198px);overflow-y:scroll}.workflow .workflow-container .right-section .edit-section .card-component[data-v-0f96279e]{border-radius:8px;background-color:#fff;box-shadow:0 3px 5px rgba(0,0,0,.1)}.workflow .workflow-container .right-section .edit-section .card-component .card-title[data-v-0f96279e]{line-height:44px;font-weight:700;font-size:18px}.workflow .workflow-container .right-section .edit-section .card-component .card-title .toggle-btn[data-v-0f96279e]{float:right;top:12px;right:10px}.workflow .workflow-container .right-section .edit-section .card-component .card-body[data-v-0f96279e]{border-top:1px solid #eee}.workflow .workflow-container .right-section .edit-section .card-component .card-body .form-control[data-v-0f96279e]{background-color:#f5f5f5;font-size:14px;border:none;transition:all .3s ease-in-out}.workflow .workflow-container .right-section .edit-section .card-component .card-body .form-control[data-v-0f96279e]:focus{border:2px solid #4b8bcf;box-shadow:none}.workflow .workflow-container .right-section .edit-section .card-component .card-body .pass[data-v-0f96279e]{position:relative}.workflow .workflow-container .right-section .edit-section .card-component .card-body .pass .pass-text[data-v-0f96279e]{border:2px solid #3fb182!important}.workflow .workflow-container .right-section .edit-section .card-component .card-body .pass .pass-icon[data-v-0f96279e]{position:absolute;top:-7px;right:-7px;background-color:#fff;color:#3fb182}.workflow .workflow-container .right-section .edit-section .card-component .card-body .fail[data-v-0f96279e]{position:relative}.workflow .workflow-container .right-section .edit-section .card-component .card-body .fail .fail-text[data-v-0f96279e]{border:2px solid #d44e4e!important}.workflow .workflow-container .right-section .edit-section .card-component .card-body .fail .fail-icon[data-v-0f96279e]{position:absolute;top:-7px;right:-7px;background-color:#fff;color:#d44e4e}.workflow .workflow-container .right-section .edit-section .card-component .card-body .node-pic .m-text[data-v-0f96279e],.workflow .workflow-container .right-section .edit-section .card-component .card-body .node-vid .m-text[data-v-0f96279e]{font-size:14px;padding:12px;background-color:#f5f5f5;border-radius:8px}.workflow .workflow-container .right-section .edit-section .card-component .card-body .err-input[data-v-0f96279e]{border:2px solid #d44e4e!important}.workflow .workflow-container .right-section .edit-section .card-component .card-body .err-input[data-v-0f96279e]:focus{border:2px solid #d44e4e;box-shadow:none}.workflow .workflow-container .right-section .edit-section .card-component .card-body .err-msg[data-v-0f96279e]{color:#d44e4e}.workflow .workflow-container .right-section .edit-section .card-component .card-body .desc-count[data-v-0f96279e]{font-size:12px}.workflow .workflow-container .right-section .edit-section .card-component .card-body .type-select[data-v-0f96279e]{background-color:#f5f5f5;border:1px solid #f5f5f5;font-size:14px;background-image:linear-gradient(45deg,transparent 50%,#7b7b7b 60%),linear-gradient(135deg,#7b7b7b 40%,transparent 50%)!important;background-position:calc(100% - 17px) 14px,calc(100% - 10px) 14px,100% 0;background-size:7px 7px,7px 7px;background-repeat:no-repeat;-webkit-appearance:none;-moz-appearance:none;cursor:pointer}.workflow .workflow-container .right-section .edit-section .card-component .card-body .type-select option[data-v-0f96279e]{background-color:#fff;border:1px solid #fff}.workflow .workflow-container .right-section .edit-section .card-component .card-body .animation-track[data-v-0f96279e]{border-radius:8px;cursor:grab;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}.workflow .workflow-container .right-section .edit-section .card-component .card-body .animation-track .animation-input[data-v-0f96279e]{width:40px;display:inline-block;padding:6px}.workflow .workflow-container .right-section .edit-section .card-component .card-body .animation-track .animation-input[data-v-0f96279e]::-webkit-inner-spin-button,.workflow .workflow-container .right-section .edit-section .card-component .card-body .animation-track .animation-input[data-v-0f96279e]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.workflow .workflow-container .right-section .edit-section .card-component .card-body .animation-track .animation-btn[data-v-0f96279e]{color:#2173c9}.workflow .workflow-container .right-section .edit-section .card-component .card-body .animation-track .animation-btn[data-v-0f96279e]:hover{color:#185597}.workflow .workflow-container .right-section .save-and-publish[data-v-0f96279e]{margin-top:27px;margin-left:0;margin-right:0;margin-bottom:-25px;border-radius:8px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15);position:fixed;width:13.3vw}.workflow .workflow-container .right-section .save-and-publish .exit[data-v-0f96279e],.workflow .workflow-container .right-section .save-and-publish .publish[data-v-0f96279e],.workflow .workflow-container .right-section .save-and-publish .save[data-v-0f96279e]{background-color:#fff;color:#2173c9;transition:all .2s ease}.workflow .workflow-container .right-section .save-and-publish .exit[data-v-0f96279e]:hover,.workflow .workflow-container .right-section .save-and-publish .publish[data-v-0f96279e]:hover,.workflow .workflow-container .right-section .save-and-publish .save[data-v-0f96279e]:hover{transform:translateY(-3px)}.workflow .workflow-container .right-section .save-and-publish .exit[data-v-0f96279e]{border-top-left-radius:8px;border-right:1px solid #eee}.workflow .workflow-container .right-section .save-and-publish .publish[data-v-0f96279e]{border-top-right-radius:8px;border-left:1px solid #eee}.workflow .workflow-container .tab-group[data-v-0f96279e]{padding-top:9px;margin-bottom:24px;border-bottom:2px solid #2173c9;font-weight:700}.workflow .workflow-container .tab-group .active-tab[data-v-0f96279e],.workflow .workflow-container .tab-group .inactive-tab[data-v-0f96279e]{height:40px;line-height:40px;font-size:16px;border-top-left-radius:8px;border-top-right-radius:8px}.workflow .workflow-container .tab-group .active-tab[data-v-0f96279e]{color:#fff;background-color:#2173c9;border:2px solid #2173c9;border-bottom:none;box-shadow:0 -3px 3px 0 rgba(0,0,0,.15)}.workflow .workflow-container .tab-group .inactive-tab[data-v-0f96279e]{border:2px solid #ccc;border-bottom:none;background-color:#d9d9d9}.workflow .workflow-container .tab-group .inactive-tab[data-v-0f96279e]:hover{color:#fff;background-color:#2173c9;border:2px solid #2173c9;border-bottom:none}.title[data-v-0f96279e]{margin-top:15px;margin-bottom:24px;border-bottom:2px solid #7b7b7b;padding-bottom:10px;font-weight:700}.title .title-icon[data-v-0f96279e]{width:14px;color:#2173c9}.title .h-18[data-v-0f96279e]{width:unset;height:18px}.model-length[data-v-0f96279e]{font-size:14px}.model-length .model-length-text[data-v-0f96279e]{color:#2173c9}.upload-btn[data-v-0f96279e]{color:#fff;background-color:#2173c9}.delete-btn[data-v-0f96279e]{color:#fff;background-color:#d44e4e}.snapshot[data-v-0f96279e]{width:100%}.subtitle[data-v-0f96279e]{font-size:14px;margin:10px;margin-bottom:10px}.show-transition[data-v-0f96279e]{transition:all .2s ease-in-out}[data-v-0f96279e] .custom-control-input:checked~.custom-control-label:before{border-color:#2173c9;background-color:#2173c9;cursor:pointer}[data-v-0f96279e] .custom-switch .custom-control-label:before{border-color:#7b7b7b;background-color:#7b7b7b;cursor:pointer}[data-v-0f96279e] .custom-switch .custom-control-label:after{border-color:#fff;background-color:#fff;cursor:pointer}",""]),t.exports=e},"83f9":function(t,e,n){t.exports=n.p+"img/workflow-b.2c231b72.svg"},"84ed":function(t,e,n){t.exports=n.p+"img/text+model.19935ee6.svg"},"8afa":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".header[data-v-2b3cbec8]{width:100%;position:fixed;top:0;z-index:99999;color:#fff;background:linear-gradient(60deg,#000,#2a3746 35%,#12274d 70%,#023773)}.header .header-title[data-v-2b3cbec8]{font-weight:700}.header .header-title .header-icon[data-v-2b3cbec8]{width:40px;margin-top:-10px}.header .header-title .header-main-title[data-v-2b3cbec8]{line-height:60px;font-size:24px;text-decoration:none}.header .header-title .header-sub-title[data-v-2b3cbec8]{color:#b3d5f4;line-height:60px;font-size:22px;text-decoration:none}.header .login[data-v-2b3cbec8]{height:62px;line-height:62px;font-size:18px}.header .login .user-icon[data-v-2b3cbec8]{margin-right:-5px;width:18px}.header .login .call-btn[data-v-2b3cbec8]{color:#fff}.header .login .call-btn[data-v-2b3cbec8]:hover{color:#ccc}.header .login[data-v-2b3cbec8] .btn-outline-none{color:#fff}.header .login[data-v-2b3cbec8] .btn:focus{box-shadow:none}.header .login[data-v-2b3cbec8] .dropdown-item{line-height:30px}",""]),t.exports=e},"8d63":function(t,e,n){t.exports=n.p+"img/text+video.705f1046.svg"},"91a4":function(t,e,n){t.exports=n.p+"img/text+model-alt.b91244e3.svg"},"936d":function(t,e,n){t.exports=n.p+"img/account-b.3727d628.svg"},"95d8":function(t,e,n){t.exports=n.p+"img/workflow-c.b6a6f798.svg"},9767:function(t,e,n){t.exports=n.p+"img/check-icon.4dc20323.svg"},9949:function(t,e,n){t.exports=n.p+"img/skip.74cb762f.svg"},"9bba":function(t,e,n){t.exports=n.p+"img/recorded-video-hover.7da3ea9d.svg"},a325:function(t,e,n){t.exports=n.p+"img/model-alt.b8578c02.svg"},aa47:function(t,e,n){"use strict";
/**!
 * Sortable 1.10.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function i(t){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(){return o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o.apply(this,arguments)}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),i.forEach((function(e){r(t,e,n[e])}))}return t}function s(t,e){if(null==t)return{};var n,i,r={},o=Object.keys(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)>=0||(r[n]=t[n]);return r}function l(t,e){if(null==t)return{};var n,i,r=s(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function c(t){return u(t)||h(t)||d()}function u(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function h(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}n.r(e),n.d(e,"MultiDrag",(function(){return Ue})),n.d(e,"Sortable",(function(){return Kt})),n.d(e,"Swap",(function(){return Ee}));var p="1.10.2";function f(t){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var m=f(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),g=f(/Edge/i),v=f(/firefox/i),x=f(/safari/i)&&!f(/chrome/i)&&!f(/android/i),y=f(/iP(ad|od|hone)/i),_=f(/chrome/i)&&f(/android/i),b={capture:!1,passive:!1};function w(t,e,n){t.addEventListener(e,n,!m&&b)}function M(t,e,n){t.removeEventListener(e,n,!m&&b)}function S(t,e){if(e){if(">"===e[0]&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(n){return!1}return!1}}function T(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function E(t,e,n,i){if(t){n=n||document;do{if(null!=e&&(">"===e[0]?t.parentNode===n&&S(t,e):S(t,e))||i&&t===n)return t;if(t===n)break}while(t=T(t))}return null}var C,A=/\s+/g;function L(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(A," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(A," ")}}function R(t,e,n){var i=t&&t.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in i||-1!==e.indexOf("webkit")||(e="-webkit-"+e),i[e]=n+("string"===typeof n?"":"px")}}function P(t,e){var n="";if("string"===typeof t)n=t;else do{var i=R(t,"transform");i&&"none"!==i&&(n=i+" "+n)}while(!e&&(t=t.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function N(t,e,n){if(t){var i=t.getElementsByTagName(e),r=0,o=i.length;if(n)for(;r<o;r++)n(i[r],r);return i}return[]}function D(){var t=document.scrollingElement;return t||document.documentElement}function k(t,e,n,i,r){if(t.getBoundingClientRect||t===window){var o,a,s,l,c,u,h;if(t!==window&&t!==D()?(o=t.getBoundingClientRect(),a=o.top,s=o.left,l=o.bottom,c=o.right,u=o.height,h=o.width):(a=0,s=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,h=window.innerWidth),(e||n)&&t!==window&&(r=r||t.parentNode,!m))do{if(r&&r.getBoundingClientRect&&("none"!==R(r,"transform")||n&&"static"!==R(r,"position"))){var d=r.getBoundingClientRect();a-=d.top+parseInt(R(r,"border-top-width")),s-=d.left+parseInt(R(r,"border-left-width")),l=a+o.height,c=s+o.width;break}}while(r=r.parentNode);if(i&&t!==window){var p=P(r||t),f=p&&p.a,g=p&&p.d;p&&(a/=g,s/=f,h/=f,u/=g,l=a+u,c=s+h)}return{top:a,left:s,bottom:l,right:c,width:h,height:u}}}function I(t,e,n){var i=B(t,!0),r=k(t)[e];while(i){var o=k(i)[n],a=void 0;if(a="top"===n||"left"===n?r>=o:r<=o,!a)return i;if(i===D())break;i=B(i,!1)}return!1}function O(t,e,n){var i=0,r=0,o=t.children;while(r<o.length){if("none"!==o[r].style.display&&o[r]!==Kt.ghost&&o[r]!==Kt.dragged&&E(o[r],n.draggable,t,!1)){if(i===e)return o[r];i++}r++}return null}function F(t,e){var n=t.lastElementChild;while(n&&(n===Kt.ghost||"none"===R(n,"display")||e&&!S(n,e)))n=n.previousElementSibling;return n||null}function U(t,e){var n=0;if(!t||!t.parentNode)return-1;while(t=t.previousElementSibling)"TEMPLATE"===t.nodeName.toUpperCase()||t===Kt.clone||e&&!S(t,e)||n++;return n}function z(t){var e=0,n=0,i=D();if(t)do{var r=P(t),o=r.a,a=r.d;e+=t.scrollLeft*o,n+=t.scrollTop*a}while(t!==i&&(t=t.parentNode));return[e,n]}function H(t,e){for(var n in t)if(t.hasOwnProperty(n))for(var i in e)if(e.hasOwnProperty(i)&&e[i]===t[n][i])return Number(n);return-1}function B(t,e){if(!t||!t.getBoundingClientRect)return D();var n=t,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=R(n);if(n.clientWidth<n.scrollWidth&&("auto"==r.overflowX||"scroll"==r.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==r.overflowY||"scroll"==r.overflowY)){if(!n.getBoundingClientRect||n===document.body)return D();if(i||e)return n;i=!0}}}while(n=n.parentNode);return D()}function V(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function G(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function W(t,e){return function(){if(!C){var n=arguments,i=this;1===n.length?t.call(i,n[0]):t.apply(i,n),C=setTimeout((function(){C=void 0}),e)}}}function j(){clearTimeout(C),C=void 0}function q(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function X(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function Y(t,e){R(t,"position","absolute"),R(t,"top",e.top),R(t,"left",e.left),R(t,"width",e.width),R(t,"height",e.height)}function $(t){R(t,"position",""),R(t,"top",""),R(t,"left",""),R(t,"width",""),R(t,"height","")}var Z="Sortable"+(new Date).getTime();function J(){var t,e=[];return{captureAnimationState:function(){if(e=[],this.options.animation){var t=[].slice.call(this.el.children);t.forEach((function(t){if("none"!==R(t,"display")&&t!==Kt.ghost){e.push({target:t,rect:k(t)});var n=a({},e[e.length-1].rect);if(t.thisAnimationDuration){var i=P(t,!0);i&&(n.top-=i.f,n.left-=i.e)}t.fromRect=n}}))}},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(H(e,{target:t}),1)},animateAll:function(n){var i=this;if(!this.options.animation)return clearTimeout(t),void("function"===typeof n&&n());var r=!1,o=0;e.forEach((function(t){var e=0,n=t.target,a=n.fromRect,s=k(n),l=n.prevFromRect,c=n.prevToRect,u=t.rect,h=P(n,!0);h&&(s.top-=h.f,s.left-=h.e),n.toRect=s,n.thisAnimationDuration&&G(l,s)&&!G(a,s)&&(u.top-s.top)/(u.left-s.left)===(a.top-s.top)/(a.left-s.left)&&(e=Q(u,l,c,i.options)),G(s,a)||(n.prevFromRect=a,n.prevToRect=s,e||(e=i.options.animation),i.animate(n,u,s,e)),e&&(r=!0,o=Math.max(o,e),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),e),n.thisAnimationDuration=e)})),clearTimeout(t),r?t=setTimeout((function(){"function"===typeof n&&n()}),o):"function"===typeof n&&n(),e=[]},animate:function(t,e,n,i){if(i){R(t,"transition",""),R(t,"transform","");var r=P(this.el),o=r&&r.a,a=r&&r.d,s=(e.left-n.left)/(o||1),l=(e.top-n.top)/(a||1);t.animatingX=!!s,t.animatingY=!!l,R(t,"transform","translate3d("+s+"px,"+l+"px,0)"),K(t),R(t,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),R(t,"transform","translate3d(0,0,0)"),"number"===typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout((function(){R(t,"transition",""),R(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1}),i)}}}}function K(t){return t.offsetWidth}function Q(t,e,n,i){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*i.animation}var tt=[],et={initializeByDefault:!0},nt={mount:function(t){for(var e in et)et.hasOwnProperty(e)&&!(e in t)&&(t[e]=et[e]);tt.push(t)},pluginEvent:function(t,e,n){var i=this;this.eventCanceled=!1,n.cancel=function(){i.eventCanceled=!0};var r=t+"Global";tt.forEach((function(i){e[i.pluginName]&&(e[i.pluginName][r]&&e[i.pluginName][r](a({sortable:e},n)),e.options[i.pluginName]&&e[i.pluginName][t]&&e[i.pluginName][t](a({sortable:e},n)))}))},initializePlugins:function(t,e,n,i){for(var r in tt.forEach((function(i){var r=i.pluginName;if(t.options[r]||i.initializeByDefault){var a=new i(t,e,t.options);a.sortable=t,a.options=t.options,t[r]=a,o(n,a.defaults)}})),t.options)if(t.options.hasOwnProperty(r)){var a=this.modifyOption(t,r,t.options[r]);"undefined"!==typeof a&&(t.options[r]=a)}},getEventProperties:function(t,e){var n={};return tt.forEach((function(i){"function"===typeof i.eventProperties&&o(n,i.eventProperties.call(e[i.pluginName],t))})),n},modifyOption:function(t,e,n){var i;return tt.forEach((function(r){t[r.pluginName]&&r.optionListeners&&"function"===typeof r.optionListeners[e]&&(i=r.optionListeners[e].call(t[r.pluginName],n))})),i}};function it(t){var e=t.sortable,n=t.rootEl,i=t.name,r=t.targetEl,o=t.cloneEl,s=t.toEl,l=t.fromEl,c=t.oldIndex,u=t.newIndex,h=t.oldDraggableIndex,d=t.newDraggableIndex,p=t.originalEvent,f=t.putSortable,v=t.extraEventProperties;if(e=e||n&&n[Z],e){var x,y=e.options,_="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||m||g?(x=document.createEvent("Event"),x.initEvent(i,!0,!0)):x=new CustomEvent(i,{bubbles:!0,cancelable:!0}),x.to=s||n,x.from=l||n,x.item=r||n,x.clone=o,x.oldIndex=c,x.newIndex=u,x.oldDraggableIndex=h,x.newDraggableIndex=d,x.originalEvent=p,x.pullMode=f?f.lastPutMode:void 0;var b=a({},v,nt.getEventProperties(i,e));for(var w in b)x[w]=b[w];n&&n.dispatchEvent(x),y[_]&&y[_].call(e,x)}}var rt=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.evt,r=l(n,["evt"]);nt.pluginEvent.bind(Kt)(t,e,a({dragEl:at,parentEl:st,ghostEl:lt,rootEl:ct,nextEl:ut,lastDownEl:ht,cloneEl:dt,cloneHidden:pt,dragStarted:Et,putSortable:yt,activeSortable:Kt.active,originalEvent:i,oldIndex:ft,oldDraggableIndex:gt,newIndex:mt,newDraggableIndex:vt,hideGhostForTarget:Yt,unhideGhostForTarget:$t,cloneNowHidden:function(){pt=!0},cloneNowShown:function(){pt=!1},dispatchSortableEvent:function(t){ot({sortable:e,name:t,originalEvent:i})}},r))};function ot(t){it(a({putSortable:yt,cloneEl:dt,targetEl:at,rootEl:ct,oldIndex:ft,oldDraggableIndex:gt,newIndex:mt,newDraggableIndex:vt},t))}var at,st,lt,ct,ut,ht,dt,pt,ft,mt,gt,vt,xt,yt,_t,bt,wt,Mt,St,Tt,Et,Ct,At,Lt,Rt,Pt=!1,Nt=!1,Dt=[],kt=!1,It=!1,Ot=[],Ft=!1,Ut=[],zt="undefined"!==typeof document,Ht=y,Bt=g||m?"cssFloat":"float",Vt=zt&&!_&&!y&&"draggable"in document.createElement("div"),Gt=function(){if(zt){if(m)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),Wt=function(t,e){var n=R(t),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),r=O(t,0,e),o=O(t,1,e),a=r&&R(r),s=o&&R(o),l=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+k(r).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+k(o).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&a["float"]&&"none"!==a["float"]){var u="left"===a["float"]?"left":"right";return!o||"both"!==s.clear&&s.clear!==u?"horizontal":"vertical"}return r&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||l>=i&&"none"===n[Bt]||o&&"none"===n[Bt]&&l+c>i)?"vertical":"horizontal"},jt=function(t,e,n){var i=n?t.left:t.top,r=n?t.right:t.bottom,o=n?t.width:t.height,a=n?e.left:e.top,s=n?e.right:e.bottom,l=n?e.width:e.height;return i===a||r===s||i+o/2===a+l/2},qt=function(t,e){var n;return Dt.some((function(i){if(!F(i)){var r=k(i),o=i[Z].options.emptyInsertThreshold,a=t>=r.left-o&&t<=r.right+o,s=e>=r.top-o&&e<=r.bottom+o;return o&&a&&s?n=i:void 0}})),n},Xt=function(t){function e(t,n){return function(i,r,o,a){var s=i.options.group.name&&r.options.group.name&&i.options.group.name===r.options.group.name;if(null==t&&(n||s))return!0;if(null==t||!1===t)return!1;if(n&&"clone"===t)return t;if("function"===typeof t)return e(t(i,r,o,a),n)(i,r,o,a);var l=(n?i:r).options.group.name;return!0===t||"string"===typeof t&&t===l||t.join&&t.indexOf(l)>-1}}var n={},r=t.group;r&&"object"==i(r)||(r={name:r}),n.name=r.name,n.checkPull=e(r.pull,!0),n.checkPut=e(r.put),n.revertClone=r.revertClone,t.group=n},Yt=function(){!Gt&&lt&&R(lt,"display","none")},$t=function(){!Gt&&lt&&R(lt,"display","")};zt&&document.addEventListener("click",(function(t){if(Nt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Nt=!1,!1}),!0);var Zt=function(t){if(at){t=t.touches?t.touches[0]:t;var e=qt(t.clientX,t.clientY);if(e){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.target=n.rootEl=e,n.preventDefault=void 0,n.stopPropagation=void 0,e[Z]._onDragOver(n)}}},Jt=function(t){at&&at.parentNode[Z]._isOutsideThisEl(t.target)};function Kt(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=o({},e),t[Z]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Wt(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Kt.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};for(var i in nt.initializePlugins(this,t,n),n)!(i in e)&&(e[i]=n[i]);for(var r in Xt(e),this)"_"===r.charAt(0)&&"function"===typeof this[r]&&(this[r]=this[r].bind(this));this.nativeDraggable=!e.forceFallback&&Vt,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?w(t,"pointerdown",this._onTapStart):(w(t,"mousedown",this._onTapStart),w(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(w(t,"dragover",this),w(t,"dragenter",this)),Dt.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),o(this,J())}function Qt(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function te(t,e,n,i,r,o,a,s){var l,c,u=t[Z],h=u.options.onMove;return!window.CustomEvent||m||g?(l=document.createEvent("Event"),l.initEvent("move",!0,!0)):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=e,l.from=t,l.dragged=n,l.draggedRect=i,l.related=r||e,l.relatedRect=o||k(e),l.willInsertAfter=s,l.originalEvent=a,t.dispatchEvent(l),h&&(c=h.call(u,l,a)),c}function ee(t){t.draggable=!1}function ne(){Ft=!1}function ie(t,e,n){var i=k(F(n.el,n.options.draggable)),r=10;return e?t.clientX>i.right+r||t.clientX<=i.right&&t.clientY>i.bottom&&t.clientX>=i.left:t.clientX>i.right&&t.clientY>i.top||t.clientX<=i.right&&t.clientY>i.bottom+r}function re(t,e,n,i,r,o,a,s){var l=i?t.clientY:t.clientX,c=i?n.height:n.width,u=i?n.top:n.left,h=i?n.bottom:n.right,d=!1;if(!a)if(s&&Lt<c*r){if(!kt&&(1===At?l>u+c*o/2:l<h-c*o/2)&&(kt=!0),kt)d=!0;else if(1===At?l<u+Lt:l>h-Lt)return-At}else if(l>u+c*(1-r)/2&&l<h-c*(1-r)/2)return oe(e);return d=d||a,d&&(l<u+c*o/2||l>h-c*o/2)?l>u+c/2?1:-1:0}function oe(t){return U(at)<U(t)?1:-1}function ae(t){var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;while(n--)i+=e.charCodeAt(n);return i.toString(36)}function se(t){Ut.length=0;var e=t.getElementsByTagName("input"),n=e.length;while(n--){var i=e[n];i.checked&&Ut.push(i)}}function le(t){return setTimeout(t,0)}function ce(t){return clearTimeout(t)}Kt.prototype={constructor:Kt,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(Ct=null)},_getDirection:function(t,e){return"function"===typeof this.options.direction?this.options.direction.call(this,t,e,at):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,i=this.options,r=i.preventOnFilter,o=t.type,a=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,s=(a||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,c=i.filter;if(se(n),!at&&!(/mousedown|pointerdown/.test(o)&&0!==t.button||i.disabled)&&!l.isContentEditable&&(s=E(s,i.draggable,n,!1),(!s||!s.animated)&&ht!==s)){if(ft=U(s),gt=U(s,i.draggable),"function"===typeof c){if(c.call(this,t,s,this))return ot({sortable:e,rootEl:l,name:"filter",targetEl:s,toEl:n,fromEl:n}),rt("filter",e,{evt:t}),void(r&&t.cancelable&&t.preventDefault())}else if(c&&(c=c.split(",").some((function(i){if(i=E(l,i.trim(),n,!1),i)return ot({sortable:e,rootEl:i,name:"filter",targetEl:s,fromEl:n,toEl:n}),rt("filter",e,{evt:t}),!0})),c))return void(r&&t.cancelable&&t.preventDefault());i.handle&&!E(l,i.handle,n,!1)||this._prepareDragStart(t,a,s)}}},_prepareDragStart:function(t,e,n){var i,r=this,o=r.el,a=r.options,s=o.ownerDocument;if(n&&!at&&n.parentNode===o){var l=k(n);if(ct=o,at=n,st=at.parentNode,ut=at.nextSibling,ht=n,xt=a.group,Kt.dragged=at,_t={target:at,clientX:(e||t).clientX,clientY:(e||t).clientY},St=_t.clientX-l.left,Tt=_t.clientY-l.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,at.style["will-change"]="all",i=function(){rt("delayEnded",r,{evt:t}),Kt.eventCanceled?r._onDrop():(r._disableDelayedDragEvents(),!v&&r.nativeDraggable&&(at.draggable=!0),r._triggerDragStart(t,e),ot({sortable:r,name:"choose",originalEvent:t}),L(at,a.chosenClass,!0))},a.ignore.split(",").forEach((function(t){N(at,t.trim(),ee)})),w(s,"dragover",Zt),w(s,"mousemove",Zt),w(s,"touchmove",Zt),w(s,"mouseup",r._onDrop),w(s,"touchend",r._onDrop),w(s,"touchcancel",r._onDrop),v&&this.nativeDraggable&&(this.options.touchStartThreshold=4,at.draggable=!0),rt("delayStart",this,{evt:t}),!a.delay||a.delayOnTouchOnly&&!e||this.nativeDraggable&&(g||m))i();else{if(Kt.eventCanceled)return void this._onDrop();w(s,"mouseup",r._disableDelayedDrag),w(s,"touchend",r._disableDelayedDrag),w(s,"touchcancel",r._disableDelayedDrag),w(s,"mousemove",r._delayedDragTouchMoveHandler),w(s,"touchmove",r._delayedDragTouchMoveHandler),a.supportPointer&&w(s,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(i,a.delay)}}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){at&&ee(at),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;M(t,"mouseup",this._disableDelayedDrag),M(t,"touchend",this._disableDelayedDrag),M(t,"touchcancel",this._disableDelayedDrag),M(t,"mousemove",this._delayedDragTouchMoveHandler),M(t,"touchmove",this._delayedDragTouchMoveHandler),M(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?w(document,"pointermove",this._onTouchMove):w(document,e?"touchmove":"mousemove",this._onTouchMove):(w(at,"dragend",this),w(ct,"dragstart",this._onDragStart));try{document.selection?le((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(t,e){if(Pt=!1,ct&&at){rt("dragStarted",this,{evt:e}),this.nativeDraggable&&w(document,"dragover",Jt);var n=this.options;!t&&L(at,n.dragClass,!1),L(at,n.ghostClass,!0),Kt.active=this,t&&this._appendGhost(),ot({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(bt){this._lastX=bt.clientX,this._lastY=bt.clientY,Yt();var t=document.elementFromPoint(bt.clientX,bt.clientY),e=t;while(t&&t.shadowRoot){if(t=t.shadowRoot.elementFromPoint(bt.clientX,bt.clientY),t===e)break;e=t}if(at.parentNode[Z]._isOutsideThisEl(t),e)do{if(e[Z]){var n=void 0;if(n=e[Z]._onDragOver({clientX:bt.clientX,clientY:bt.clientY,target:t,rootEl:e}),n&&!this.options.dragoverBubble)break}t=e}while(e=e.parentNode);$t()}},_onTouchMove:function(t){if(_t){var e=this.options,n=e.fallbackTolerance,i=e.fallbackOffset,r=t.touches?t.touches[0]:t,o=lt&&P(lt,!0),a=lt&&o&&o.a,s=lt&&o&&o.d,l=Ht&&Rt&&z(Rt),c=(r.clientX-_t.clientX+i.x)/(a||1)+(l?l[0]-Ot[0]:0)/(a||1),u=(r.clientY-_t.clientY+i.y)/(s||1)+(l?l[1]-Ot[1]:0)/(s||1);if(!Kt.active&&!Pt){if(n&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(lt){o?(o.e+=c-(wt||0),o.f+=u-(Mt||0)):o={a:1,b:0,c:0,d:1,e:c,f:u};var h="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");R(lt,"webkitTransform",h),R(lt,"mozTransform",h),R(lt,"msTransform",h),R(lt,"transform",h),wt=c,Mt=u,bt=r}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!lt){var t=this.options.fallbackOnBody?document.body:ct,e=k(at,!0,Ht,!0,t),n=this.options;if(Ht){Rt=t;while("static"===R(Rt,"position")&&"none"===R(Rt,"transform")&&Rt!==document)Rt=Rt.parentNode;Rt!==document.body&&Rt!==document.documentElement?(Rt===document&&(Rt=D()),e.top+=Rt.scrollTop,e.left+=Rt.scrollLeft):Rt=D(),Ot=z(Rt)}lt=at.cloneNode(!0),L(lt,n.ghostClass,!1),L(lt,n.fallbackClass,!0),L(lt,n.dragClass,!0),R(lt,"transition",""),R(lt,"transform",""),R(lt,"box-sizing","border-box"),R(lt,"margin",0),R(lt,"top",e.top),R(lt,"left",e.left),R(lt,"width",e.width),R(lt,"height",e.height),R(lt,"opacity","0.8"),R(lt,"position",Ht?"absolute":"fixed"),R(lt,"zIndex","100000"),R(lt,"pointerEvents","none"),Kt.ghost=lt,t.appendChild(lt),R(lt,"transform-origin",St/parseInt(lt.style.width)*100+"% "+Tt/parseInt(lt.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,i=t.dataTransfer,r=n.options;rt("dragStart",this,{evt:t}),Kt.eventCanceled?this._onDrop():(rt("setupClone",this),Kt.eventCanceled||(dt=X(at),dt.draggable=!1,dt.style["will-change"]="",this._hideClone(),L(dt,this.options.chosenClass,!1),Kt.clone=dt),n.cloneId=le((function(){rt("clone",n),Kt.eventCanceled||(n.options.removeCloneOnHide||ct.insertBefore(dt,at),n._hideClone(),ot({sortable:n,name:"clone"}))})),!e&&L(at,r.dragClass,!0),e?(Nt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(M(document,"mouseup",n._onDrop),M(document,"touchend",n._onDrop),M(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",r.setData&&r.setData.call(n,i,at)),w(document,"drop",n),R(at,"transform","translateZ(0)")),Pt=!0,n._dragStartId=le(n._dragStarted.bind(n,e,t)),w(document,"selectstart",n),Et=!0,x&&R(document.body,"user-select","none"))},_onDragOver:function(t){var e,n,i,r,o=this.el,s=t.target,l=this.options,c=l.group,u=Kt.active,h=xt===c,d=l.sort,p=yt||u,f=this,m=!1;if(!Ft){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),s=E(s,l.draggable,o,!0),N("dragOver"),Kt.eventCanceled)return m;if(at.contains(t.target)||s.animated&&s.animatingX&&s.animatingY||f._ignoreWhileAnimating===s)return O(!1);if(Nt=!1,u&&!l.disabled&&(h?d||(i=!ct.contains(at)):yt===this||(this.lastPutMode=xt.checkPull(this,u,at,t))&&c.checkPut(this,u,at,t))){if(r="vertical"===this._getDirection(t,s),e=k(at),N("dragOverValid"),Kt.eventCanceled)return m;if(i)return st=ct,D(),this._hideClone(),N("revert"),Kt.eventCanceled||(ut?ct.insertBefore(at,ut):ct.appendChild(at)),O(!0);var g=F(o,l.draggable);if(!g||ie(t,r,this)&&!g.animated){if(g===at)return O(!1);if(g&&o===t.target&&(s=g),s&&(n=k(s)),!1!==te(ct,o,at,e,s,n,t,!!s))return D(),o.appendChild(at),st=o,z(),O(!0)}else if(s.parentNode===o){n=k(s);var v,x,y=0,_=at.parentNode!==o,b=!jt(at.animated&&at.toRect||e,s.animated&&s.toRect||n,r),w=r?"top":"left",M=I(s,"top","top")||I(at,"top","top"),S=M?M.scrollTop:void 0;if(Ct!==s&&(v=n[w],kt=!1,It=!b&&l.invertSwap||_),y=re(t,s,n,r,b?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,It,Ct===s),0!==y){var T=U(at);do{T-=y,x=st.children[T]}while(x&&("none"===R(x,"display")||x===lt))}if(0===y||x===s)return O(!1);Ct=s,At=y;var C=s.nextElementSibling,A=!1;A=1===y;var P=te(ct,o,at,e,s,n,t,A);if(!1!==P)return 1!==P&&-1!==P||(A=1===P),Ft=!0,setTimeout(ne,30),D(),A&&!C?o.appendChild(at):s.parentNode.insertBefore(at,A?C:s),M&&q(M,0,S-M.scrollTop),st=at.parentNode,void 0===v||It||(Lt=Math.abs(v-k(s)[w])),z(),O(!0)}if(o.contains(at))return O(!1)}return!1}function N(l,c){rt(l,f,a({evt:t,isOwner:h,axis:r?"vertical":"horizontal",revert:i,dragRect:e,targetRect:n,canSort:d,fromSortable:p,target:s,completed:O,onMove:function(n,i){return te(ct,o,at,e,n,k(n),t,i)},changed:z},c))}function D(){N("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function O(e){return N("dragOverCompleted",{insertion:e}),e&&(h?u._hideClone():u._showClone(f),f!==p&&(L(at,yt?yt.options.ghostClass:u.options.ghostClass,!1),L(at,l.ghostClass,!0)),yt!==f&&f!==Kt.active?yt=f:f===Kt.active&&yt&&(yt=null),p===f&&(f._ignoreWhileAnimating=s),f.animateAll((function(){N("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(s===at&&!at.animated||s===o&&!s.animated)&&(Ct=null),l.dragoverBubble||t.rootEl||s===document||(at.parentNode[Z]._isOutsideThisEl(t.target),!e&&Zt(t)),!l.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),m=!0}function z(){mt=U(at),vt=U(at,l.draggable),ot({sortable:f,name:"change",toEl:o,newIndex:mt,newDraggableIndex:vt,originalEvent:t})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){M(document,"mousemove",this._onTouchMove),M(document,"touchmove",this._onTouchMove),M(document,"pointermove",this._onTouchMove),M(document,"dragover",Zt),M(document,"mousemove",Zt),M(document,"touchmove",Zt)},_offUpEvents:function(){var t=this.el.ownerDocument;M(t,"mouseup",this._onDrop),M(t,"touchend",this._onDrop),M(t,"pointerup",this._onDrop),M(t,"touchcancel",this._onDrop),M(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;mt=U(at),vt=U(at,n.draggable),rt("drop",this,{evt:t}),st=at&&at.parentNode,mt=U(at),vt=U(at,n.draggable),Kt.eventCanceled||(Pt=!1,It=!1,kt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ce(this.cloneId),ce(this._dragStartId),this.nativeDraggable&&(M(document,"drop",this),M(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),x&&R(document.body,"user-select",""),R(at,"transform",""),t&&(Et&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),lt&&lt.parentNode&&lt.parentNode.removeChild(lt),(ct===st||yt&&"clone"!==yt.lastPutMode)&&dt&&dt.parentNode&&dt.parentNode.removeChild(dt),at&&(this.nativeDraggable&&M(at,"dragend",this),ee(at),at.style["will-change"]="",Et&&!Pt&&L(at,yt?yt.options.ghostClass:this.options.ghostClass,!1),L(at,this.options.chosenClass,!1),ot({sortable:this,name:"unchoose",toEl:st,newIndex:null,newDraggableIndex:null,originalEvent:t}),ct!==st?(mt>=0&&(ot({rootEl:st,name:"add",toEl:st,fromEl:ct,originalEvent:t}),ot({sortable:this,name:"remove",toEl:st,originalEvent:t}),ot({rootEl:st,name:"sort",toEl:st,fromEl:ct,originalEvent:t}),ot({sortable:this,name:"sort",toEl:st,originalEvent:t})),yt&&yt.save()):mt!==ft&&mt>=0&&(ot({sortable:this,name:"update",toEl:st,originalEvent:t}),ot({sortable:this,name:"sort",toEl:st,originalEvent:t})),Kt.active&&(null!=mt&&-1!==mt||(mt=ft,vt=gt),ot({sortable:this,name:"end",toEl:st,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){rt("nulling",this),ct=at=st=lt=ut=dt=ht=pt=_t=bt=Et=mt=vt=ft=gt=Ct=At=yt=xt=Kt.dragged=Kt.ghost=Kt.clone=Kt.active=null,Ut.forEach((function(t){t.checked=!0})),Ut.length=wt=Mt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":at&&(this._onDragOver(t),Qt(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t,e=[],n=this.el.children,i=0,r=n.length,o=this.options;i<r;i++)t=n[i],E(t,o.draggable,this.el,!1)&&e.push(t.getAttribute(o.dataIdAttr)||ae(t));return e},sort:function(t){var e={},n=this.el;this.toArray().forEach((function(t,i){var r=n.children[i];E(r,this.options.draggable,n,!1)&&(e[t]=r)}),this),t.forEach((function(t){e[t]&&(n.removeChild(e[t]),n.appendChild(e[t]))}))},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return E(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];var i=nt.modifyOption(this,t,e);n[t]="undefined"!==typeof i?i:e,"group"===t&&Xt(n)},destroy:function(){rt("destroy",this);var t=this.el;t[Z]=null,M(t,"mousedown",this._onTapStart),M(t,"touchstart",this._onTapStart),M(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(M(t,"dragover",this),M(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Dt.splice(Dt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!pt){if(rt("hideClone",this),Kt.eventCanceled)return;R(dt,"display","none"),this.options.removeCloneOnHide&&dt.parentNode&&dt.parentNode.removeChild(dt),pt=!0}},_showClone:function(t){if("clone"===t.lastPutMode){if(pt){if(rt("showClone",this),Kt.eventCanceled)return;ct.contains(at)&&!this.options.group.revertClone?ct.insertBefore(dt,at):ut?ct.insertBefore(dt,ut):ct.appendChild(dt),this.options.group.revertClone&&this.animate(at,dt),R(dt,"display",""),pt=!1}}else this._hideClone()}},zt&&w(document,"touchmove",(function(t){(Kt.active||Pt)&&t.cancelable&&t.preventDefault()})),Kt.utils={on:w,off:M,css:R,find:N,is:function(t,e){return!!E(t,e,t,!1)},extend:V,throttle:W,closest:E,toggleClass:L,clone:X,index:U,nextTick:le,cancelNextTick:ce,detectDirection:Wt,getChild:O},Kt.get=function(t){return t[Z]},Kt.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach((function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(Kt.utils=a({},Kt.utils,t.utils)),nt.mount(t)}))},Kt.create=function(t,e){return new Kt(t,e)},Kt.version=p;var ue,he,de,pe,fe,me,ge=[],ve=!1;function xe(){function t(){for(var t in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"===typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){var e=t.originalEvent;this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):this.options.supportPointer?w(document,"pointermove",this._handleFallbackAutoScroll):e.touches?w(document,"touchmove",this._handleFallbackAutoScroll):w(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var e=t.originalEvent;this.options.dragOverBubble||e.rootEl||this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?M(document,"dragover",this._handleAutoScroll):(M(document,"pointermove",this._handleFallbackAutoScroll),M(document,"touchmove",this._handleFallbackAutoScroll),M(document,"mousemove",this._handleFallbackAutoScroll)),_e(),ye(),j()},nulling:function(){fe=he=ue=ve=me=de=pe=null,ge.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var n=this,i=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,o=document.elementFromPoint(i,r);if(fe=t,e||g||m||x){we(t,this.options,o,e);var a=B(o,!0);!ve||me&&i===de&&r===pe||(me&&_e(),me=setInterval((function(){var o=B(document.elementFromPoint(i,r),!0);o!==a&&(a=o,ye()),we(t,n.options,o,e)}),10),de=i,pe=r)}else{if(!this.options.bubbleScroll||B(o,!0)===D())return void ye();we(t,this.options,B(o,!1),!1)}}},o(t,{pluginName:"scroll",initializeByDefault:!0})}function ye(){ge.forEach((function(t){clearInterval(t.pid)})),ge=[]}function _e(){clearInterval(me)}var be,we=W((function(t,e,n,i){if(e.scroll){var r,o=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,s=e.scrollSensitivity,l=e.scrollSpeed,c=D(),u=!1;he!==n&&(he=n,ye(),ue=e.scroll,r=e.scrollFn,!0===ue&&(ue=B(n,!0)));var h=0,d=ue;do{var p=d,f=k(p),m=f.top,g=f.bottom,v=f.left,x=f.right,y=f.width,_=f.height,b=void 0,w=void 0,M=p.scrollWidth,S=p.scrollHeight,T=R(p),E=p.scrollLeft,C=p.scrollTop;p===c?(b=y<M&&("auto"===T.overflowX||"scroll"===T.overflowX||"visible"===T.overflowX),w=_<S&&("auto"===T.overflowY||"scroll"===T.overflowY||"visible"===T.overflowY)):(b=y<M&&("auto"===T.overflowX||"scroll"===T.overflowX),w=_<S&&("auto"===T.overflowY||"scroll"===T.overflowY));var A=b&&(Math.abs(x-o)<=s&&E+y<M)-(Math.abs(v-o)<=s&&!!E),L=w&&(Math.abs(g-a)<=s&&C+_<S)-(Math.abs(m-a)<=s&&!!C);if(!ge[h])for(var P=0;P<=h;P++)ge[P]||(ge[P]={});ge[h].vx==A&&ge[h].vy==L&&ge[h].el===p||(ge[h].el=p,ge[h].vx=A,ge[h].vy=L,clearInterval(ge[h].pid),0==A&&0==L||(u=!0,ge[h].pid=setInterval(function(){i&&0===this.layer&&Kt.active._onTouchMove(fe);var e=ge[this.layer].vy?ge[this.layer].vy*l:0,n=ge[this.layer].vx?ge[this.layer].vx*l:0;"function"===typeof r&&"continue"!==r.call(Kt.dragged.parentNode[Z],n,e,t,fe,ge[this.layer].el)||q(ge[this.layer].el,n,e)}.bind({layer:h}),24))),h++}while(e.bubbleScroll&&d!==c&&(d=B(d,!1)));ve=u}}),30),Me=function(t){var e=t.originalEvent,n=t.putSortable,i=t.dragEl,r=t.activeSortable,o=t.dispatchSortableEvent,a=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(e){var l=n||r;a();var c=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,u=document.elementFromPoint(c.clientX,c.clientY);s(),l&&!l.el.contains(u)&&(o("spill"),this.onSpill({dragEl:i,putSortable:n}))}};function Se(){}function Te(){}function Ee(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(t){var e=t.dragEl;be=e},dragOverValid:function(t){var e=t.completed,n=t.target,i=t.onMove,r=t.activeSortable,o=t.changed,a=t.cancel;if(r.options.swap){var s=this.sortable.el,l=this.options;if(n&&n!==s){var c=be;!1!==i(n)?(L(n,l.swapClass,!0),be=n):be=null,c&&c!==be&&L(c,l.swapClass,!1)}o(),e(!0),a()}},drop:function(t){var e=t.activeSortable,n=t.putSortable,i=t.dragEl,r=n||this.sortable,o=this.options;be&&L(be,o.swapClass,!1),be&&(o.swap||n&&n.options.swap)&&i!==be&&(r.captureAnimationState(),r!==e&&e.captureAnimationState(),Ce(i,be),r.animateAll(),r!==e&&e.animateAll())},nulling:function(){be=null}},o(t,{pluginName:"swap",eventProperties:function(){return{swapItem:be}}})}function Ce(t,e){var n,i,r=t.parentNode,o=e.parentNode;r&&o&&!r.isEqualNode(e)&&!o.isEqualNode(t)&&(n=U(t),i=U(e),r.isEqualNode(o)&&n<i&&i++,r.insertBefore(e,r.children[n]),o.insertBefore(t,o.children[i]))}Se.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=O(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(e,i):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:Me},o(Se,{pluginName:"revertOnSpill"}),Te.prototype={onSpill:function(t){var e=t.dragEl,n=t.putSortable,i=n||this.sortable;i.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),i.animateAll()},drop:Me},o(Te,{pluginName:"removeOnSpill"});var Ae,Le,Re,Pe,Ne,De=[],ke=[],Ie=!1,Oe=!1,Fe=!1;function Ue(){function t(t){for(var e in this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this));t.options.supportPointer?w(document,"pointerup",this._deselectMultiDrag):(w(document,"mouseup",this._deselectMultiDrag),w(document,"touchend",this._deselectMultiDrag)),w(document,"keydown",this._checkKeyDown),w(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(e,n){var i="";De.length&&Le===t?De.forEach((function(t,e){i+=(e?", ":"")+t.textContent})):i=n.textContent,e.setData("Text",i)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(t){var e=t.dragEl;Re=e},delayEnded:function(){this.isMultiDrag=~De.indexOf(Re)},setupClone:function(t){var e=t.sortable,n=t.cancel;if(this.isMultiDrag){for(var i=0;i<De.length;i++)ke.push(X(De[i])),ke[i].sortableIndex=De[i].sortableIndex,ke[i].draggable=!1,ke[i].style["will-change"]="",L(ke[i],this.options.selectedClass,!1),De[i]===Re&&L(ke[i],this.options.chosenClass,!1);e._hideClone(),n()}},clone:function(t){var e=t.sortable,n=t.rootEl,i=t.dispatchSortableEvent,r=t.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||De.length&&Le===e&&(He(!0,n),i("clone"),r()))},showClone:function(t){var e=t.cloneNowShown,n=t.rootEl,i=t.cancel;this.isMultiDrag&&(He(!1,n),ke.forEach((function(t){R(t,"display","")})),e(),Ne=!1,i())},hideClone:function(t){var e=this,n=(t.sortable,t.cloneNowHidden),i=t.cancel;this.isMultiDrag&&(ke.forEach((function(t){R(t,"display","none"),e.options.removeCloneOnHide&&t.parentNode&&t.parentNode.removeChild(t)})),n(),Ne=!0,i())},dragStartGlobal:function(t){t.sortable;!this.isMultiDrag&&Le&&Le.multiDrag._deselectMultiDrag(),De.forEach((function(t){t.sortableIndex=U(t)})),De=De.sort((function(t,e){return t.sortableIndex-e.sortableIndex})),Fe=!0},dragStarted:function(t){var e=this,n=t.sortable;if(this.isMultiDrag){if(this.options.sort&&(n.captureAnimationState(),this.options.animation)){De.forEach((function(t){t!==Re&&R(t,"position","absolute")}));var i=k(Re,!1,!0,!0);De.forEach((function(t){t!==Re&&Y(t,i)})),Oe=!0,Ie=!0}n.animateAll((function(){Oe=!1,Ie=!1,e.options.animation&&De.forEach((function(t){$(t)})),e.options.sort&&Be()}))}},dragOver:function(t){var e=t.target,n=t.completed,i=t.cancel;Oe&&~De.indexOf(e)&&(n(!1),i())},revert:function(t){var e=t.fromSortable,n=t.rootEl,i=t.sortable,r=t.dragRect;De.length>1&&(De.forEach((function(t){i.addAnimationState({target:t,rect:Oe?k(t):r}),$(t),t.fromRect=r,e.removeAnimationState(t)})),Oe=!1,ze(!this.options.removeCloneOnHide,n))},dragOverCompleted:function(t){var e=t.sortable,n=t.isOwner,i=t.insertion,r=t.activeSortable,o=t.parentEl,a=t.putSortable,s=this.options;if(i){if(n&&r._hideClone(),Ie=!1,s.animation&&De.length>1&&(Oe||!n&&!r.options.sort&&!a)){var l=k(Re,!1,!0,!0);De.forEach((function(t){t!==Re&&(Y(t,l),o.appendChild(t))})),Oe=!0}if(!n)if(Oe||Be(),De.length>1){var c=Ne;r._showClone(e),r.options.animation&&!Ne&&c&&ke.forEach((function(t){r.addAnimationState({target:t,rect:Pe}),t.fromRect=Pe,t.thisAnimationDuration=null}))}else r._showClone(e)}},dragOverAnimationCapture:function(t){var e=t.dragRect,n=t.isOwner,i=t.activeSortable;if(De.forEach((function(t){t.thisAnimationDuration=null})),i.options.animation&&!n&&i.multiDrag.isMultiDrag){Pe=o({},e);var r=P(Re,!0);Pe.top-=r.f,Pe.left-=r.e}},dragOverAnimationComplete:function(){Oe&&(Oe=!1,Be())},drop:function(t){var e=t.originalEvent,n=t.rootEl,i=t.parentEl,r=t.sortable,o=t.dispatchSortableEvent,a=t.oldIndex,s=t.putSortable,l=s||this.sortable;if(e){var c=this.options,u=i.children;if(!Fe)if(c.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),L(Re,c.selectedClass,!~De.indexOf(Re)),~De.indexOf(Re))De.splice(De.indexOf(Re),1),Ae=null,it({sortable:r,rootEl:n,name:"deselect",targetEl:Re,originalEvt:e});else{if(De.push(Re),it({sortable:r,rootEl:n,name:"select",targetEl:Re,originalEvt:e}),e.shiftKey&&Ae&&r.el.contains(Ae)){var h,d,p=U(Ae),f=U(Re);if(~p&&~f&&p!==f)for(f>p?(d=p,h=f):(d=f,h=p+1);d<h;d++)~De.indexOf(u[d])||(L(u[d],c.selectedClass,!0),De.push(u[d]),it({sortable:r,rootEl:n,name:"select",targetEl:u[d],originalEvt:e}))}else Ae=Re;Le=l}if(Fe&&this.isMultiDrag){if((i[Z].options.sort||i!==n)&&De.length>1){var m=k(Re),g=U(Re,":not(."+this.options.selectedClass+")");if(!Ie&&c.animation&&(Re.thisAnimationDuration=null),l.captureAnimationState(),!Ie&&(c.animation&&(Re.fromRect=m,De.forEach((function(t){if(t.thisAnimationDuration=null,t!==Re){var e=Oe?k(t):m;t.fromRect=e,l.addAnimationState({target:t,rect:e})}}))),Be(),De.forEach((function(t){u[g]?i.insertBefore(t,u[g]):i.appendChild(t),g++})),a===U(Re))){var v=!1;De.forEach((function(t){t.sortableIndex===U(t)||(v=!0)})),v&&o("update")}De.forEach((function(t){$(t)})),l.animateAll()}Le=l}(n===i||s&&"clone"!==s.lastPutMode)&&ke.forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)}))}},nullingGlobal:function(){this.isMultiDrag=Fe=!1,ke.length=0},destroyGlobal:function(){this._deselectMultiDrag(),M(document,"pointerup",this._deselectMultiDrag),M(document,"mouseup",this._deselectMultiDrag),M(document,"touchend",this._deselectMultiDrag),M(document,"keydown",this._checkKeyDown),M(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(t){if(("undefined"===typeof Fe||!Fe)&&Le===this.sortable&&(!t||!E(t.target,this.options.draggable,this.sortable.el,!1))&&(!t||0===t.button))while(De.length){var e=De[0];L(e,this.options.selectedClass,!1),De.shift(),it({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:e,originalEvt:t})}},_checkKeyDown:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},o(t,{pluginName:"multiDrag",utils:{select:function(t){var e=t.parentNode[Z];e&&e.options.multiDrag&&!~De.indexOf(t)&&(Le&&Le!==e&&(Le.multiDrag._deselectMultiDrag(),Le=e),L(t,e.options.selectedClass,!0),De.push(t))},deselect:function(t){var e=t.parentNode[Z],n=De.indexOf(t);e&&e.options.multiDrag&&~n&&(L(t,e.options.selectedClass,!1),De.splice(n,1))}},eventProperties:function(){var t=this,e=[],n=[];return De.forEach((function(i){var r;e.push({multiDragElement:i,index:i.sortableIndex}),r=Oe&&i!==Re?-1:Oe?U(i,":not(."+t.options.selectedClass+")"):U(i),n.push({multiDragElement:i,index:r})})),{items:c(De),clones:[].concat(ke),oldIndicies:e,newIndicies:n}},optionListeners:{multiDragKey:function(t){return t=t.toLowerCase(),"ctrl"===t?t="Control":t.length>1&&(t=t.charAt(0).toUpperCase()+t.substr(1)),t}}})}function ze(t,e){De.forEach((function(n,i){var r=e.children[n.sortableIndex+(t?Number(i):0)];r?e.insertBefore(n,r):e.appendChild(n)}))}function He(t,e){ke.forEach((function(n,i){var r=e.children[n.sortableIndex+(t?Number(i):0)];r?e.insertBefore(n,r):e.appendChild(n)}))}function Be(){De.forEach((function(t){t!==Re&&t.parentNode&&t.parentNode.removeChild(t)}))}Kt.mount(new xe),Kt.mount(Te,Se),e["default"]=Kt},b174:function(t,e,n){t.exports=n.p+"img/account-c.5350679d.svg"},b2af:function(t,e,n){t.exports=n.p+"img/user-log.bb538035.svg"},b327:function(t,e,n){t.exports=n.p+"img/text+video-alt.e40e5e14.svg"},b3ba:function(t,e,n){t.exports=n.p+"img/call-bg.54e323dd.svg"},b53b:function(t,e,n){t.exports=n.p+"img/image-alt.12d79b55.svg"},b5ee:function(t,e,n){t.exports=n.p+"img/video.30071a07.svg"},b65f:function(t,e,n){var i=n("23e7"),r=Math.ceil,o=Math.floor;i({target:"Math",stat:!0},{trunc:function(t){return(t>0?o:r)(t)}})},b76a:function(t,e,n){(function(e,i){t.exports=i(n("aa47"))})("undefined"!==typeof self&&self,(function(t){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"01f9":function(t,e,n){"use strict";var i=n("2d00"),r=n("5ca1"),o=n("2aba"),a=n("32e9"),s=n("84f2"),l=n("41a0"),c=n("7f20"),u=n("38fd"),h=n("2b4c")("iterator"),d=!([].keys&&"next"in[].keys()),p="@@iterator",f="keys",m="values",g=function(){return this};t.exports=function(t,e,n,v,x,y,_){l(n,e,v);var b,w,M,S=function(t){if(!d&&t in A)return A[t];switch(t){case f:return function(){return new n(this,t)};case m:return function(){return new n(this,t)}}return function(){return new n(this,t)}},T=e+" Iterator",E=x==m,C=!1,A=t.prototype,L=A[h]||A[p]||x&&A[x],R=L||S(x),P=x?E?S("entries"):R:void 0,N="Array"==e&&A.entries||L;if(N&&(M=u(N.call(new t)),M!==Object.prototype&&M.next&&(c(M,T,!0),i||"function"==typeof M[h]||a(M,h,g))),E&&L&&L.name!==m&&(C=!0,R=function(){return L.call(this)}),i&&!_||!d&&!C&&A[h]||a(A,h,R),s[e]=R,s[T]=g,x)if(b={values:E?R:S(m),keys:y?R:S(f),entries:P},_)for(w in b)w in A||o(A,w,b[w]);else r(r.P+r.F*(d||C),e,b);return b}},"02f4":function(t,e,n){var i=n("4588"),r=n("be13");t.exports=function(t){return function(e,n){var o,a,s=String(r(e)),l=i(n),c=s.length;return l<0||l>=c?t?"":void 0:(o=s.charCodeAt(l),o<55296||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):o:t?s.slice(l,l+2):a-56320+(o-55296<<10)+65536)}}},"0390":function(t,e,n){"use strict";var i=n("02f4")(!0);t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},"0bfb":function(t,e,n){"use strict";var i=n("cb7c");t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"0d58":function(t,e,n){var i=n("ce10"),r=n("e11e");t.exports=Object.keys||function(t){return i(t,r)}},1495:function(t,e,n){var i=n("86cc"),r=n("cb7c"),o=n("0d58");t.exports=n("9e1e")?Object.defineProperties:function(t,e){r(t);var n,a=o(e),s=a.length,l=0;while(s>l)i.f(t,n=a[l++],e[n]);return t}},"214f":function(t,e,n){"use strict";n("b0c5");var i=n("2aba"),r=n("32e9"),o=n("79e5"),a=n("be13"),s=n("2b4c"),l=n("520a"),c=s("species"),u=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),h=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var d=s(t),p=!o((function(){var e={};return e[d]=function(){return 7},7!=""[t](e)})),f=p?!o((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[d](""),!e})):void 0;if(!p||!f||"replace"===t&&!u||"split"===t&&!h){var m=/./[d],g=n(a,d,""[t],(function(t,e,n,i,r){return e.exec===l?p&&!r?{done:!0,value:m.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}})),v=g[0],x=g[1];i(String.prototype,t,v),r(RegExp.prototype,d,2==e?function(t,e){return x.call(t,this,e)}:function(t){return x.call(t,this)})}}},"230e":function(t,e,n){var i=n("d3f4"),r=n("7726").document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},"23c6":function(t,e,n){var i=n("2d95"),r=n("2b4c")("toStringTag"),o="Arguments"==i(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),r))?n:o?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},2621:function(t,e){e.f=Object.getOwnPropertySymbols},"2aba":function(t,e,n){var i=n("7726"),r=n("32e9"),o=n("69a8"),a=n("ca5a")("src"),s=n("fa5b"),l="toString",c=(""+s).split(l);n("8378").inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var l="function"==typeof n;l&&(o(n,"name")||r(n,"name",e)),t[e]!==n&&(l&&(o(n,a)||r(n,a,t[e]?""+t[e]:c.join(String(e)))),t===i?t[e]=n:s?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,l,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},"2aeb":function(t,e,n){var i=n("cb7c"),r=n("1495"),o=n("e11e"),a=n("613b")("IE_PROTO"),s=function(){},l="prototype",c=function(){var t,e=n("230e")("iframe"),i=o.length,r="<",a=">";e.style.display="none",n("fab2").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(r+"script"+a+"document.F=Object"+r+"/script"+a),t.close(),c=t.F;while(i--)delete c[l][o[i]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(s[l]=i(t),n=new s,s[l]=null,n[a]=t):n=c(),void 0===e?n:r(n,e)}},"2b4c":function(t,e,n){var i=n("5537")("wks"),r=n("ca5a"),o=n("7726").Symbol,a="function"==typeof o,s=t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))};s.store=i},"2d00":function(t,e){t.exports=!1},"2d95":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"2fdb":function(t,e,n){"use strict";var i=n("5ca1"),r=n("d2c8"),o="includes";i(i.P+i.F*n("5147")(o),"String",{includes:function(t){return!!~r(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},"32e9":function(t,e,n){var i=n("86cc"),r=n("4630");t.exports=n("9e1e")?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},"38fd":function(t,e,n){var i=n("69a8"),r=n("4bf8"),o=n("613b")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},"41a0":function(t,e,n){"use strict";var i=n("2aeb"),r=n("4630"),o=n("7f20"),a={};n("32e9")(a,n("2b4c")("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}},"456d":function(t,e,n){var i=n("4bf8"),r=n("0d58");n("5eda")("keys",(function(){return function(t){return r(i(t))}}))},4588:function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"4bf8":function(t,e,n){var i=n("be13");t.exports=function(t){return Object(i(t))}},5147:function(t,e,n){var i=n("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(r){}}return!0}},"520a":function(t,e,n){"use strict";var i=n("0bfb"),r=RegExp.prototype.exec,o=String.prototype.replace,a=r,s="lastIndex",l=function(){var t=/a/,e=/b*/g;return r.call(t,"a"),r.call(e,"a"),0!==t[s]||0!==e[s]}(),c=void 0!==/()??/.exec("")[1],u=l||c;u&&(a=function(t){var e,n,a,u,h=this;return c&&(n=new RegExp("^"+h.source+"$(?!\\s)",i.call(h))),l&&(e=h[s]),a=r.call(h,t),l&&a&&(h[s]=h.global?a.index+a[0].length:e),c&&a&&a.length>1&&o.call(a[0],n,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(a[u]=void 0)})),a}),t.exports=a},"52a7":function(t,e){e.f={}.propertyIsEnumerable},5537:function(t,e,n){var i=n("8378"),r=n("7726"),o="__core-js_shared__",a=r[o]||(r[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},"5ca1":function(t,e,n){var i=n("7726"),r=n("8378"),o=n("32e9"),a=n("2aba"),s=n("9b43"),l="prototype",c=function(t,e,n){var u,h,d,p,f=t&c.F,m=t&c.G,g=t&c.S,v=t&c.P,x=t&c.B,y=m?i:g?i[e]||(i[e]={}):(i[e]||{})[l],_=m?r:r[e]||(r[e]={}),b=_[l]||(_[l]={});for(u in m&&(n=e),n)h=!f&&y&&void 0!==y[u],d=(h?y:n)[u],p=x&&h?s(d,i):v&&"function"==typeof d?s(Function.call,d):d,y&&a(y,u,d,t&c.U),_[u]!=d&&o(_,u,p),v&&b[u]!=d&&(b[u]=d)};i.core=r,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},"5eda":function(t,e,n){var i=n("5ca1"),r=n("8378"),o=n("79e5");t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*o((function(){n(1)})),"Object",a)}},"5f1b":function(t,e,n){"use strict";var i=n("23c6"),r=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var o=n.call(t,e);if("object"!==typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},"613b":function(t,e,n){var i=n("5537")("keys"),r=n("ca5a");t.exports=function(t){return i[t]||(i[t]=r(t))}},"626a":function(t,e,n){var i=n("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},6762:function(t,e,n){"use strict";var i=n("5ca1"),r=n("c366")(!0);i(i.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},6821:function(t,e,n){var i=n("626a"),r=n("be13");t.exports=function(t){return i(r(t))}},"69a8":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"6a99":function(t,e,n){var i=n("d3f4");t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},7333:function(t,e,n){"use strict";var i=n("0d58"),r=n("2621"),o=n("52a7"),a=n("4bf8"),s=n("626a"),l=Object.assign;t.exports=!l||n("79e5")((function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach((function(t){e[t]=t})),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=i}))?function(t,e){var n=a(t),l=arguments.length,c=1,u=r.f,h=o.f;while(l>c){var d,p=s(arguments[c++]),f=u?i(p).concat(u(p)):i(p),m=f.length,g=0;while(m>g)h.call(p,d=f[g++])&&(n[d]=p[d])}return n}:l},7726:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"77f1":function(t,e,n){var i=n("4588"),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},"7f20":function(t,e,n){var i=n("86cc").f,r=n("69a8"),o=n("2b4c")("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},8378:function(t,e){var n=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},"84f2":function(t,e){t.exports={}},"86cc":function(t,e,n){var i=n("cb7c"),r=n("c69a"),o=n("6a99"),a=Object.defineProperty;e.f=n("9e1e")?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(s){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},"9b43":function(t,e,n){var i=n("d8e8");t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},"9c6c":function(t,e,n){var i=n("2b4c")("unscopables"),r=Array.prototype;void 0==r[i]&&n("32e9")(r,i,{}),t.exports=function(t){r[i][t]=!0}},"9def":function(t,e,n){var i=n("4588"),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},"9e1e":function(t,e,n){t.exports=!n("79e5")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},a352:function(e,n){e.exports=t},a481:function(t,e,n){"use strict";var i=n("cb7c"),r=n("4bf8"),o=n("9def"),a=n("4588"),s=n("0390"),l=n("5f1b"),c=Math.max,u=Math.min,h=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,f=function(t){return void 0===t?t:String(t)};n("214f")("replace",2,(function(t,e,n,m){return[function(i,r){var o=t(this),a=void 0==i?void 0:i[e];return void 0!==a?a.call(i,o,r):n.call(String(o),i,r)},function(t,e){var r=m(n,t,this,e);if(r.done)return r.value;var h=i(t),d=String(this),p="function"===typeof e;p||(e=String(e));var v=h.global;if(v){var x=h.unicode;h.lastIndex=0}var y=[];while(1){var _=l(h,d);if(null===_)break;if(y.push(_),!v)break;var b=String(_[0]);""===b&&(h.lastIndex=s(d,o(h.lastIndex),x))}for(var w="",M=0,S=0;S<y.length;S++){_=y[S];for(var T=String(_[0]),E=c(u(a(_.index),d.length),0),C=[],A=1;A<_.length;A++)C.push(f(_[A]));var L=_.groups;if(p){var R=[T].concat(C,E,d);void 0!==L&&R.push(L);var P=String(e.apply(void 0,R))}else P=g(T,d,E,C,L,e);E>=M&&(w+=d.slice(M,E)+P,M=E+T.length)}return w+d.slice(M)}];function g(t,e,i,o,a,s){var l=i+t.length,c=o.length,u=p;return void 0!==a&&(a=r(a),u=d),n.call(s,u,(function(n,r){var s;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,i);case"'":return e.slice(l);case"<":s=a[r.slice(1,-1)];break;default:var u=+r;if(0===u)return n;if(u>c){var d=h(u/10);return 0===d?n:d<=c?void 0===o[d-1]?r.charAt(1):o[d-1]+r.charAt(1):n}s=o[u-1]}return void 0===s?"":s}))}}))},aae3:function(t,e,n){var i=n("d3f4"),r=n("2d95"),o=n("2b4c")("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},ac6a:function(t,e,n){for(var i=n("cadf"),r=n("0d58"),o=n("2aba"),a=n("7726"),s=n("32e9"),l=n("84f2"),c=n("2b4c"),u=c("iterator"),h=c("toStringTag"),d=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=r(p),m=0;m<f.length;m++){var g,v=f[m],x=p[v],y=a[v],_=y&&y.prototype;if(_&&(_[u]||s(_,u,d),_[h]||s(_,h,v),l[v]=d,x))for(g in i)_[g]||o(_,g,i[g],!0)}},b0c5:function(t,e,n){"use strict";var i=n("520a");n("5ca1")({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},c366:function(t,e,n){var i=n("6821"),r=n("9def"),o=n("77f1");t.exports=function(t){return function(e,n,a){var s,l=i(e),c=r(l.length),u=o(a,c);if(t&&n!=n){while(c>u)if(s=l[u++],s!=s)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===n)return t||u||0;return!t&&-1}}},c649:function(t,e,n){"use strict";(function(t){n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return l}));n("a481");function i(){return"undefined"!==typeof window?window.console:t.console}var r=i();function o(t){var e=Object.create(null);return function(n){var i=e[n];return i||(e[n]=t(n))}}var a=/-(\w)/g,s=o((function(t){return t.replace(a,(function(t,e){return e?e.toUpperCase():""}))}));function l(t){null!==t.parentElement&&t.parentElement.removeChild(t)}function c(t,e,n){var i=0===n?t.children[0]:t.children[n-1].nextSibling;t.insertBefore(e,i)}}).call(this,n("c8ba"))},c69a:function(t,e,n){t.exports=!n("9e1e")&&!n("79e5")((function(){return 7!=Object.defineProperty(n("230e")("div"),"a",{get:function(){return 7}}).a}))},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(i){"object"===typeof window&&(n=window)}t.exports=n},ca5a:function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},cadf:function(t,e,n){"use strict";var i=n("9c6c"),r=n("d53b"),o=n("84f2"),a=n("6821");t.exports=n("01f9")(Array,"Array",(function(t,e){this._t=a(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},cb7c:function(t,e,n){var i=n("d3f4");t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},ce10:function(t,e,n){var i=n("69a8"),r=n("6821"),o=n("c366")(!1),a=n("613b")("IE_PROTO");t.exports=function(t,e){var n,s=r(t),l=0,c=[];for(n in s)n!=a&&i(s,n)&&c.push(n);while(e.length>l)i(s,n=e[l++])&&(~o(c,n)||c.push(n));return c}},d2c8:function(t,e,n){var i=n("aae3"),r=n("be13");t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},d3f4:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},d53b:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},e11e:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},f559:function(t,e,n){"use strict";var i=n("5ca1"),r=n("9def"),o=n("d2c8"),a="startsWith",s=""[a];i(i.P+i.F*n("5147")(a),"String",{startsWith:function(t){var e=o(this,t,a),n=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return s?s.call(e,i,n):e.slice(n,n+i.length)===i}})},f6fd:function(t,e){(function(t){var e="currentScript",n=t.getElementsByTagName("script");e in t||Object.defineProperty(t,e,{get:function(){try{throw new Error}catch(i){var t,e=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(i.stack)||[!1])[1];for(t in n)if(n[t].src==e||"interactive"==n[t].readyState)return n[t];return null}}})})(document)},f751:function(t,e,n){var i=n("5ca1");i(i.S+i.F,"Object",{assign:n("7333")})},fa5b:function(t,e,n){t.exports=n("5537")("native-function-to-string",Function.toString)},fab2:function(t,e,n){var i=n("7726").document;t.exports=i&&i.documentElement},fb15:function(t,e,n){"use strict";var i;(n.r(e),"undefined"!==typeof window)&&(n("f6fd"),(i=window.document.currentScript)&&(i=i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(n.p=i[1]));n("f751"),n("f559"),n("ac6a"),n("cadf"),n("456d");function r(t){if(Array.isArray(t))return t}function o(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0)if(n.push(a.value),e&&n.length===e)break}catch(l){r=!0,o=l}finally{try{i||null==s["return"]||s["return"]()}finally{if(r)throw o}}return n}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function s(t,e){if(t){if("string"===typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){return r(t)||o(t,e)||s(t,e)||l()}n("6762"),n("2fdb");function u(t){if(Array.isArray(t))return a(t)}function h(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(t){return u(t)||h(t)||s(t)||d()}var f=n("a352"),m=n.n(f),g=n("c649");function v(t,e,n){return void 0===n||(t=t||{},t[e]=n),t}function x(t,e){return t.map((function(t){return t.elm})).indexOf(e)}function y(t,e,n,i){if(!t)return[];var r=t.map((function(t){return t.elm})),o=e.length-i,a=p(e).map((function(t,e){return e>=o?r.length:r.indexOf(t)}));return n?a.filter((function(t){return-1!==t})):a}function _(t,e){var n=this;this.$nextTick((function(){return n.$emit(t.toLowerCase(),e)}))}function b(t){var e=this;return function(n){null!==e.realList&&e["onDrag"+t](n),_.call(e,t,n)}}function w(t){return["transition-group","TransitionGroup"].includes(t)}function M(t){if(!t||1!==t.length)return!1;var e=c(t,1),n=e[0].componentOptions;return!!n&&w(n.tag)}function S(t,e,n){return t[n]||(e[n]?e[n]():void 0)}function T(t,e,n){var i=0,r=0,o=S(e,n,"header");o&&(i=o.length,t=t?[].concat(p(o),p(t)):p(o));var a=S(e,n,"footer");return a&&(r=a.length,t=t?[].concat(p(t),p(a)):p(a)),{children:t,headerOffset:i,footerOffset:r}}function E(t,e){var n=null,i=function(t,e){n=v(n,t,e)},r=Object.keys(t).filter((function(t){return"id"===t||t.startsWith("data-")})).reduce((function(e,n){return e[n]=t[n],e}),{});if(i("attrs",r),!e)return n;var o=e.on,a=e.props,s=e.attrs;return i("on",o),i("props",a),Object.assign(n.attrs,s),n}var C=["Start","Add","Remove","Update","End"],A=["Choose","Unchoose","Sort","Filter","Clone"],L=["Move"].concat(C,A).map((function(t){return"on"+t})),R=null,P={options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:function(t){return t}},element:{type:String,default:"div"},tag:{type:String,default:null},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},N={name:"draggable",inheritAttrs:!1,props:P,data:function(){return{transitionMode:!1,noneFunctionalComponentMode:!1}},render:function(t){var e=this.$slots.default;this.transitionMode=M(e);var n=T(e,this.$slots,this.$scopedSlots),i=n.children,r=n.headerOffset,o=n.footerOffset;this.headerOffset=r,this.footerOffset=o;var a=E(this.$attrs,this.componentData);return t(this.getTag(),a,i)},created:function(){null!==this.list&&null!==this.value&&g["b"].error("Value and list props are mutually exclusive! Please set one or another."),"div"!==this.element&&g["b"].warn("Element props is deprecated please use tag props instead. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#element-props"),void 0!==this.options&&g["b"].warn("Options props is deprecated, add sortable options directly as vue.draggable item, or use v-bind. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#options-props")},mounted:function(){var t=this;if(this.noneFunctionalComponentMode=this.getTag().toLowerCase()!==this.$el.nodeName.toLowerCase()&&!this.getIsFunctional(),this.noneFunctionalComponentMode&&this.transitionMode)throw new Error("Transition-group inside component is not supported. Please alter tag value or remove transition-group. Current tag value: ".concat(this.getTag()));var e={};C.forEach((function(n){e["on"+n]=b.call(t,n)})),A.forEach((function(n){e["on"+n]=_.bind(t,n)}));var n=Object.keys(this.$attrs).reduce((function(e,n){return e[Object(g["a"])(n)]=t.$attrs[n],e}),{}),i=Object.assign({},this.options,n,e,{onMove:function(e,n){return t.onDragMove(e,n)}});!("draggable"in i)&&(i.draggable=">*"),this._sortable=new m.a(this.rootContainer,i),this.computeIndexes()},beforeDestroy:function(){void 0!==this._sortable&&this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},realList:function(){return this.list?this.list:this.value}},watch:{options:{handler:function(t){this.updateOptions(t)},deep:!0},$attrs:{handler:function(t){this.updateOptions(t)},deep:!0},realList:function(){this.computeIndexes()}},methods:{getIsFunctional:function(){var t=this._vnode.fnOptions;return t&&t.functional},getTag:function(){return this.tag||this.element},updateOptions:function(t){for(var e in t){var n=Object(g["a"])(e);-1===L.indexOf(n)&&this._sortable.option(n,t[e])}},getChildrenNodes:function(){if(this.noneFunctionalComponentMode)return this.$children[0].$slots.default;var t=this.$slots.default;return this.transitionMode?t[0].child.$slots.default:t},computeIndexes:function(){var t=this;this.$nextTick((function(){t.visibleIndexes=y(t.getChildrenNodes(),t.rootContainer.children,t.transitionMode,t.footerOffset)}))},getUnderlyingVm:function(t){var e=x(this.getChildrenNodes()||[],t);if(-1===e)return null;var n=this.realList[e];return{index:e,element:n}},getUnderlyingPotencialDraggableComponent:function(t){var e=t.__vue__;return e&&e.$options&&w(e.$options._componentTag)?e.$parent:!("realList"in e)&&1===e.$children.length&&"realList"in e.$children[0]?e.$children[0]:e},emitChanges:function(t){var e=this;this.$nextTick((function(){e.$emit("change",t)}))},alterList:function(t){if(this.list)t(this.list);else{var e=p(this.value);t(e),this.$emit("input",e)}},spliceList:function(){var t=arguments,e=function(e){return e.splice.apply(e,p(t))};this.alterList(e)},updatePosition:function(t,e){var n=function(n){return n.splice(e,0,n.splice(t,1)[0])};this.alterList(n)},getRelatedContextFromMoveEvent:function(t){var e=t.to,n=t.related,i=this.getUnderlyingPotencialDraggableComponent(e);if(!i)return{component:i};var r=i.realList,o={list:r,component:i};if(e!==n&&r&&i.getUnderlyingVm){var a=i.getUnderlyingVm(n);if(a)return Object.assign(a,o)}return o},getVmIndex:function(t){var e=this.visibleIndexes,n=e.length;return t>n-1?n:e[t]},getComponent:function(){return this.$slots.default[0].componentInstance},resetTransitionData:function(t){if(this.noTransitionOnDrag&&this.transitionMode){var e=this.getChildrenNodes();e[t].data=null;var n=this.getComponent();n.children=[],n.kept=void 0}},onDragStart:function(t){this.context=this.getUnderlyingVm(t.item),t.item._underlying_vm_=this.clone(this.context.element),R=t.item},onDragAdd:function(t){var e=t.item._underlying_vm_;if(void 0!==e){Object(g["d"])(t.item);var n=this.getVmIndex(t.newIndex);this.spliceList(n,0,e),this.computeIndexes();var i={element:e,newIndex:n};this.emitChanges({added:i})}},onDragRemove:function(t){if(Object(g["c"])(this.rootContainer,t.item,t.oldIndex),"clone"!==t.pullMode){var e=this.context.index;this.spliceList(e,1);var n={element:this.context.element,oldIndex:e};this.resetTransitionData(e),this.emitChanges({removed:n})}else Object(g["d"])(t.clone)},onDragUpdate:function(t){Object(g["d"])(t.item),Object(g["c"])(t.from,t.item,t.oldIndex);var e=this.context.index,n=this.getVmIndex(t.newIndex);this.updatePosition(e,n);var i={element:this.context.element,oldIndex:e,newIndex:n};this.emitChanges({moved:i})},updateProperty:function(t,e){t.hasOwnProperty(e)&&(t[e]+=this.headerOffset)},computeFutureIndex:function(t,e){if(!t.element)return 0;var n=p(e.to.children).filter((function(t){return"none"!==t.style["display"]})),i=n.indexOf(e.related),r=t.component.getVmIndex(i),o=-1!==n.indexOf(R);return o||!e.willInsertAfter?r:r+1},onDragMove:function(t,e){var n=this.move;if(!n||!this.realList)return!0;var i=this.getRelatedContextFromMoveEvent(t),r=this.context,o=this.computeFutureIndex(i,t);Object.assign(r,{futureIndex:o});var a=Object.assign({},t,{relatedContext:i,draggedContext:r});return n(a,e)},onDragEnd:function(){this.computeIndexes(),R=null}}};"undefined"!==typeof window&&"Vue"in window&&window.Vue.component("draggable",N);var D=N;e["default"]=D}})["default"]}))},c003:function(t,e,n){t.exports=n.p+"img/file_management_hover.e840f45c.svg"},c47f:function(t,e,n){t.exports=n.p+"img/fii-vision-logo.ec9f8f3c.svg"},c4c2:function(t,e,n){t.exports=n.p+"img/wg-logo.31c776cb.png"},c4d8:function(t,e,n){t.exports=n.p+"img/task-bg.58c6473b.svg"},c688:function(t,e,n){t.exports=n.p+"img/check-icon.84763275.svg"},c740:function(t,e,n){"use strict";var i=n("23e7"),r=n("b727").findIndex,o=n("44d2"),a="findIndex",s=!0;a in[]&&Array(1)[a]((function(){s=!1})),i({target:"Array",proto:!0,forced:s},{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),o(a)},c792:function(t,e,n){t.exports=n.p+"img/maintenance-hover.6a0c79b7.svg"},c9d8:function(t,e,n){t.exports=n.p+"img/user.b1a05003.svg"},d228:function(t,e,n){t.exports=n.p+"img/workflow_record_hover.720cb94f.svg"},d511:function(t,e,n){t.exports=n.p+"img/feedback.acd11d09.svg"},da27:function(t,e,n){t.exports=n.p+"img/image.e5acd8c6.svg"},dd31:function(t,e,n){t.exports=n.p+"img/task_management.030841a2.svg"},e00c:function(t,e,n){t.exports=n.p+"img/recorded-video.c59bd707.svg"},e347:function(t,e,n){t.exports=n.p+"img/logo.ae2529b6.svg"},e406:function(t,e,n){t.exports=n.p+"img/image.7b82e85b.svg"},e86d:function(t,e,n){t.exports=n.p+"img/feedback-hover.33be6df5.svg"},f0e3:function(t,e,n){t.exports=n.p+"img/enterprise.5446c33a.svg"},f114:function(t,e,n){t.exports=n.p+"img/workflow-bg.dbcf4313.svg"},f49e:function(t,e,n){t.exports=n.p+"img/file_management.f03555ff.svg"},f57b:function(t,e,n){var i={"./account-b.svg":"936d","./account-bg.svg":"1a8b","./account-c.svg":"b174","./ar-b.svg":"09e7","./ar-c.svg":"fa80","./call-bg.svg":"b3ba","./check-icon.svg":"9767","./check.svg":"51c7","./enterprise-b.svg":"28fe","./enterprise-c.svg":"0374","./equipment.svg":"6f49","./equipment_hover.svg":"6234","./fii-vision-logo-b.svg":"11de","./fii-vision-logo-c.svg":"1a26","./fii-vision-logo.svg":"c47f","./file_management.svg":"f49e","./file_management_hover.svg":"c003","./image-alt.svg":"b53b","./image.svg":"da27","./list-alt.svg":"6ea7","./logo.svg":"e347","./management/analysis-hover.svg":"79e2","./management/analysis.svg":"6dcc","./management/check-icon.svg":"c688","./management/comments-hover.svg":"49de","./management/comments.svg":"4e0f","./management/enterprise-hover.svg":"6fbc","./management/enterprise.svg":"f0e3","./management/feedback-hover.svg":"e86d","./management/feedback.svg":"d511","./management/image.svg":"e406","./management/maintenance-hover.svg":"c792","./management/maintenance.svg":"356e","./management/recorded-video-hover.svg":"9bba","./management/recorded-video.svg":"e00c","./management/stop-icon.svg":"53c4","./management/user-log-hover.svg":"51ce","./management/user-log.svg":"b2af","./model-alt.svg":"a325","./model.svg":"69c7","./next.svg":"35fe","./skip.svg":"9949","./stop-icon.svg":"72af","./task-b.svg":"68c9","./task-bg.svg":"c4d8","./task-c.svg":"0922","./task_management.svg":"dd31","./task_management_hover.svg":"26c7","./text+image-alt.svg":"fd6c","./text+image.svg":"40e9","./text+model-alt.svg":"91a4","./text+model.svg":"84ed","./text+video-alt.svg":"b327","./text+video.svg":"8d63","./text-alt.svg":"65a7","./text.svg":"138c","./user.svg":"c9d8","./user_management.svg":"40b2","./user_management_hover.svg":"26b4","./video-alt.svg":"5926f","./video.svg":"b5ee","./workflow-b.svg":"83f9","./workflow-bg.svg":"f114","./workflow-c.svg":"95d8","./workflow_management.svg":"7dae","./workflow_management_hover.svg":"2864","./workflow_record.svg":"0542","./workflow_record_hover.svg":"d228","./xxxx_management.svg":"4206","./xxxx_management_hover.svg":"fc8e"};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id="f57b"},fa80:function(t,e,n){t.exports=n.p+"img/ar-c.927e4be0.svg"},fc8e:function(t,e,n){t.exports=n.p+"img/xxxx_management_hover.38d47d23.svg"},fd6c:function(t,e,n){t.exports=n.p+"img/text+image-alt.bd511ca2.svg"}}]);
//# sourceMappingURL=chunk-07e4e6e6.14273814.js.map